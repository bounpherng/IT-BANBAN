<!DOCTYPE html>
<html lang="lo" class="scroll-smooth">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IT-banban</title>

  <meta name="description" content="เปเบงเบฑเบเปเบเบเปเปเบซเปเบเปเปเบกเบนเบ เปเบฅเบฐ เบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเบเบฐเปเบเบเบเปเบฒเบเปเบเบญเบเบเบฒเบเบฅเบฑเบ เปเบฅเบฐ เบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ." />
  <meta name="theme-color" content="#10b981" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./icon-192.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Lao:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">


  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Noto Sans Lao', 'sans-serif'],
          },
          aspectRatio: {
            '16/9': '16 / 9',
          },
        }
      }
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <style>
    /* --- [เบเบฑเบเบเบธเบ] เบเบฒเบเบเบฑเปเบเบเปเบฒเบเบทเปเบเบเบฒเบ เปเบฅเบฐ เบเบฒเบเปเบฅเปเบชเบตเบเบทเปเบเบซเบผเบฑเบ --- */
    body {
      font-family: 'Noto Sans Lao', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background-color 0.5s ease-in-out, color 0.5s ease-in-out;
    }

    .page {
      display: none;
    }

    .page.active {
      display: block;
      animation: fadeIn 0.5s ease-in-out;
    }

    /* --- [เบเบฑเบเบเบธเบ] Keyframes เปเบซเปเบกเบตเบเบฒเบเปเบเบทเปเบญเบเปเบซเบงเบเบตเปเบญเปเบญเบเบเบธเปเบกเบเบถเปเบ --- */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .swal2-popup {
      font-family: 'Noto Sans Lao', sans-serif;
    }

    .calc-section {
      display: none;
    }

    .calc-section.active {
      display: block;
      animation: fadeIn 0.5s ease-in-out;
    }

    /* [FIX-1] Removed !important from .hidden to allow Tailwind's responsive classes (like md:flex) to work correctly. */
    .hidden {
      display: none;
    }

    /* --- [เบเบฑเบเบเบธเบ] Image Slider Transitions --- */
    #image-slider .slider-track {
      transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      will-change: transform;
    }

    /* --- [เบเบฑเบเบเบธเบ] FAB Home Button Animation --- */
    #fab-home-button {
      transition: opacity 0.3s, transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    #fab-home-button.hidden {
      opacity: 0;
      transform: scale(0.5);
      pointer-events: none;
    }

    /* --- [เบเบฑเบเบเบธเบ] Slider Dots เปเบซเปเปเบเบเปเบเบฑเปเบเบเบถเปเบ --- */
    #slider-dots button {
      width: 0.75rem; /* 12px */
      height: 0.75rem;
      border-radius: 9999px;
      background-color: rgba(255, 255, 255, 0.4);
      border: 1px solid rgba(0, 0, 0, 0.2);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    #slider-dots button.active {
      background-color: white;
      transform: scale(1.4);
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
    }
    
    /* [เปเบเบตเปเบกเปเปเป] เปเบเบตเปเบกเปเบเบปเบฒเปเบซเปเบเบฑเบเบเปเปเบเบงเบฒเบกเปเบ Banner */
    .text-shadow-lg {
      text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
    }


    /* --- [เบเบปเบเปเบเบตเบก] Responsive Table Styles --- */
    @media (max-width: 768px) {
      #searchResult .table-container table,
      #searchResult .table-container thead,
      #searchResult .table-container tbody,
      #searchResult .table-container th,
      #searchResult .table-container td,
      #searchResult .table-container tr {
        display: block;
      }
      #searchResult .table-container thead tr {
        position: absolute;
        top: -9999px;
        left: -9999px;
      }
      #searchResult .table-container tr {
        border: 1px solid #4a5568;
        border-radius: 0.75rem;
        margin-bottom: 0.75rem;
        background: rgba(0, 0, 0, 0.2);
        padding: 0.75rem;
      }
      #searchResult .table-container td {
        border: none;
        border-bottom: 1px solid #2d3748;
        position: relative;
        padding-left: 45%;
        padding-top: 10px;
        padding-bottom: 10px;
        text-align: right;
        min-height: 38px;
        display: flex;
        align-items: center;
        justify-content: flex-end;
      }
      #searchResult .table-container td:before {
        content: attr(data-label);
        position: absolute;
        left: 12px;
        width: 40%;
        padding-right: 10px;
        white-space: nowrap;
        text-align: left;
        font-weight: bold;
        color: #10b981;
      }
      #searchResult .table-container td:last-child {
        border-bottom: 0;
        justify-content: center;
        padding-left: 0;
      }
      #searchResult .table-container td:last-child::before {
        display: none;
      }
      #searchResult .table-container td.mobile-hidden {
        display: none;
      }
    }

    /* --- [เบเบฑเบเบเบธเบ] Accordion (เบฅเบฒเบเบฅเบฐเบญเบฝเบ) เปเบซเปเปเบเบตเบ-เบเบดเบเบเบธเปเบกเบเบงเบเบเบถเปเบ --- */
    details>summary {
      list-style: none;
    }

    details>summary::-webkit-details-marker {
      display: none;
    }

    details>summary::after {
      content: '+';
      float: right;
      font-size: 1.8rem;
      line-height: 1;
      font-weight: 200;
      transition: transform 0.3s ease-in-out;
    }

    details[open]>summary::after {
      transform: rotate(45deg);
    }

    details .accordion-content {
      overflow: hidden;
      transition: max-height 0.5s ease-out, opacity 0.5s ease-in-out;
      max-height: 0;
      opacity: 0;
    }

    details[open] .accordion-content {
      animation: fadeIn 0.4s ease-in-out;
      max-height: 1000px;
      opacity: 1;
    }

  </style>
  <script>
    if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  </script>

</head>

<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 text-sm md:text-base flex flex-col min-h-screen transition-colors duration-300">

  <!-- =============================== Header =============================== -->
<header class="sticky top-0 z-50 bg-sky-200/50 dark:bg-sky-900/40 backdrop-blur-xl shadow-lg dark:shadow-sky-900/20 border-b border-sky-300/40 dark:border-sky-800/50 transition-all duration-500 ease-in-out m-0 p-0">
    <div class="w-full mx-auto px-4">
        <nav class="flex justify-between items-center py-3">
            <a href="#" onclick="showPage('home')" class="flex items-center space-x-3 text-xl font-extrabold text-gray-800 dark:text-gray-100 cursor-pointer hover:scale-105 transform transition-transform duration-300">
                <img src="https://i.ibb.co/Fk9XKZSH/icon200.png" alt="Logo" class="w-10 h-10 rounded-full shadow-md border-2 border-sky-300 dark:border-sky-600">
                <span class="tracking-wide">IT-banban</span>
            </a>

            <div class="hidden md:flex items-center space-x-6 text-base font-medium ml-auto" id="desktop-nav">
                <a href="#" onclick="showPage('home')" class="text-gray-700 dark:text-gray-300 hover:text-sky-600 dark:hover:text-sky-400 transition-colors duration-300 nav-link relative group" data-page="home">
                    <span>เปเปเบฒเบซเบผเบฑเบ</span>
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-sky-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="#" onclick="showPage('gov-guide')" class="text-gray-700 dark:text-gray-300 hover:text-sky-600 dark:hover:text-sky-400 transition-colors duration-300 nav-link relative group" data-page="gov-guide">
                    <span>เบญเบธเบเปเบธเบเบเบฒเบเบฅเบฑเบ</span>
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-sky-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="#" onclick="showPage('ent-guide')" class="text-gray-700 dark:text-gray-300 hover:text-sky-600 dark:hover:text-sky-400 transition-colors duration-300 nav-link relative group" data-page="ent-guide">
                    <span>เบญเบธเบเปเบธเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ</span>
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-sky-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="#" onclick="showPage('calculator')" class="text-gray-700 dark:text-gray-300 hover:text-sky-600 dark:hover:text-sky-400 transition-colors duration-300 nav-link relative group" data-page="calculator">
                    <span>เปเบเบทเปเบญเบเบเบณเบเบงเบ</span>
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-sky-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
                <a href="#" onclick="showPage('contact')" class="text-gray-700 dark:text-gray-300 hover:text-sky-600 dark:hover:text-sky-400 transition-colors duration-300 nav-link relative group" data-page="contact">
                    <span>เบเปเบฝเบงเบเบฑเบ</span>
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-sky-500 transition-all duration-300 group-hover:w-full"></span>
                </a>
            </div>

            <div class="flex items-center gap-2">
                <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-2.5 transition-all duration-300">
                    <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5 transform transition-transform duration-500 hover:rotate-12" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M17.293 13.293A8 8 0 016.707 2.707 a8.001 8.001 0 1010.586 10.586z"></path>
                    </svg>
                    <svg id="theme-toggle-light-icon" class="hidden w-5 h-5 transform transition-transform duration-500 hover:rotate-45" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm-.707 10.607a1 1 0 010-1.414l.707-.707a1 1 0 111.414 1.414l-.707-.707a1 1 0 01-1.414 0zM3 11a1 1 0 100 2h1a1 1 0 100-2H3z"></path>
                    </svg>
                </button>

                <button id="mobile-menu-button" class="md:hidden p-2 rounded-md hover:bg-sky-100 dark:hover:bg-sky-800/50 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
            </div>
        </nav>

        <div id="mobile-menu" class="hidden flex-col md:hidden pb-4 space-y-1">
            <a href="#" onclick="showPage('home')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-800 dark:text-gray-200 hover:bg-sky-100 dark:hover:bg-sky-800/50 rounded-md transition">
                <i class="fas fa-home w-5"></i> เปเปเบฒเบซเบผเบฑเบ
            </a>
            <a href="#" onclick="showPage('gov-guide')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-800 dark:text-gray-200 hover:bg-sky-100 dark:hover:bg-sky-800/50 rounded-md transition">
                <i class="fas fa-landmark w-5"></i> เบญเบธเบเปเบธเบเบเบฒเบเบฅเบฑเบ
            </a>
            <a href="#" onclick="showPage('ent-guide')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-800 dark:text-gray-200 hover:bg-sky-100 dark:hover:bg-sky-800/50 rounded-md transition">
                <i class="fas fa-building w-5"></i> เบญเบธเบเปเบธเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ
            </a>
            <a href="#" onclick="showPage('calculator')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-800 dark:text-gray-200 hover:bg-sky-100 dark:hover:bg-sky-800/50 rounded-md transition">
                <i class="fas fa-calculator w-5"></i> เปเบเบทเปเบญเบเบเบณเบเบงเบ
            </a>
            <a href="#" onclick="showPage('contact')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-800 dark:text-gray-200 hover:bg-sky-100 dark:hover:bg-sky-800/50 rounded-md transition">
                <i class="fas fa-info-circle w-5"></i> เบเปเบฝเบงเบเบฑเบ
            </a>
        </div>
    </div>
</header>
<main class="w-full mx-auto flex-grow flex flex-col mt-0">
 <div id="home-page" class="page space-y-10 md:space-y-16 pb-20">

<!-- =============================== [เบเบฑเบเบเบธเบเปเปเป] Hero Section =============================== -->
<section class="relative h-[60vh] md:h-[70vh] w-full flex items-center justify-center text-white overflow-hidden">
    <!-- Background Image -->
    <div class="absolute inset-0 z-0">
        <img src="https://i.ibb.co/4ZHfVTkK/02091270509-2.jpg" alt="" class="w-full h-full object-cover">
        <!-- Overlay -->
		
		
        <div class="absolute inset-0 bg-black/60"></div>
    </div>

    <!-- Content -->
    <div class="relative z-10 text-center px-4 space-y-4 max-w-4xl mx-auto">
        <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight text-shadow-lg animate-fadeIn" style="animation-delay: 0.2s;">
            เบเบดเบเบเบตเบเปเบญเบเบฎเบฑเบ
        </h1>
        <h2 class="text-lg md:text-2xl font-semibold text-gray-200 animate-fadeIn" style="animation-delay: 0.4s;">
            เปเบงเบฑเบเปเบเบเป เปเบซเปเบเปเปเบกเบนเบ เปเบฅเบฐ เบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเบเบฐเปเบเบเบเปเบฒเบเปเบเบญเบเบเบฒเบเบฅเบฑเบ เปเบฅเบฐ เบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ
        </h2>
        <p class="text-base md:text-lg text-gray-300 max-w-2xl mx-auto animate-fadeIn" style="animation-delay: 0.6s;">
            เบฅเบงเบกเปเบเบทเปเบญเบเบกเบท เปเบฅเบฐ เบเปเบฅเบดเบเบฒเบเบฅเบฐเบเบฑเบเบกเบทเบญเบฒเบเบตเบ เปเบเบตเปเบกเบเบฐเบชเบดเบเบเบดเบเบฒเบ, เบซเบผเบธเบเบเบงเบฒเบกเบเบดเบเบเบฒเบ, เปเบฅเบฐ เปเบฎเบฑเบเบงเบฝเบเปเบซเปเบชเบณเปเบฅเบฑเบเปเบกเบฑเปเบเบขเบณเบเบทเบเบเปเบญเบ.
        </p>
        <p id="date-lao-calc" class="mt-4 text-sm text-emerald-300 tracking-wider animate-fadeIn" style="animation-delay: 0.8s;"></p>
    </div>
</section>
<!-- =============================== [เบเบปเบเบชเปเบงเบเบเบฑเบเบเบธเบ] Hero Section =============================== -->
	  
<section class="w-full px-0 md:px-4 md:max-w-4xl md:mx-auto">
    <div class="bg-white dark:bg-gray-800/50 p-6 md:p-8 shadow-lg space-y-6 -mt-20 relative z-20 rounded-t-2xl">
        <details class="group border-b-2 border-gray-200 pb-4">
            <summary class="flex justify-between items-center text-base md:text-xl font-bold text-sky-600 dark:text-sky-400 cursor-pointer list-none py-2 transition-colors duration-300 group-hover:text-sky-500">
                <span class="font-semibold flex items-center gap-3"><i class="fas fa-calculator text-sky-500"></i>Add-in: เบชเบธเบเบเบญเบเปเบเบทเปเบญเบเบกเบทเบเบณเบเบงเบเปเบเบดเบเบญเบธเบเปเบนเบ</span>
                <span class="transition-transform duration-300 transform group-open:rotate-90"></span>
            </summary>
            <div class="accordion-content mt-4 space-y-4 text-gray-700 dark:text-gray-300 leading-relaxed text-base">
                <p class="bg-emerald-50 dark:bg-emerald-900/30 p-4 rounded-lg border-l-4 border-emerald-500">๐ก <span class="font-bold">Add-in Calculation:</span> เบเปเบฝเบเบเบฒเบเบเบณเบเบงเบเปเบเบดเบเบญเบธเบเปเบนเบเบเบตเปเบเบฑเบเบเปเบญเบเปเบซเปเบเบฒเบเปเบเบฑเบเปเบฅเบทเปเบญเบเบเปเบฒเบเบเปเบงเบเบเบงเบฒเบกเบเบทเบเบเปเบญเบ, เบงเปเบญเบเปเบง เปเบฅเบฐ เปเบเบฑเบเบกเบทเบญเบฒเบเบตเบ. เบเปเปเบงเปเบฒเบเบฐเปเบเบฑเบเบงเบฝเบเบเบฒเบเบเบฒเบเบฅเบฑเบ เบซเบผเบท เบงเบดเบชเบฒเบซเบฐเบเบดเบ, เปเบเบทเปเบญเบเบกเบทเบเบตเปเบเบทเบเบณเบเบญเบเบเบญเบเบเปเบฒเบ. เปเบเบฒเบฐเปเบฎเบปเบฒเปเบเปเบฅเบงเบกเบเบธเบเบเบฑเบเบเบฑเบเบเบตเปเบเบณเปเบเบฑเบเปเบงเปเปเบเบเปเบญเบเบเบฝเบง, เบเปเบงเบเปเบซเปเบเปเบฒเบเบเบฑเบเบเบฒเบเปเบเบดเบเบญเบธเบเปเบนเบเบเบธเบเบเบฐเปเบเบเปเบเปเบขเปเบฒเบเบกเบตเบเบฐเบชเบดเบเบเบดเบเบฒเบ, เบเบฐเบขเบฑเบเปเบงเบฅเบฒ เปเบฅเบฐ เปเบฑเปเบเปเบเปเบเปเปเบเบเบธเบเบเบปเบงเปเบฅเบ.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="p-4 bg-gray-100 dark:bg-gray-900/50 rounded-lg">
                        <p class="text-base font-semibold text-sky-600 dark:text-sky-400 mb-3">โ เบเบปเบเปเบเบทเปเบญเบเปเบฅเบทเปเบญเบเบเบฒเบเบฅเบฑเบ:</p>
                        <ul class="list-disc list-inside space-y-2 text-sm">
                            <li><strong>Ph_Akon</strong> (เบญเบฒเบเบญเบ)</li>
                            <li><strong>Ph_Datsani_kaj</strong> (เบเบฑเบเบชเบฐเบเบตเบเบน)</li>
                            <li><strong>Ph_Datsani_pk</strong> (เบเบฑเบเบชเบฐเบเบต)</li>
                            <li><strong>Ph_Pikan</strong> (เบเบตเบเบฒเบ)</li>
                            <li><strong>Ph_Ngoenduean_lk</strong> (เปเบเบตเบเปเบเบทเบญเบเบฅเบฑเบเบเบฐเบเบญเบ)</li>
                            <li><strong>Ph_Ngoenduean_bm</strong> (เปเบเบตเบเปเบเบทเบญเบเบเบณเบเบฒเบ)</li>
                            <li><strong>Ph_bumnet</strong> (เบเบณเปเบเบฑเบ)</li>
                            <li><strong>Ph_SiaChiwit_Lk</strong> (เบฅเบฑเบเบเบฐเบเบญเบเปเบชเบเบเบตเบงเบดเบ)</li>
                            <li><strong>Ph_SiaChiwit_bn</strong> (เบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ)</li>
                        </ul>
                    </div>
                    <div class="p-4 bg-gray-100 dark:bg-gray-900/50 rounded-lg">
                        <p class="text-base font-semibold text-rose-600 dark:text-rose-400 mb-3">โ เบเบญเบเบเบธเบกเบงเบฝเบเบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ:</p>
                        <ul class="list-disc list-inside space-y-2 text-sm">
                            <li><strong>bp_UtNunkoedluk</strong> (เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ)</li>
                            <li><strong>Bp_bamnedkoedluk</strong> (เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ)</li>
                            <li><strong>Bp_bumnat</strong> (เบเบณเปเบเบฑเบ)</li>
                            <li><strong>Bp_SiaChiwit</strong> (เปเบชเบเบเบตเบงเบดเบ)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </details>
        <details class="group border-b-2 border-gray-200 pb-4">
            <summary class="flex justify-between items-center text-base md:text-xl font-bold text-sky-600 dark:text-sky-400 cursor-pointer list-none py-2 transition-colors duration-300 group-hover:text-sky-500">
                <span class="font-semibold flex items-center gap-3"><i class="fas fa-language text-sky-500"></i>Add-in: เปเบเบเบเบปเบงเปเบฅเบเปเบเบฑเบเบเบปเบงเปเบฑเบเบชเบทเบซเบผเบฒเบเบเบฒเบชเบฒ</span>
                <span class="transition-transform duration-300 transform group-open:rotate-90"></span>
            </summary>
            <div class="accordion-content mt-4 space-y-6 text-gray-700 dark:text-gray-300 leading-relaxed text-base">
                <p class="bg-emerald-50 dark:bg-emerald-900/30 p-4 rounded-lg border-l-4 border-emerald-500">๐ก <span class="font-bold">iAdd-in it_SpellNumber:</span> เบเบปเบเบฅเบฑเบญเบเบเบงเบฒเบกเบชเบฒเบกเบฒเบเปเปเปเปเบ Excel! เปเบเบเบเบปเบงเปเบฅเบเปเบเบฑเบเบเบปเบงเปเบฑเบเบชเบทเปเบเปเบเบฑเบเบเบตเปเบเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบ. เบฎเบญเบเบฎเบฑเบเปเบเบดเบ 5 เบเบฒเบชเบฒ เปเบฅเบฐ เบซเบผเบฒเบเบซเบผเบฒเบเบชเบฐเบเบธเบเปเบเบดเบ, เบเปเบงเบเปเบซเปเปเบญเบเบฐเบชเบฒเบเบเบญเบเบเปเบฒเบเบเบทเบเบเปเบญเบเบชเบปเบกเบเบนเบเปเบเบ เปเบฅเบฐ เบเปเบญเบเบเบฑเบเบเบงเบฒเบกเบเบดเบเบเบฒเบเปเบเป 100%.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border-l-4 border-red-500">
                        <h3 class="text-base font-semibold text-red-600 dark:text-red-400 mb-2">๐ เบเบฑเบเบซเบฒเบเบตเปเบเปเบฒเบเปเบเบตเบเบเบปเบ?</h3>
                        <ul class="list-disc list-inside space-y-1 text-sm">
                            <li>เปเบชเบเปเบงเบฅเบฒเบเบฑเปเบเบเบดเบกเบเบปเบงเปเบฅเบเปเบเบฑเบเบเบปเบงเปเบฑเบเบชเบทเปเบญเบ</li>
                            <li>เบชเปเบฝเบเบเปเปเบเบฒเบเบเบดเบกเบเบดเบ เปเบฎเบฑเบเปเบซเปเปเบญเบเบฐเบชเบฒเบเบเบฒเบเบเบงเบฒเบกเปเปเบฒเปเบเบทเปเบญเบเบท</li>
                            <li>เบเบงเบฒเบกเบเบดเบเบเบฒเบเบเบฝเบเปเบฅเบฑเบเบเปเบญเบ เบญเบฒเบเบเบณเปเบเบชเบนเปเบเบงเบฒเบกเปเบชเบเบซเบฒเบเบเบตเปเปเบซเบเปเบซเบผเบงเบ</li>
                        </ul>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border-l-4 border-green-500">
                        <h3 class="text-base font-semibold text-green-600 dark:text-green-400 mb-2">๐ เบเบธเบเบชเบปเบกเบเบฑเบเบเบดเปเบชเบ!</h3>
                        <ul class="list-disc list-inside space-y-1 text-sm">
                            <li>เปเบเบเบเบปเบงเปเบฅเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบ เบเบฝเบเปเบเปเบเบดเบกเบชเบนเบ</li>
                            <li>เบฎเบญเบเบฎเบฑเบ 5 เบเบฒเบชเบฒ (เบฅเบฒเบง, เปเบ, เบญเบฑเบเบเบดเบ, เบซเบงเบฝเบ, เบเบตเบ)</li>
                            <li>เบฎเบญเบเบฎเบฑเบเบซเบผเบฒเบเบซเบผเบฒเบเบชเบฐเบเบธเบเปเบเบดเบ, เบเบญเบเปเบเบเบเบธเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบ</li>
                        </ul>
                    </div>
                </div>
                <div>
                    <h3 class="text-base font-semibold text-emerald-500 mb-2">๐ฏ เบเบปเบงเบขเปเบฒเบเบเบฒเบเปเบเปเบเบฒเบเบเบตเปเบเปเบฒเบเบเบฒเบ</h3>
                    <div class="bg-gray-800 dark:bg-gray-900/80 p-4 rounded-lg text-xs space-y-1 font-mono text-white">
                        <p><span class="text-sky-400">=it_SpellNumber(</span><span class="text-orange-400">[cell]</span><span class="text-sky-400">, "la")</span> <span class="text-gray-400">--> เบเบปเบเบฅเบฑเบเปเบเบฑเบเบเบฒเบชเบฒเบฅเบฒเบง</span></p>
                        <p><span class="text-sky-400">=it_SpellNumber(</span><span class="text-orange-400">[cell]</span><span class="text-sky-400">, "th")</span> <span class="text-gray-400">--> เบเบปเบเบฅเบฑเบเปเบเบฑเบเบเบฒเบชเบฒเปเบ</span></p>
                        <p><span class="text-sky-400">=it_SpellNumber(</span><span class="text-orange-400">[cell]</span><span class="text-sky-400">, "us")</span> <span class="text-gray-400">--> เบเบปเบเบฅเบฑเบเปเบเบฑเบเบเบฒเบชเบฒเบญเบฑเบเบเบดเบ</span></p>
                        <p><span class="text-sky-400">=it_SpellNumber(</span><span class="text-orange-400">[cell]</span><span class="text-sky-400">, "vn")</span> <span class="text-gray-400">--> เบเบปเบเบฅเบฑเบเปเบเบฑเบเบเบฒเบชเบฒเบซเบงเบฝเบเบเบฒเบก</span></p>
                        <p><span class="text-sky-400">=it_SpellNumber(</span><span class="text-orange-400">[cell]</span><span class="text-sky-400">, "cn")</span> <span class="text-gray-400">--> เบเบปเบเบฅเบฑเบเปเบเบฑเบเบเบฒเบชเบฒเบเบตเบ</span></p>
                    </div>
                </div>
            </div>
        </details>
        <details class="group border-b-2 border-gray-200 pb-4">
            <summary class="flex justify-between items-center text-base md:text-xl font-bold text-sky-600 dark:text-sky-400 cursor-pointer list-none py-2 transition-colors duration-300 group-hover:text-sky-500">
                <span class="font-semibold flex items-center gap-3"><i class="fas fa-font text-sky-500"></i>เบเบฒเบเบเบณเปเบเป Font PhetsarathOT +TNR</span>
                <span class="transition-transform duration-300 transform group-open:rotate-90"></span>
            </summary>
            <div class="accordion-content mt-4 space-y-4 text-gray-700 dark:text-gray-300 leading-relaxed text-base">
                <p>เบเปเบญเบ <strong>Phetsarath OT+TNR (Times New Roman)</strong> เปเบเบฑเบเบเปเบญเบเบเบตเปเปเบเปเบกเบตเบเบฒเบเบเบฐเบชเบปเบกเบฅเบงเบกเบเบฑเบ2เบเปเบญเบเปเบเบปเปเบฒเบเปเบงเบเบเบฑเบเปเบเบทเปเบญเปเบซเปเบชเบฒเบกเบฒเบเบเบณเปเบเป เปเบเบปเปเบฒเปเบเบเบฒเบเบชเปเบฒเบเปเบญเบเบฐเบชเบฒเบเบเปเบฒเบเปเบเบฒเบเบเบฒเบเปเบซเปเบเบทเบเบเปเบญเบ เปเบเบทเปเบญเบเบงเบฒเบกเปเบเบฑเบเบฅเบฐเบเบฝเบ เปเบฅเบฐ เปเบเบฑเบเบกเบฒเบเบเบฐเบเบฒเบเบเบฝเบงเบเบฑเบเปเบเบเบปเปเบงเบเบฐเปเบเบ.</p>
                <div class="bg-sky-50 dark:bg-sky-900/30 p-4 rounded-lg border-l-4 border-sky-500">
                    <h3 class="text-base font-semibold text-sky-700 dark:text-sky-300 mb-2">๐ เบซเบผเบฑเบเบเบฒเบเบเบณเปเบเปเปเบเปเบญเบเบฐเบชเบฒเบเบเบฒเบเบเบฒเบ:</h3>
                    <ul class="list-disc list-inside space-y-2 text-sm">
                        <li><strong>เบเบงเบฒเบกเปเบเบฑเบเปเบญเบเบฐเบเบฒเบ:</strong> เปเบญเบเบฐเบชเบฒเบเบเบฒเบเบฅเบฑเบเบเบฐเบเบฒเบเบเบฑเบเปเบปเบเบเบงเบเปเบเปเบเบญเบ Phetsarath OT เปเบฅเบฐ เบเบญเบ Times New Roman (เบชเบณเบฅเบฑเบเบเบปเบงเปเบฅเบเบเบปเบงเบญเบฑเบเบชเบญเบเบญเบฑเบเบเบดเบ) เปเบเบทเปเบญเปเบซเปเบกเบตเบฎเบนเบเปเบเบเบเบฝเบงเบเบฑเบ.</li>
                        <li><strong>เบเบงเบฒเบกเบเบฑเบเปเบเบ:</strong> เบเบฐเปเบฒเบเบเบตเปเปเบเบฐเบเบณเบเบท 12pt เบชเบณเบฅเบฑเบเปเบเบทเปเบญเปเบเบเบปเปเบงเปเบ เปเบเบทเปเบญเปเบซเปเบญเปเบฒเบเบเปเบฒเบ เปเบฅเบฐ เปเบเบฑเบเบเบฒเบเบเบฒเบ.</li>
                        <li><strong>เบเบฒเบเบเบฐเบชเบปเบกเบเบฐเบชเบฒเบ:</strong> เบชเบฒเบกเบฒเบเปเบเปเบฎเปเบงเบกเบเบฑเบเบเบญเบ Times New Roman เบชเบณเบฅเบฑเบเบเบฒเบชเบฒเบญเบฑเบเบเบดเบ เปเบเบทเปเบญเบเบงเบฒเบกเปเบเบปเปเบฒเบเบฑเบเบเบญเบเบฎเบนเบเปเบเบ.</li>
                        <li><strong>เบเบงเบฒเบกเปเปเบฒเปเบเบทเปเบญเบเบท:</strong> เบเบฒเบเปเบเปเบเปเบญเบเบเบตเปเบเบทเบเบเปเบญเบเบชเบฐเปเบเบเปเบเบดเบเบเบงเบฒเบกเปเบเบฑเบเบกเบทเบญเบฒเบเบตเบ เปเบฅเบฐ เบเบฐเบเบดเบเบฑเบเบเบฒเบกเบฅเบฐเบเบฝเบเบเบฒเบเบเบญเบเบเบฒเบเบฅเบฑเบเบเบฐเบเบฒเบ.</li>
                    </ul>
                </div>
            </div>
        </details>
        <details class="group border-b-2 border-gray-200 pb-4">
            <summary class="flex justify-between items-center text-base md:text-xl font-bold text-sky-600 dark:text-sky-400 cursor-pointer list-none py-2 transition-colors duration-300 group-hover:text-sky-500">
                <span class="font-semibold flex items-center gap-3"><i class="fab fa-windows text-sky-500"></i>เบฎเบฑเบเบเปเปเบญเบฒเบเบธเบเบฒเบเปเบเปเบเบฒเบ Windows เปเบฅเบฐ Office</span>
                <span class="transition-transform duration-300 transform group-open:rotate-90"></span>
            </summary>
            <div class="accordion-content mt-4 space-y-4 text-gray-700 dark:text-gray-300 leading-relaxed text-base">
                <p>เบเปเบฅเบดเบเบฒเบเบเปเปเบญเบฒเบเบธเบเบฒเบเปเบเปเบเบฒเบ (Activate) เบเบฐเบฅเบดเบเบเบฐเบเบฑเบ Microsoft เบเบญเบเบเปเบฒเบเบขเปเบฒเบเบเบทเบเบเปเบญเบเบเบฒเบกเบฅเบดเบเบฐเบชเบดเบ เปเบเบทเปเบญเปเบซเปเบชเบฒเบกเบฒเบเปเบเปเบเบฒเบเปเบเปเปเบเบฑเบกเบเบฐเบชเบดเบเบเบดเบเบฒเบ, เบเบญเบเปเบ เปเบฅเบฐ เปเบเปเบฎเบฑเบเบเบฒเบเบญเบฑเบเปเบเบเบซเบผเปเบฒเบชเบธเบ. เบฎเบญเบเบฎเบฑเบเบฅเบธเปเบเบเปเบฒเบเปเบเบฑเปเบเบเบตเป:</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg">
                        <h3 class="font-bold text-base mb-2 text-gray-800 dark:text-gray-200"><i class="fab fa-windows mr-2"></i>เบฅเบฐเบเบปเบเบเบฐเบเบดเบเบฑเบเบเบฒเบ Windows</h3>
                        <ul class="list-disc list-inside text-sm">
                            <li>Windows 7, 8, 10...</li>
                        </ul>
                    </div>
                    <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg">
                        <h3 class="font-bold text-base mb-2 text-gray-800 dark:text-gray-200"><i class="fas fa-file-word mr-2"></i>เบเบธเบ Microsoft Office</h3>
                        <ul class="list-disc list-inside text-sm">
                            <li>Office 2010, 2013, 2016...</li>
                        </ul>
                    </div>
                </div>
                <div class="bg-sky-50 dark:bg-sky-900/30 p-4 rounded-lg border-l-4 border-sky-500">
                    <h3 class="text-base font-semibold text-sky-700 dark:text-sky-300 mb-2">๐ เบงเบดเบเบตเบเบฒเบเบเปเปเบญเบฒเบเบธเบเบตเปเบเบทเบเบเปเบญเบ:</h3>
                    <p class="text-sm">เบเบฒเบ Activate เปเบกเปเบเปเบฎเบฑเบเบเปเบฒเบเปเบเปเบเบฃเบก Activate Key เปเบเบทเปเบญเบเปเบญเบฒเบเบธเบเบฒเบเปเบเบเบฒเบเปเบเปเบเบทเบเบเปเบญเบ ,เบงเบดเบเบตเบเบตเปเบฎเบฑเบเบเบฐเบเบฑเบเบงเปเบฒเบเปเบฒเบเบเบฐเปเบเปเปเบเปเบเปเบญเบฒเบเบธเบเบฒเบเปเบเปเบเบฒเบเปเบเบฃเปเบเบฃเบกเปเบเป, เบเปเปเบกเบตเปเบงเบฃเบฑเบช เปเบฅเบฐ เบเบญเบเปเบเบเบฒเบ Malware.</p>
                </div>
            </div>
        </details>
        <details class="group border-b-2 border-gray-200 pb-4">
            <summary class="flex justify-between items-center text-base md:text-xl font-bold text-sky-600 dark:text-sky-400 cursor-pointer list-none py-2 transition-colors duration-300 group-hover:text-sky-500">
                <span class="font-semibold flex items-center gap-3"><i class="fas fa-chalkboard-teacher text-sky-500"></i>เบฎเบฑเบเบชเบญเบเบเบฒเบเปเบเปเบเบฒเบ Word เปเบฅเบฐ Excel เบเบฑเปเบเบเบทเปเบเบเบฒเบ</span>
                <span class="transition-transform duration-300 transform group-open:rotate-90"></span>
            </summary>
            <div class="accordion-content mt-4 space-y-4 text-gray-700 dark:text-gray-300 leading-relaxed text-base">
                <p>เปเบเบตเบเบชเบญเบเบเบฒเบเปเบเปเบเบฒเบ Microsoft Word เปเบฅเบฐ Excel เบชเบณเบฅเบฑเบเบเบนเปเปเบฅเบตเปเบกเบเบปเปเบ, เบเบฑเบเบฎเบฝเบ, เบเบฑเบเบชเบถเบเบชเบฒ เปเบฅเบฐ เบเบฐเบเบฑเบเบเบฒเบเบซเปเบญเบเบเบฒเบเบเบตเปเบเปเบญเบเบเบฒเบเบเบฑเบเบเบทเปเบเบเบฒเบเปเบซเปเปเปเปเบ เปเบเบทเปเบญเปเบเบตเปเบกเบเบฐเบชเบดเบเบเบดเบเบฒเบเปเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบ.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                    <div class="bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg">
                        <h3 class="text-base font-semibold text-blue-700 dark:text-blue-300 mb-2"><i class="fas fa-file-word"></i> Microsoft Word</h3>
                        <ul class="list-decimal list-inside space-y-1 text-sm">
                            <li>เบเบฒเบเบเบฑเบเปเปเบฒเปเบญเบเบฐเบชเบฒเบ, เบเบฑเปเบเบเปเบฒเบเบญเบเปเบเปเบ</li>
                            <li>เบเบฒเบเบเบฑเบเบฎเบนเบเปเบเบเบเบปเบงเปเบฑเบเบชเบท เปเบฅเบฐ เบซเบเปเปเปเปเบฒ</li>
                            <li>เบเบฒเบเปเบชเปเบฎเบนเบเบเบฒเบ, เบเบฒเบเบฐเบฅเบฒเบ เปเบฅเบฐ SmartArt</li>
                            <li>เบเบฒเบเบชเปเบฒเบเบชเบฒเบฅเบฐเบเบฒเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบ</li>
                            <li>เบเบฒเบเปเบเปเบซเบปเบงเปเบเปเบ-เบเปเบฒเบเปเบเปเบ (Header/Footer)</li>
                        </ul>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900/30 p-4 rounded-lg">
                        <h3 class="text-base font-semibold text-green-700 dark:text-green-300 mb-2"><i class="fas fa-file-excel"></i> Microsoft Excel</h3>
                        <ul class="list-decimal list-inside space-y-1 text-sm">
                            <li>เบเบงเบฒเบกเปเบเบปเปเบฒเปเบเบเปเบฝเบงเบเบฑเบ Cell, Row, Column</li>
                            <li>เบเบฒเบเปเบเปเบชเบนเบเบเบณเบเบงเบเบเบทเปเบเบเบฒเบ (SUM, AVERAGE, IF)</li>
                            <li>เบเบฒเบเบเบฑเบเบฎเบนเบเปเบเบเบเบฒเบเบฐเบฅเบฒเบเปเบซเปเบชเบงเบเบเบฒเบก</li>
                            <li>เบเบฒเบเบชเปเบฒเบเบเบฃเบฒเบ เปเบฅเบฐ เปเบเบเบเบนเบก</li>
                            <li>เบเบฒเบเบเบฑเบเบฎเบฝเบ (Sort) เปเบฅเบฐ เบเบฒเบเบเบฑเปเบเบเบญเบ (Filter) เบเปเปเบกเบนเบ</li>
                        </ul>
                    </div>
                </div>
            </div>
        </details>
        <details class="group border-b-2 border-gray-200 pb-4">
            <summary class="flex justify-between items-center text-base md:text-xl font-bold text-sky-600 dark:text-sky-400 cursor-pointer list-none py-2 transition-colors duration-300 group-hover:text-sky-500">
                <span class="font-semibold flex items-center gap-3"><i class="fas fa-cogs text-sky-500"></i>เบฎเบฑเบเบชเปเบฒเบเบเบฑเบเบเบฑเบ Excel เบเบฒเบกเบเบงเบฒเบกเบเปเบญเบเบเบฒเบ</span>
                <span class="transition-transform duration-300 transform group-open:rotate-90"></span>
            </summary>
            <div class="accordion-content mt-4 space-y-4 text-gray-700 dark:text-gray-300 leading-relaxed text-base">
                <p>เบเปเบฝเบเบงเบฝเบเบเบตเปเบเบฑเบเบเปเบญเบ เปเบฅเบฐ เปเบฎเบฑเบเบเปเบณเปเปเบ Excel เปเบซเปเปเบเบฑเบเปเบฅเบทเปเบญเบเบเปเบฒเบ เบเปเบงเบเบเปเบฅเบดเบเบฒเบเบชเปเบฒเบเบเบฑเบเบเบฑเบ เปเบฅเบฐ เบฅเบฐเบเบปเบเบเบณเบเบงเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบเบเบตเปเบญเบญเบเปเบเบเบชเบฐเปเบเบฒเบฐเบชเบณเบฅเบฑเบเบงเบฝเบเบเบญเบเบเปเบฒเบ, เบเปเบงเบเบเบฐเบขเบฑเบเปเบงเบฅเบฒ เปเบฅเบฐ เบซเบผเบธเบเบเปเบญเบเบเบงเบฒเบกเบเบดเบเบเบฒเบ.</p>
                <div class="bg-sky-50 dark:bg-sky-900/30 p-4 rounded-lg">
                    <h3 class="text-base font-semibold text-sky-700 dark:text-sky-300 mb-2">เบเบปเบงเบขเปเบฒเบเบฅเบฐเบเบปเบเบเบตเปเบฎเบฑเบเบเบฑเบเบเบฐเบเบฒ:</h3>
                    <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 text-center">
                        <div class="p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
                            <i class="fas fa-money-bill-wave text-2xl text-green-500 mb-1"></i>
                            <p class="text-sm">เบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ</p>
                        </div>
                        <div class="p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
                            <i class="fas fa-bolt text-2xl text-yellow-500 mb-1"></i>
                            <p class="text-sm">เบเบดเบเปเบฅเปเบเปเบฒเปเบเบเปเบฒ</p>
                        </div>
                        <div class="p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
                            <i class="fas fa-tint text-2xl text-blue-500 mb-1"></i>
                            <p class="text-sm">เบเบดเบเปเบฅเปเบเปเบฒเบเปเบณเบเบฐเบเบฒ</p>
                        </div>
                        <div class="p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
                            <i class="fas fa-percent text-2xl text-red-500 mb-1"></i>
                            <p class="text-sm">เบเบดเบเปเบฅเปเบญเบฒเบเบญเบ</p>
                        </div>
                        <div class="p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
                            <i class="fas fa-boxes text-2xl text-purple-500 mb-1"></i>
                            <p class="text-sm">เบเบฑเบเบเบฒเบเบชเบฐเบเบฑเบญเบ</p>
                        </div>
                        <div class="p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm">
                            <i class="fas fa-chart-line text-2xl text-indigo-500 mb-1"></i>
                            <p class="text-sm">เบฅเบฒเบเบเบฒเบเบญเบทเปเบเป</p>
                        </div>
                    </div>
                </div>
            </div>
        </details>
        <div class="pt-6 text-center">
            <div class="bg-emerald-50 dark:bg-emerald-900/30 p-6 rounded-2xl">
                <p class="font-bold text-lg text-gray-800 dark:text-gray-200 mb-4">
                    ๐ เบชเบปเบเปเบ Add-in เบซเบผเบท เบเปเบฅเบดเบเบฒเบเบญเบทเปเบเป? เบเบดเบเบเปเปเปเบฅเบตเบ!
                </p>
                <a href="https://wa.me/8562091270509" target="_blank" class="inline-flex items-center gap-3 px-6 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-bold rounded-full shadow-lg transition duration-300 transform hover:scale-105 active:scale-95">
                    <i class="fab fa-whatsapp text-2xl"></i>
                    <span>020 9127 0509</span>
                </a>
            </div>
        </div>
    </div>
</section>

<section class="max-w-6xl mx-auto px-4">
  <div class="text-center mb-10">
    <h2 class="text-2xl sm:text-2xl font-bold text-gray-900 dark:text-white">
      เบงเบดเบเบตเปเบญเปเบเบฐเบเบณเบเบฒเบเปเบเปเบเบฒเบเบเบดเบ:
    </h2>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    <div
      class="aspect-video rounded-2xl overflow-hidden shadow-lg border border-gray-200 dark:border-gray-700 bg-black"
      style="position: relative; padding-top: 56.25%;"
    >
      <iframe
        src="https://www.youtube.com/embed/whfcf5BxsLI"
        title="YouTube video"
        loading="lazy"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen"
        allowfullscreen
        style="position:absolute; top:0; left:0; width:100%; height:100%; border:0;"
        referrerpolicy="no-referrer-when-downgrade"
      ></iframe>
    </div>
    <noscript>
      <div class="p-4 bg-gray-50 rounded">
        <p class="text-sm text-gray-600 dark:text-gray-400">
          เบเบฑเบเบเปเปเบชเบฒเบกเบฒเบเปเบซเบฑเบเบงเบดเบเบตเปเบญเบเบตเป เบเบฐเบฅเบธเบเบฒ
          <a href="https://youtu.be/whfcf5BxsLI" target="_blank" rel="noopener noreferrer">
            เปเบเบตเบเปเบ YouTube
          </a>
        </p>
      </div>
    </noscript>
  </div>
</section>


	  
      
      <!-- [เปเบเบตเปเบกเปเปเป] Review Section -->
      <section class="w-full px-4 sm:px-6 lg:px-4 xl:max-w-6xl xl:mx-auto">
        <div class="text-center mb-10">
            </h2>
            <p class="mt-3 text-lg text-gray-600 dark:text-gray-400">
                เบเบงเบฒเบกเบเบดเบเปเบซเบฑเบเบเบฒเบเบเบนเปเปเบเปเบเบฒเบ
            </p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Review Card 1 -->
            <div class="bg-white dark:bg-gray-800/50 p-6 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 transform hover:-translate-y-2 transition-transform duration-300">
                <div class="flex items-center mb-4">
                    <img class="w-12 h-12 rounded-full mr-4 object-cover" src="https://placehold.co/100x100/E2E8F0/4A5568?text=SP" alt="Avatar">
                    <div>
                        <h3 class="font-bold text-gray-900 dark:text-white">เบชเบปเบกเบเบญเบ</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400">เบเบฐเบเบฑเบเบเบฒเบเบเบฑเบเบเบต</p>
                    </div>
                </div>
                <div class="flex items-center mb-3 text-yellow-400">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                </div>
                <p class="text-gray-600 dark:text-gray-300">
                    "เปเบงเบฑเบเปเบเบเปเบเบตเปเบเปเบงเบเบเบฐเบขเบฑเบเปเบงเบฅเบฒเปเบเบเบฒเบเบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบเปเบเปเบซเบผเบฒเบ! Add-in Excel เบเปเปเบเปเบเบฒเบเบเปเบฒเบ เปเบฅเบฐ เบเบทเบเบเปเบญเบ. เปเบเบฐเบเบณเปเบฅเบตเบ!"
                </p>
            </div>
            <!-- Review Card 2 -->
            <div class="bg-white dark:bg-gray-800/50 p-6 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 transform hover:-translate-y-2 transition-transform duration-300">
                <div class="flex items-center mb-4">
                    <img class="w-12 h-12 rounded-full mr-4 object-cover" src="https://placehold.co/100x100/E2E8F0/4A5568?text=KP" alt="Avatar">
                    <div>
                        <h3 class="font-bold text-gray-900 dark:text-white">เบเบณเปเบเบ</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400">เบฅเบฑเบเบเบฐเบเบญเบ</p>
                    </div>
                </div>
                <div class="flex items-center mb-3 text-yellow-400">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star-half-alt"></i>
                </div>
                <p class="text-gray-600 dark:text-gray-300">
                    "เบเปเปเบกเบนเบเบเปเบฝเบงเบเบฑเบเปเบเบดเบเบญเบธเบเปเบนเบเบเปเบฒเบเปเบเบปเบเบเปเบงเบเบเบต. เปเบเบทเปเบญเบเบกเบทเบเบณเบเบงเบเบเปเบเปเบงเบเปเบซเปเปเบเบปเปเบฒเปเบเบงเบดเบเบตเบเบดเบเปเบฅเปเปเบเปเบเปเบฒเบเบเบถเปเบ. เบเปเบญเบเบเบฒเบเปเบซเปเบกเบตเบเปเปเบกเบนเบเบญเบฑเบเปเบเบเบเบฐเบซเบผเบญเบ."
                </p>
            </div>
            <!-- Review Card 3 -->
            <div class="bg-white dark:bg-gray-800/50 p-6 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 transform hover:-translate-y-2 transition-transform duration-300">
                <div class="flex items-center mb-4">
                    <img class="w-12 h-12 rounded-full mr-4 object-cover" src="https://placehold.co/100x100/E2E8F0/4A5568?text=VT" alt="Avatar">
                    <div>
                        <h3 class="font-bold text-gray-900 dark:text-white">เบงเบฑเบเบเบญเบ</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400">เปเบเบปเปเบฒเบเบญเบเบเบธเบฅเบฐเบเบดเบ</p>
                    </div>
                </div>
                <div class="flex items-center mb-3 text-yellow-400">
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                </div>
                <p class="text-gray-600 dark:text-gray-300">
                    "เปเบเปเบเปเบฅเบดเบเบฒเบเบชเปเบฒเบเบเบฑเบเบเบฑเบ Excel เบชเบฐเปเบเบฒเบฐ, เบเบฐเบเบฑเบเปเบเบซเบผเบฒเบ. เบเบตเบกเบเบฒเบเปเบซเปเบเบณเบเบถเบเบชเบฒเบเบต เปเบฅเบฐ เปเบเปเบเบฒเบเบเบฒเบกเบเบตเปเบเปเบญเบเบเบฒเบ. เบเปเบงเบเบซเบผเบธเบเบเบฑเปเบเบเบญเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบเปเบเปเบซเบผเบฒเบ."
                </p>
            </div>
        </div>
      </section>

    </div>

    <!-- =============================== Government Guide Page =============================== -->
    <div id="gov-guide-page" class="page pb-20">
      <section class="w-full px-0 md:px-4 md:max-w-4xl md:mx-auto">
        <div class="bg-white dark:bg-gray-800 p-6 md:p-8  shadow-lg border border-gray-200 dark:border-gray-700 space-y-10">
          <div>
            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-4 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-emerald-500" viewBox="0 0 20 20" fill="currentColor">
                <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.5 2.5 0 00-.567-.267C8.07 8.418 8 8.148 8 7.75V7.5a.5.5 0 01.5-.5h2a.5.5 0 01.5.5v.25c0 .398-.07.668-.433.849a2.5 2.5 0 00-.567.267v1.698c.22.07.412.164.567.267.364.182.433.452.433.849v.25a.5.5 0 01-.5.5h-2a.5.5 0 01-.5-.5v-.25c0-.398.07-.668.433-.849z" />
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.5 4.5 0 00-1.83.992c-.37.28-.5.738-.5 1.158v.255a.5.5 0 00.5.5h2a.5.5 0 00.5-.5v-.255c0-.42-.13-.878-.5-1.158A4.5 4.5 0 0011 5.092V5z" clip-rule="evenodd" />
              </svg>
              เปเบเบดเบเบเบณเปเปเปเบเบเบฐเบเบณเบเบต 2025 (เบเบฑเบเบชเบฐเบเบต 7,350 เบเบตเบ)
            </h2>
            <p class="mb-6 text-gray-600 dark:text-gray-400 leading-relaxed">
              เบญเบตเบเบเบฒเบกเบฅเบฐเบเบฝเบเบเบฒเบเบเบณเบเบปเบเปเบเบดเบเบเบณเปเปเปเบเปเปเป,เปเบเปเบกเบตเบเบฒเบเปเบเปเบเบเบฐเปเบเบเบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบ เปเบฅเบฐ เบงเบดเบเบฒเบเบฒเบเบเบฑเปเบเบฅเบธเปเบกเบเบตเป:
            </p>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบเปเบฅเบดเบซเบฒเบ เบเบฐเปเบเบ 1</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">1,200,000 เบเบตเบ</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบเปเบฅเบดเบซเบฒเบ เบเบฐเปเบเบ 2</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">1,000,000 เบเบตเบ</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบเปเบฅเบดเบซเบฒเบ เบเบฐเปเบเบ 3</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">850,000 เบเบตเบ</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบเปเบฅเบดเบซเบฒเบ เบเบฐเปเบเบ 4</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">550,000 เบเบตเบ</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบเปเบฅเบดเบซเบฒเบ เบเบฐเปเบเบ 5</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">450,000 เบเบตเบ</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบเปเบฅเบดเบซเบฒเบ เบเบฐเปเบเบ 6</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">400,000 เบเบตเบ</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบเปเบฅเบดเบซเบฒเบ เบเบฐเปเบเบ 7</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">350,000 เบเบตเบ</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบเปเบฅเบดเบซเบฒเบ เบเบฐเปเบเบ 8</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">300,000 เบเบตเบ</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg text-center">
                <p class="font-semibold text-gray-700 dark:text-gray-300">เบงเบดเบเบฒเบเบฒเบ</p>
                <p class="text-lg font-bold text-emerald-600 dark:text-emerald-400">200,000 เบเบตเบ</p>
              </div>
            </div>
          </div>
          <div>
            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-3">1. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเปเบเบทเบญเบเบฅเบฑเบเบเบฐเบเบญเบ</h2>
            <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">
              เบเบปเบงเบขเปเบฒเบ: เบ. เบชเบปเบกเบเบต, เบเบฐเบเบฑเบเบเบฒเบเบชเบฒเบเบเบปเบเบเบญเบ, เบเบฑเปเบ 4/4 (เบเบฑเบเบชเบฐเบเบต 240), เบเบตเบเบฒเบ 9 เบเบต, เปเบเบดเบเบเบณเปเปเปเบเบงเบดเบเบฒเบเบฒเบ 200,000 เบเบตเบ, เบกเบตเบฅเบนเบ 1 เบเบปเบ เปเบฅเบฐ เปเบกเบ 1 เบเบปเบ.
            </p>
            <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg space-y-2 text-base">
              <p>1. เปเบเบดเบเบเบทเปเบเบเบฒเบ (เบเบฑเปเบ 4/4): <span class="float-right font-semibold">240 x 7,350 = 1,764,000 เบเบตเบ</span></p>
              <p>2. เปเบเบดเบเบเบตเบเบฒเบ (9 เบเบต): <span class="float-right font-semibold">65,000 เบเบตเบ</span></p>
              <p>3. เปเบเบดเบเบเบณเปเปเปเบ (เบงเบดเบเบฒเบเบฒเบ): <span class="float-right font-semibold">200,000 เบเบตเบ</span></p>
              <p>4. เบญเบธเบเปเบนเบเบฅเบนเบ (1 เบเบปเบ): <span class="float-right font-semibold">100,000 เบเบตเบ</span></p>
              <p>5. เบญเบธเบเปเบนเบเปเบกเบ (1 เบเบปเบ): <span class="float-right font-semibold">100,000 เบเบตเบ</span></p>
              <p>6. เบเปเบฒเบเบญเบเบเบตเบ (เบเบต 2025): <span class="float-right font-semibold">450,000 เบเบตเบ</span></p>
              <hr class="border-t-2 border-emerald-500 my-3">
              <p class="text-sm"><strong>เบชเบนเบเบเบดเบเปเบฅเป:</strong> (เบเบทเปเบเบเบฒเบ + เบเบณเปเปเปเบ + เบเบตเบเบฒเบ) - เบซเบฑเบ 8% - เบญเบฒเบเบญเบ + เบญเบธเบเปเบนเบเบฅเบนเบ/เปเบกเบ + เบเปเบฒเบเบญเบเบเบตเบ</p>
              <div class="text-center bg-emerald-500 text-white font-bold text-xl p-3 rounded-lg mt-4">
                <p>เปเบเบดเบเปเบเบทเบญเบเบฅเบงเบกเบเบฑเบเปเบปเบ: 2,488,346 เบเบตเบ</p>
              </div>
            </div>
            <img src="https://i.ibb.co/Y7KS29YH/1.png" alt="Salary Calculation" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
          </div>
          <div>
            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-3">2. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบเบณเบเบฒเบ</h2>
            <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">
              เบเบปเบงเบขเปเบฒเบ: เบ. เบชเบปเบกเบเบต, เปเบเบปเปเบฒเบฎเบฑเบเบเบณเบเบฒเบ, เบเบฑเปเบ 4/15 (เบเบฑเบเบชเบฐเบเบต 333), เบเบตเบเบฒเบ 25 เบเบต, เปเบเบดเบเบเบณเปเปเปเบ 300,000 เบเบตเบ, เบกเบตเบฅเบนเบ 1 เบเบปเบ, เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ 85%.
            </p>
            <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg space-y-2 text-base">
              <p>1. เปเบเบดเบเบเบทเปเบเบเบฒเบ (เบเบฑเปเบ 4/15): <span class="float-right font-semibold">333 x 7,350 = 2,447,550 เบเบตเบ</span></p>
              <p>2. เปเบเบดเบเบเบตเบเบฒเบ (25 เบเบต): <span class="float-right font-semibold">275,000 เบเบตเบ</span></p>
              <p>3. เปเบเบดเบเบเบณเปเปเปเบ: <span class="float-right font-semibold">300,000 เบเบตเบ</span></p>
              <p>4. เบญเบธเบเปเบนเบเบฅเบนเบ (1 เบเบปเบ): <span class="float-right font-semibold">100,000 เบเบตเบ</span></p>
              <p>5. เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ: <span class="float-right font-semibold">85%</span></p>
              <p>6. เบเปเบฒเบเบญเบเบเบตเบ (เบเบต 2025): <span class="float-right font-semibold">450,000 เบเบตเบ</span></p>
              <hr class="border-t-2 border-emerald-500 my-3">
              <p class="text-sm"><strong>เบชเบนเบเบเบดเบเปเบฅเป:</strong> (เบเบทเปเบเบเบฒเบ + เบเบณเปเปเปเบ + เบเบตเบเบฒเบ) * %เบเบณเบเบฒเบ - เบซเบฑเบเบเบฐเบเบฑเบเบชเบธเบเบฐเบเบฒเบ + เบญเบธเบเปเบนเบเบฅเบนเบ + เบเปเบฒเบเบญเบเบเบตเบ</p>
              <div class="text-center bg-emerald-500 text-white font-bold text-xl p-3 rounded-lg mt-4">
                <p>เปเบเบดเบเบเบณเบเบฒเบเบฅเบงเบก: 3,103,110 เบเบตเบ</p>
              </div>
            </div>
            <img src="https://i.ibb.co/5gCrSHZn/6.png" alt="Pension Calculation" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
          </div>
          <div>
            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-3">3. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ</h2>
            <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">
              เบเบปเบงเบขเปเบฒเบ: เบ. เบชเบปเบกเบเบต, เบฎเบฑเบเปเบเบดเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ, เบเบฑเปเบ 4/15 (เบเบฑเบเบชเบฐเบเบต 333), เบเบตเบเบฒเบ 15 เบเบต, เปเบเบดเบเบเบณเปเปเปเบ 300,000 เบเบตเบ.
            </p>
            <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg space-y-2 text-base">
              <p>1. เปเบเบดเบเบเบทเปเบเบเบฒเบ (เบเบฑเปเบ 4/15): <span class="float-right font-semibold">333 x 7,350 = 2,447,550 เบเบตเบ</span></p>
              <p>2. เปเบเบดเบเบเบตเบเบฒเบ (15 เบเบต): <span class="float-right font-semibold">155,000 เบเบตเบ</span></p>
              <p>3. เปเบเบดเบเบเบณเปเปเปเบ: <span class="float-right font-semibold">300,000 เบเบตเบ</span></p>
              <hr class="border-t-2 border-emerald-500 my-3">
              <p class="text-sm"><strong>เบชเบนเบเบเบดเบเปเบฅเป:</strong> (เบเบทเปเบเบเบฒเบ + เบเบณเปเปเปเบ + เบเบตเบเบฒเบ) * 1.5 * เบเบตเบเบฒเบ</p>
              <div class="text-center bg-emerald-500 text-white font-bold text-xl p-3 rounded-lg mt-4">
                <p>เปเบเบดเบเบเบณเปเบเบฑเบเบฅเบงเบก: 54,937,508 เบเบตเบ</p>
              </div>
            </div>
            <img src="https://i.ibb.co/5W0wWRZG/5.png" alt="Severance Pay Calculation" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
          </div>
        </div>
      </section>
    </div>

    <!-- =============================== Enterprise Guide Page =============================== -->
    <div id="ent-guide-page" class="page pb-20">
      <section class="w-full px-0 md:px-4 md:max-w-4xl md:mx-auto">
        <div class="bg-white dark:bg-gray-800 p-6 md:p-8  shadow-lg border border-gray-200 dark:border-gray-700 space-y-10">
          <div>
            <h2 class="text-2xl sm:text-2xl font-bold text-gray-900 dark:text-white mb-4 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-pink-500" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" />
              </svg>
              1. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเปเบเบตเบเบฅเบนเบ
            </h2>
            <p class="mb-5 text-gray-600 dark:text-gray-400 leading-relaxed">
              - เบเบนเปโเบเบฐเบเบฑเบโเบเบปเบโเปเบเบโเบเบดเบ เบซเบผเบท เปเบกเบโเบเบนเปโเบเบฐเบเบฑเบโเบเบปเบ เบเบตเปโเบเปเปเปเบเปโเบเบฐเบเบญเบโเบญเบฒเบเบตเบโเปเบโเปเบถเปเบโเบเบฐเปเบเปโเบฎเบฑเบเปเบเบดเบเบเบณเปเบเบฑเบเบญเบญเบเบฅเบนเบ เบซเบผเบท เบซเบผเบธโเบฅเบนเบโ เปเบเบปเปเบฒเบเบฑเบ 60% เบเบญเบโโเปเบเบดเบเปเบเบทเบญเบโเบเบฐเบเบฑเบโเบเบปเบเบชเบฐโเปเบฅเปเบโเปเบโเปเบฅเบเบฐ 6 เปเบเบทเบญเบเบชเบธเบโเบเปเบฒเบโเบเปเปโเบฅเบนเบ 1โ เบเบปเบ.</p>
            <p class="mb-5 text-gray-600 dark:text-gray-400 leading-relaxed">
              - เบเบนเปโเบเบฐเบเบฑเบโเบเบปเบโเปเบเบโเบเบดเบ เบเบตเปเปเบเปโเบเบฐเบเบญเบโเบญเบฒเบเบตเบโเปเบโเปเบถเปเบโเปเบเบปเปเบฒเปเบเบฑเบเบชเบฐเบกเบฒเบเบดเบเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบก เบเบฐเปเบเปโเบฎเบฑเบเปเบเบดเบเบญเบธเบเปเบธเบ เบญเบญเบเบฅเบนเบ โเปเบเบฑเบเบฅเบฒเบเปเบเบทเบญเบ 3 เปเบเบทเบญเบเปเบเบตเบเบเบฒเบกเบฅเบฐเบเบฝเบเบเบฒเบ.</p>
            <div class="space-y-4">
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg">
                <p class="font-semibold text-xl dark:text-xl">เปเบเบดเบเบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ (เบเปเบฒเบเปเบเบทเปเบญเบเบฝเบง):</p>
                <p class="text-emerald-600 dark:text-emerald-400 font-bold text-base">เปเบเบดเบเปเบเบทเบญเบเบชเบฐเปเบฅเปเบ 6 เปเบเบทเบญเบ x 60%</p>
              </div>
              <div class="bg-gray-100 dark:bg-gray-900/50 p-4 rounded-lg">
                <p class="font-semibold text-xl dark:text-xl">เปเบเบดเบเบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ (เบเปเบฒเบเปเบเบฑเบเบฅเบฒเบเปเบเบทเบญเบ):</p>
                <p class="text-emerald-600 dark:text-emerald-400 font-bold text-base">เปเบเบดเบเปเบเบทเบญเบเบชเบฐเปเบฅเปเบ 6 เปเบเบทเบญเบ x 60% x 80% (เปเบเบทเบญเบเบเบต1)</p>
                <p class="text-emerald-600 dark:text-emerald-400 font-bold text-base">เปเบเบดเบเปเบเบทเบญเบเบชเบฐเปเบฅเปเบ 6 เปเบเบทเบญเบ x 80% (เปเบเบทเบญเบเบเบต2)</p>
                <p class="text-emerald-600 dark:text-emerald-400 font-bold text-base">เปเบเบดเบเปเบเบทเบญเบเบชเบฐเปเบฅเปเบ 6 เปเบเบทเบญเบ x 120% (เปเบเบทเบญเบเบเบต3)</p>
              </div>
            </div>
            <img src="https://i.ibb.co/HLy7VZzC/4.png" alt="Maternity Benefit" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
          </div>
          <div>
            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-4 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-blue-500" viewBox="0 0 20 20" fill="currentColor">
                <path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z" />
                <path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z" />
              </svg>
              2. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ
            </h2>
            <p class="mb-5 text-gray-600 dark:text-gray-400 leading-relaxed">
              เบเบฒเบเบเบดเบเปเบฅเปเปเบเปเบเบทเปเบญเบเบเบปเปเบเปเบกเปเบเบญเบดเบเบเบฒเบกเปเบเบเบฒเบเปเบเบตเบเบชเบปเบกเบเบปเบเปเบเบเปเบงเบ (1-60 เปเบเบทเบญเบ)เบกเบฒเปเบเบฑเบเบเบทเบเบเบฒเบเปเบเบเบฒเบเบเบดเบเปเบฅเป.เบชเบณเบฅเบฑเบเบเบนเปเบเบฐเบเบฑเบเบเบปเบเบเบตเปเบชเบปเปเบเปเบเบดเบเบชเบปเบกเบเบปเบเบกเบฒเปเบเป 1 เปเบเบดเบ 60 เปเบเบทเบญเบ, เปเบกเบทเปเบญเบญเบญเบเบเบฒเบเบงเบฝเบเบเบฐเปเบเปเบฎเบฑเบเปเบเบดเบเบเบณเปเบเบฑเบเปเบเบฑเบเบเปเบญเบเปเบเบทเปเบญเบเบฝเบง.
            </p>
            <div class="bg-blue-100 dark:bg-blue-900/30 border-l-4 border-blue-500 p-4 rounded-lg text-center">
              <p class="text-blue-800 dark:text-blue-200 font-semibold text-lg">
                เปเบเบดเบเบเบณเปเบเบฑเบ = (เปเบเบดเบเบชเบปเบกเบเบปเบเบชเบฐเปเบฅเปเบ) x 1.5 x เบเบณเบเบงเบเบเบต
              </p>
            </div>
            <img src="https://i.ibb.co/5W0wWRZG/5.png" alt="Enterprise Severance Pay" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
          </div>
          <div>
            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-4 flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-3 text-gray-500" viewBox="0 0 20 20" fill="currentColor">
                <path d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" />
              </svg>
              3. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเปเบชเบเบเบตเบงเบดเบ
            </h2>
            <p class="mb-5 text-gray-600 dark:text-gray-400 leading-relaxed">
              เปเบเบเปเบฅเบฐเบเบตเบเบตเปเบเบนเปเบเบฐเบเบฑเบเบเบปเบเปเบชเบเบเบตเบงเบดเบ (เปเบเบเบเปเปเบเปเบฝเบงเบเปเบญเบเบเบฑเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบ), เบเบญเบเบเบปเบง เบซเบผเบท เบเบนเปเบฎเบฑเบเบเบปเบเบเบฐเปเบซเบเบเบเบฐเปเบเปเบฎเบฑเบเปเบเบดเบเบญเบธเบเปเบนเบ.
            </p>
            <div class="bg-gray-100 dark:bg-gray-700/50 border-l-4 border-gray-500 p-4 rounded-lg text-center">
              <p class="text-gray-800 dark:text-gray-200 font-semibold text-lg">
                เปเบเบดเบเบญเบธเบเปเบนเบ = (เปเบเบดเบเบชเบปเบกเบเบปเบเบชเบฐเปเบฅเปเบ) x เบเบณเบเบงเบเบเบต
              </p>
            </div>
            <img src="https://i.ibb.co/7NQ3HHC9/2.png" alt="Death Benefit" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
          </div>
        </div>
      </section>
    </div>

    <!-- =============================== Calculator Page =============================== -->
	
  <div id="calculator-page" class="page w-full px-0 pb-16">
  <div id="calculator-home" class="calc-section active bg-white dark:bg-gray-800/50  shadow-lg border border-gray-200 dark:border-gray-700 p-6">
    <div class="text-center mb-6">
      <h1 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white">เบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ-เปเบเบตเบเบญเบธเบเปเบนเบเบเปเบฒเบเป</h1>
    </div>
    <div class="flex flex-col sm:flex-row gap-4">
      <button class="flex-1 text-center p-4 bg-gray-100 dark:bg-gray-700 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-all" onclick="showCalcSection('Salary')">
        <i class="fas fa-money-bill-wave text-emerald-500 mb-2 text-2xl"></i>
        <span class="block font-semibold text-gray-800 dark:text-gray-200">เบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ</span>
      </button>
      <button class="flex-1 text-center p-4 bg-gray-100 dark:bg-gray-700 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-all" onclick="showCalcSection('Government')">
        <i class="fas fa-landmark text-emerald-500 mb-2 text-2xl"></i>
        <span class="block font-semibold text-gray-800 dark:text-gray-200">เบญเบธเบเปเบนเบเบเบฒเบเบฅเบฑเบ</span>
      </button>
      <button class="flex-1 text-center p-4 bg-gray-100 dark:bg-gray-700 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-all" onclick="showCalcSection('Enterprise')">
        <i class="fas fa-building text-emerald-500 mb-2 text-2xl"></i>
        <span class="block font-semibold text-gray-800 dark:text-gray-200">เบญเบธเบเปเบนเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ</span>
      </button>
      <button class="flex-1 text-center p-4 bg-gray-100 dark:bg-gray-700 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-all" onclick="showCalcSection('Search')">
        <i class="fas fa-search text-emerald-500 mb-2 text-2xl"></i>
        <span class="block font-semibold text-gray-800 dark:text-gray-200">เบเบปเปเบเบซเบฒเบเปเปเบกเบนเบ</span>
      </button>
    </div>
    <div class="mt-8 text-center bg-yellow-100 dark:bg-yellow-900/50 border-l-4 border-yellow-500 p-4 rounded-r-lg text-yellow-800 dark:text-yellow-200">
      <i class="fas fa-exclamation-triangle mr-2"></i>
      <strong>เบเบณเปเบเบทเบญเบ:</strong> เปเบญเบฑเบเบเบตเปเบชเปเบฒเบเบเบถเปเบเปเบเบทเปเบญเบเปเบงเบเบเบณเบเบงเบเปเบเปเบเบทเปเบญเบเบเบปเปเบเปเบเบปเปเบฒเบเบฑเปเบ, เบชเบญเบเบเบฒเบกเบเปเปเบกเบนเบเปเบเบตเปเบกเปเบเบตเบกเบเบตเป เบญเบเบ เปเบ: 1508.
    </div>
  </div>

  <div id="Salary" class="calc-section bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6 mt-6">
    <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ</h2>
    <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบฅเบฑเบเบเบฐเบเบญเบ (เบเบปเบเบเบญเบ-เบเบนเบญเบฒเบเบฒเบ)</p>
    <form id="salaryForm" class="space-y-4 max-w-lg mx-auto">
      <div>
        <label for="category" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบทเปเบญเปเบเบฅเบฒเบเบฅเบฐเบญเบฝเบ:</label>
        <select id="category" onchange="toggleFields()" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
          <option value="">-- เปเบฅเบทเบญเบเบเบฐเปเบเบ --</option>
          <option value="civil">เปเบเบดเบเปเบเบทเบญเบเบเบฐเบเบฑเบเบเบฒเบเบฅเบฑเบเบเบฐเบเบญเบ</option>
          <option value="pension">เปเบเบตเบเบเบณเบเบฒเบ</option>
        </select>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="index" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบฑเบเบชเบฐเบเบต:</label>
          <input type="number" id="index" min="0" placeholder="เบเบปเบงเบขเปเบฒเบ: 226" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
        </div>
        <div>
          <label for="year" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบตเบเบฒเบ:</label>
          <input type="number" id="year" min="0" placeholder="เบเบปเบงเบขเปเบฒเบ: 10" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
        </div>
      </div>
      <div>
        <label for="position" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบดเบเบเบณเปเปเปเบ:</label>
        <input type="text" inputmode="numeric" id="position" oninput="formatAndRestrictNumber(this)" placeholder="เบเบปเบงเบขเปเบฒเบ: 200,000" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="children" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบณเบเบงเบเบฅเบนเบ:</label>
          <input type="number" id="children" min="0" placeholder="เบเบปเบงเบขเปเบฒเบ: 2" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
        </div>
        <div id="wifeGroup">
          <label for="wife" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบณเบเบงเบเปเบกเบ:</label>
          <input type="number" id="wife" min="0" placeholder="เบเบปเบงเบขเปเบฒเบ: 1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
        </div>
      </div>
      <div class="hidden" id="pensionGroup">
        <label for="pensionPercent" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ (%):</label>
        <input type="number" id="pensionPercent" min="0" max="100" placeholder="เบเบปเบงเบขเปเบฒเบ: 80" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      </div>
      <div class="flex flex-wrap justify-center gap-3 pt-4">
        <button type="button" class="text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="calculateSalary()"><i class="fas fa-calculator mr-2"></i>เบเบณเบเบงเบ</button>
        <button type="button" class="text-white bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="resetSalaryForm()"><i class="fas fa-trash mr-2"></i>เบฅเปเบฒเบเบเปเปเบกเบนเบ</button>
        <button type="button" class="text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="goCalcHome()"><i class="fas fa-arrow-left mr-2"></i>เบเบฑเบเบเบทเบ</button>
      </div>
    </form>
    <div id="salaryResult" class="hidden mt-6 p-5 max-w-lg mx-auto bg-gray-50 dark:bg-gray-900/70 rounded-lg border-l-4 border-emerald-500">
      <h3 class="text-lg font-bold text-emerald-500 mb-4">เบเบปเบเบเบฒเบเบเบณเบเบงเบ</h3>
      <div class="space-y-2 text-sm">
        <p class="flex justify-between"><strong>เบฅเบงเบกเปเบเบดเบเบเปเบญเบเบซเบฑเบ:</strong> <span id="totalBeforeDeduction">0</span> เบเบตเบ</p>
        <p class="flex justify-between"><strong>เปเบเบดเบเบเบตเบเบฒเบ:</strong> <span id="yearAllowance">0</span> เบเบตเบ</p>
        <p class="flex justify-between"><strong>เปเบเบดเบเบฅเบนเบ:</strong> <span id="childAllowance">0</span> เบเบตเบ</p>
        <p id="wifeLabel" class="flex justify-between"><strong>เปเบเบดเบเปเบกเบ:</strong> <span id="wifeAllowance">0</span> เบเบตเบ</p>
        <p id="deductionLabel" class="flex justify-between"><strong>เบซเบฑเบ 8%:</strong> <span id="deduction8">0</span> เบเบตเบ</p>
        <p id="taxLabel" class="flex justify-between"><strong>เบซเบฑเบเบญเบฒเบเบญเบ:</strong> <span id="tax">0</span> เบเบตเบ</p>
        <p class="flex justify-between"><strong>เปเบเบดเบเบเปเบฒเบเบญเบเบเบตเบเปเบเบตเปเบก:</strong> <span id="livingAllowance">0</span> เบเบตเบ</p>
        <p class="flex justify-between font-bold text-base bg-emerald-100 dark:bg-emerald-900/50 p-3 rounded-md mt-4"><strong>เบฅเบงเบกเปเบเบดเบเบเบฑเบเปเบปเบ:</strong>
          <span id="totalNet" class="text-emerald-500">0</span> เบเบตเบ</p>
      </div>
    </div>
  </div>

  <div id="Government" class="calc-section bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6 mt-6">
    <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเบณเบเบงเบเปเบเบดเบเบญเบธเบเปเบธเบเบเบฒเบเบฅเบฑเบ</h2>
    <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบเบญเบเบเบถเบเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบกเปเบซเปเบเบเบฒเบ (เบญเบเบ)</p>
    <form id="bonusForm" class="space-y-4 max-w-lg mx-auto">
      <div>
        <label for="detail" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบทเปเบญเปเบเบฅเบฒเบเบฅเบฐเบญเบฝเบ:</label>
        <select id="detail" name="detail" onchange="updatePercentage()" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
          <option value="">-- เปเบฅเบทเบญเบเบเบฐเปเบเบ --</option>
          <option value="เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ">เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ</option>
          <option value="เปเบเบตเบเบญเบธเบเปเบธเบเปเบชเบเบเบตเบงเบดเบเบฅเบฑเบเบเบฐเบเบญเบ">เปเบเบดเบเบญเบธเบเปเบธเบเปเบชเบเบเบตเบงเบดเบเบฅเบฑเบเบเบฐเบเบญเบ</option>
          <option value="เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ">เปเบเบดเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ</option>
          <option value="เปเบเบตเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ">เปเบเบดเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ</option>
        </select>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label for="govIndex" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบฑเบเบชเบฐเบเบต:</label>
          <input type="number" id="govIndex" name="index" placeholder="เบเบปเบงเบขเปเบฒเบ: 226" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
        </div>
        <div>
          <label for="serviceYears" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบตเบเบฒเบ:</label>
          <input type="number" id="serviceYears" name="serviceYears" placeholder="เบเบปเบงเบขเปเบฒเบ: 10" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
        </div>
      </div>
      <div>
        <label for="positionSalary" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบดเบเบเบณเปเปเปเบ:</label>
        <input type="text" inputmode="numeric" id="positionSalary" name="positionSalary" oninput="formatAndRestrictNumber(this)" placeholder="เบเบปเบงเบขเปเบฒเบ: 200,000" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      </div>
      <div class="hidden" id="percentageGroup">
        <label id="percentageLabel" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ (%):</label>
        <input type="number" id="percentage" name="percentage" step="0.01" placeholder="เบเบปเบงเบขเปเบฒเบ: 85" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      </div>
      <div class="flex flex-wrap justify-center gap-3 pt-4">
        <button type="button" class="text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="validateAndCalculateGovernment()"><i class="fas fa-calculator mr-2"></i>เบเบณเบเบงเบ</button>
        <button type="button" class="text-white bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="clearGovForm()"><i class="fas fa-trash mr-2"></i>เบฅเปเบฒเบเบเปเปเบกเบนเบ</button>
        <button type="button" class="text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="goCalcHome()"><i class="fas fa-arrow-left mr-2"></i>เบเบฑเบเบเบทเบ</button>
      </div>
    </form>
    <div id="govResult" class="hidden mt-6 p-5 max-w-lg mx-auto bg-gray-50 dark:bg-gray-900/70 rounded-lg border-l-4 border-emerald-500">
      <h3 class="text-lg font-bold text-emerald-500 mb-4">เบเบปเบเบเบฒเบเบเบณเบเบงเบ</h3>
      <div class="space-y-2 text-sm">
        <p class="flex justify-between"><strong>เปเบเบดเบเปเบเบทเบญเบเบเบทเปเบเบเบฒเบ:</strong> <span id="govBaseMonthlySalary">0</span> เบเบตเบ</p>
        <p class="flex justify-between"><strong>เปเบเบดเบเบเบตเบเบฒเบ:</strong> <span id="govYearlyBonus">0</span> เบเบตเบ</p>
        <p class="flex justify-between"><strong>เบฅเบงเบกเปเบเบดเบเบเปเบญเบเบซเบฑเบ:</strong> <span id="govTotalDeduction">0</span> เบเบตเบ</p>
        <p class="flex justify-between"><strong>เปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบ:</strong> <span id="govMonthsReceived">0</span> เปเบเบทเบญเบ</p>
        <p class="flex justify-between font-bold text-base bg-emerald-100 dark:bg-emerald-900/50 p-3 rounded-md mt-4"><strong>เบฅเบงเบกเปเบเบดเบเบเบฑเบเปเบปเบเบเบตเปเปเบเปเบฎเบฑเบ:</strong> <span id="govTotalAmountReceived" class="text-emerald-500">0</span> เบเบตเบ</p>
      </div>
    </div>
  </div>

  <div id="Enterprise" class="calc-section bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6 mt-6">
    <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเบณเบเบงเบเปเบเบดเบเบญเบธเบเปเบธเบเบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ</h2>
    <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบเบญเบเบเบถเบเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบกเปเบซเปเบเบเบฒเบ (เบญเบเบ)</p>
    <form id="supportForm" class="space-y-4 max-w-lg mx-auto">
      <div>
        <label for="entCategory" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบทเปเบญเปเบเบฅเบฒเบเบฅเบฐเบญเบฝเบ:</label>
        <select id="entCategory" name="category" onchange="handleEnterpriseCategoryChange()" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
          <option value="">-- เปเบฅเบทเบญเบเบเบฐเปเบเบ --</option>
          <option value="เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ">เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ</option>
          <option value="เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ">เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ</option>
          <option value="เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ">เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ</option>
          <option value="เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ">เปเบเบดเบเปเบชเบเบเบตเบงเบดเบ</option>
        </select>
      </div>
      <div>
        <label for="contribution" id="contributionLabel" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบณเบเบงเบเปเบเบตเบเบชเบปเบกเบเบปเบ 6 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ:</label>
        <input type="text" inputmode="numeric" id="contribution" name="contribution" oninput="formatAndRestrictNumber(this)" placeholder="เบเบปเบงเบขเปเบฒเบ: 27,000,000" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      </div>
      <div>
        <label for="months" id="monthsLabel" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบทเบญเบ:</label>
        <input type="number" id="months" name="months" step="1" placeholder="เบเบปเบงเบขเปเบฒเบ: 12" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      </div>
      <div class="hidden" id="entChildrenField">
        <label for="entChildren" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบณเบเบงเบเบฅเบนเบ:</label>
        <input type="number" id="entChildren" name="children" step="1" placeholder="เบเบปเบงเบขเปเบฒเบ: 1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      </div>
      <div class="flex flex-wrap justify-center gap-3 pt-4">
        <button type="button" class="text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="calculateEnterprise()"><i class="fas fa-calculator mr-2"></i>เบเบณเบเบงเบ</button>
        <button type="button" class="text-white bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="clearEntForm()"><i class="fas fa-trash mr-2"></i>เบฅเปเบฒเบเบเปเปเบกเบนเบ</button>
        <button type="button" class="text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="goCalcHome()"><i class="fas fa-arrow-left mr-2"></i>เบเบฑเบเบเบทเบ</button>
      </div>
    </form>
    <div id="entResult" class="hidden mt-6 p-5 max-w-lg mx-auto bg-gray-50 dark:bg-gray-900/70 rounded-lg border-l-4 border-emerald-500">
      <h3 class="text-lg font-bold text-emerald-500 mb-4">เบเบปเบเบเบฒเบเบเบณเบเบงเบ</h3>
      <p class="flex justify-between font-bold text-base bg-emerald-100 dark:bg-emerald-900/50 p-3 rounded-md mt-4"><strong>เบฅเบงเบกเปเบเบดเบเบเบฑเบเปเบปเบเบเบตเปเปเบเปเบฎเบฑเบ:</strong> <span id="entTotal" class="text-emerald-500">0</span> เบเบตเบ</p>
    </div>
  </div>

  <div id="Search" class="calc-section bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6 mt-6">
    <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเบปเปเบเบซเบฒเบเปเปเบกเบนเบ</h2>
    <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบเบปเปเบเบซเบฒเบเบฒเบเบเบณเบเบงเบเบเบตเปเบเปเบฒเบเบกเบฒ เปเบฅเบฐ เบเบญเบเบซเบฒเบเบฑเบเบชเบฐเบเบต</p>
    <form id="searchForm" class="space-y-4 max-w-lg mx-auto">
      <div>
        <label for="combobox1" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบฅเบทเบญเบเบฅเบฒเบเบเบฒเบ:</label>
        <select id="combobox1" name="combobox1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
          <option value="">-- เบเบฐเบฅเบธเบเบฒเปเบฅเบทเบญเบ --</option>
          <option value="salaryHistory">เบเบฐเบซเบงเบฑเบเบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ</option>
          <option value="govSupportHistory">เบเบฐเบซเบงเบฑเบเบเบณเบเบงเบเบเบฒเบเบฅเบฑเบ</option>
          <option value="entSupportHistory">เบเบฐเบซเบงเบฑเบเบเบณเบเบงเบเบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ</option>
          <option value="indexData">เบเบปเปเบเบซเบฒเบเบฑเบเบชเบฐเบเบต</option>
        </select>
      </div>
      <div>
        <label for="textbox1" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบชเปเบเปเปเบกเบนเบเปเบเบทเปเบญเบเบปเปเบเบซเบฒ (เบเปเปเบเบฑเบเบเบฑเบ):</label>
        <input type="text" id="textbox1" name="textbox1" placeholder="เบเบปเบงเบขเปเบฒเบ: 4/2, เบเบนเบญเบฒเบเบฒเบ" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      </div>
      <div class="flex flex-wrap justify-center gap-3 pt-4">
        <button type="button" id="searchButton" class="text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="searchData()"><i class="fas fa-search mr-2"></i>เบเบปเปเบเบซเบฒ</button>
        <button type="button" class="text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="goCalcHome()"><i class="fas fa-arrow-left mr-2"></i>เบเบฑเบเบเบทเบ</button>
      </div>
    </form>
    <div id="searchResult" class="hidden w-full mt-6">
      <div class="table-container overflow-x-auto" id="table-container">
        <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
            <tr id="table-header"></tr>
          </thead>
          <tbody id="table-body" class="bg-white dark:bg-gray-800"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

    <!-- =============================== Contact Page =============================== -->
   <div id="contact-page" class="page w-full px-0 pb-16">
      <section class="px-4">
        <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเปเบฝเบงเบเบฑเบเบเบงเบเปเบฎเบปเบฒ</h2>
        <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบชเบญเบเบเบฒเบกเบเปเปเบกเบนเบเปเบเบตเปเบกเปเบเบตเบก เปเบฅเบฐ เบเปเบเบณเปเบเบฐเบเบณ.</p>
        <div class="bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 w-full md:max-w-2xl md:mx-auto p-4 md:p-8">
          <div class="space-y-4 text-center text-lg">
            <p><strong>เบชเบฒเบเบเปเบงเบ เบญเบเบ:</strong> <a href="tel:1508" class="text-emerald-500 hover:underline">1508</a></p>
            <p><strong>เปเบเบชเบเบธเบ:</strong> <a href="https://www.facebook.com/Phetsaiyaphoom" target="_blank" class="text-emerald-500 hover:underline">Bounpheng Phetsaiyaphoum</a></p>
            <p><strong>เบงเบฑเบญเบเปเบญเบฑเบ:</strong>
              <a href="https://api.whatsapp.com/send/?phone=8562091270509" target="_blank" class="text-emerald-500 hover:underline">020 9127 0509</a></p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- =============================== Floating Action Button =============================== -->
  <a href="#" onclick="showPage('home')" id="fab-home-button" class="hidden fixed bottom-6 right-6 bg-emerald-500 hover:bg-emerald-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg z-40">
    <i class="fas fa-home text-xl"></i>
  </a>



  <!-- =============================== Footer =============================== -->
  <footer class="fixed bottom-0 left-0 w-full bg-gray-200 dark:bg-gray-800 border-t border-gray-300 dark:border-gray-700">
    <div class="w-full mx-auto px-4 py-5 text-center text-gray-600 dark:text-gray-400 text-xs">
      <p>ยฉ <span id="footer-year"></span> เบชเบฐเบซเบเบงเบเบฅเบดเบเบฐเบชเบดเบ. เบเบฑเบเบเบฐเบเบฒเปเบเบ เบ.เบเบธเบเปเบเบตเปเบ เปเบเบฑเบเปเบเบเบฐเบเบนเบก.</p>
    </div>
  </footer>

  <!-- =============================== Popup Notification =============================== -->
  <div id="popup" class="prize-popup fixed top-1/2 left-1/2 w-[min(85vw,450px)] transform -translate-x-1/2 -translate-y-1/2 scale-50 bg-gray-900 rounded-2xl border-2 border-transparent shadow-2xl z-[1000] text-center text-white p-6 opacity-0 pointer-events-none transition-all duration-300">
    <button class="close-popup absolute top-2 right-2 bg-none border-none text-4xl text-white cursor-pointer opacity-70 hover:opacity-100 hover:rotate-90 transition-transform">&times;</button>
    <div class="icon text-6xl"></div>
    <div class="message text-2xl font-bold mt-4 mb-2"></div>
    <div class="sub-message text-base text-gray-400"></div>
  </div>

  <!-- =============================== Scripts =============================== -->
  <script type="module">
    // Firebase initialization
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit, serverTimestamp, onSnapshot, doc, getDoc, updateDoc, arrayUnion, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    const firebaseConfig = {
      apiKey: "AIzaSyD8fd_23dLQPbLqfqbakpJtlzjIOD_B-Jw",
      authDomain: "myapp-506ca.firebaseapp.com",
      projectId: "myapp-506ca",
      storageBucket: "myapp-506ca.appspot.com",
      messagingSenderId: "341275741284",
      appId: "1:341275741284:web:f955e6c5a273e4be616371"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Make Firebase functions available globally
    window.db = db;
    window.firestoreFunctions = {
      collection, addDoc, getDocs, query, orderBy, limit, serverTimestamp,
      onSnapshot, doc, getDoc, updateDoc, arrayUnion, deleteDoc
    };
  </script>

  <script>
    // --- Main application script ---
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('footer-year').textContent = new Date().getFullYear();
      const closePopupBtn = document.querySelector('.close-popup');
      if (closePopupBtn) {
        closePopupBtn.addEventListener('click', hidePopup);
      }

      setupMobileMenu();
      setupThemeToggle();
      initializeSlider();

      showPage('home');
      loadAndInitializeApp();
      displayLaoDateForCalc();
    });

    function setupMobileMenu() {
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');
      mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
    }

    function setupThemeToggle() {
      const themeToggleBtn = document.getElementById('theme-toggle');
      const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
      const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');
      const updateIcons = () => {
        if (document.documentElement.classList.contains('dark')) {
          themeToggleDarkIcon.classList.add('hidden');
          themeToggleLightIcon.classList.remove('hidden');
        } else {
          themeToggleDarkIcon.classList.remove('hidden');
          themeToggleLightIcon.classList.add('hidden');
        }
      };
      updateIcons();
      themeToggleBtn.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        if (document.documentElement.classList.contains('dark')) {
          localStorage.setItem('theme', 'dark');
        } else {
          localStorage.setItem('theme', 'light');
        }
        updateIcons();
      });
    }

    function initializeSlider() {
      const sliderTrack = document.querySelector('#image-slider .slider-track');
      if (!sliderTrack) return;
      const slides = Array.from(sliderTrack.children);
      const nextButton = document.getElementById('slider-next');
      const prevButton = document.getElementById('slider-prev');
      const dotsNav = document.getElementById('slider-dots');
      let currentIndex = 0;
      const createDots = () => {
        dotsNav.innerHTML = '';
        slides.forEach((_, index) => {
          const dot = document.createElement('button');
          dot.addEventListener('click', () => {
            goToSlide(index);
            resetInterval();
          });
          dotsNav.appendChild(dot);
        });
      };
      createDots();
      const dots = Array.from(dotsNav.children);
      const updateDots = () => {
        dots.forEach((dot, index) => {
          dot.classList.toggle('active', index === currentIndex);
        });
      };
      const goToSlide = (index) => {
        const slideWidth = slides[0].getBoundingClientRect().width;
        if (slideWidth === 0) return;
        currentIndex = index;
        sliderTrack.style.transform = `translateX(-${slideWidth * currentIndex}px)`;
        updateDots();
      };
      nextButton.addEventListener('click', () => {
        const nextIndex = (currentIndex + 1) % slides.length;
        goToSlide(nextIndex);
        resetInterval();
      });
      prevButton.addEventListener('click', () => {
        const prevIndex = (currentIndex - 1 + slides.length) % slides.length;
        goToSlide(prevIndex);
        resetInterval();
      });
      let autoSlideInterval = setInterval(() => {
        const nextIndex = (currentIndex + 1) % slides.length;
        goToSlide(nextIndex);
      }, 4000);
      const resetInterval = () => {
        clearInterval(autoSlideInterval);
        autoSlideInterval = setInterval(() => {
          const nextIndex = (currentIndex + 1) % slides.length;
          goToSlide(nextIndex);
        }, 4000);
      };
      window.addEventListener('resize', () => goToSlide(currentIndex));
      goToSlide(0);
    }

    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
      const targetPage = document.getElementById(pageId + '-page');
      if (targetPage) {
        targetPage.classList.add('active');
      }
      const fabHomeButton = document.getElementById('fab-home-button');
      if (fabHomeButton) {
        if (pageId === 'home') {
          fabHomeButton.classList.add('hidden');
        } else {
          fabHomeButton.classList.remove('hidden');
        }
      }
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('text-emerald-500', 'font-bold');
        if (link.getAttribute('data-page') === pageId) {
          link.classList.add('text-emerald-500', 'font-bold');
        }
      });
      const mobileMenu = document.getElementById('mobile-menu');
      if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
        mobileMenu.classList.add('hidden');
      }
      window.scrollTo(0, 0);
      if (pageId === 'home') {
        resetHomePage();
      }
    }

    function resetHomePage() {
      let slider = document.querySelector('#image-slider .slider-track');
      if (slider) {
        slider.style.transform = 'translateX(0)';
      }
      document.querySelectorAll('#home-page details').forEach(d => d.removeAttribute('open'));
      document.querySelectorAll('#home-page input, #home-page textarea').forEach(el => el.value = "");
      document.querySelectorAll('#home-page iframe').forEach(iframe => {
        let src = iframe.src;
        iframe.src = src;
      });
    }

    function showCalcSection(sectionId) {
      document.querySelectorAll('.calc-section').forEach(s => s.classList.remove('active'));
      document.getElementById(sectionId).classList.add('active');
    }

    function goCalcHome() {
      resetSalaryForm();
      clearGovForm();
      clearEntForm();
      document.getElementById('searchForm').reset();
      const searchResult = document.getElementById('searchResult');
      if (searchResult) searchResult.classList.add('hidden');
      showCalcSection('calculator-home');
    }

    let APP_CONFIG = null;
    let popupTimeout;
    let IS_ADMIN = false;
    let ADMIN_EMAILS = [];

async function loadAndInitializeApp() {
  // 1. เบชเบฐเปเบเบเปเปเบฒเบเปเบฒเบเบเปเบญเบเบฎเบฑเบ "IT-banban" เบเบฑเบเบเบตเปเบเบฑเบเปเบงเบฅเบฒ 5 เบงเบดเบเบฒเบเบต
  Swal.fire({
    title: 'เบเบดเบเบเบตเบเปเบญเบเบฎเบฑเบ',
    html: '<div style="font-family: Arial, sans-serif; font-size: 2.5em; font-weight: bold; color: #4CAF50; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);">' +
          '  IT-banban' +
          '</div>' +
          '<p style="font-size: 1.1em; color: #555; margin-top: 10px;">เบเบณเบฅเบฑเบเบเบฐเบเบฝเบกเบฅเบฐเบเบปเบเปเบซเปเบเปเบฒเบ...</p>',
    timer: 5000, // 5 เบงเบดเบเบฒเบเบต (5000 milliseconds)
    timerProgressBar: true, // เปเบเบตเปเบกเปเบเบเปเบงเบฅเบฒเบเปเบฒเบเบฅเบธเปเบก เนเธซเนเธเธนเนเนเธเนเนเธซเนเธเธงเนเธฒเธเธณเธฅเธฑเธเธเธฑเธเธเธญเธขเธซเธฅเธฑเธ
    showConfirmButton: false,
    allowOutsideClick: false
  });

  // 2. เปเบฅเบตเปเบกเปเบซเบผเบเบเปเปเบกเบนเบเปเบเบเบทเปเบเบซเบผเบฑเบ (background)
  try {
    if (!window.db) {
      throw new Error("Firestore is not initialized.");
    }
    const {
      doc,
      getDoc
    } = window.firestoreFunctions;

    const configRef = doc(window.db, "configuration", "appConfig");
    const docSnap = await getDoc(configRef); // เบเบฒเบเปเบซเบผเบเบเปเปเบกเบนเบเบเบฐเปเบเบตเบเบเบถเปเบเบขเบนเปเบเบธเบเบเบตเป

    if (docSnap.exists()) {
      APP_CONFIG = docSnap.data();

      // เบเปเบฝเบเบเปเบฒ 'Infinity' เปเบซเปเปเบเบฑเบ Infinity เปเบเปเป
      if (APP_CONFIG.yearAllowanceTiers) {
        APP_CONFIG.yearAllowanceTiers.forEach(tier => {
          if (tier.maxYears === 'Infinity') {
            tier.maxYears = Infinity;
          }
        });
      }
      if (APP_CONFIG.taxBrackets) {
        APP_CONFIG.taxBrackets.forEach(bracket => {
          if (bracket.max === 'Infinity') {
            bracket.max = Infinity;
          }
        });
      }

      // เปเบกเบทเปเบญเปเบเปเบเปเปเบกเบนเบเปเบฅเปเบง, เบเบถเปเบเปเบฅเบตเปเบกเบเบฑเปเบเบเปเบฒเบเบญเบก เปเบฅเบฐ เบเปเปเบกเบนเบเบญเบทเปเบเป
      initializeForms();
      await loadAdminList();

      // เบเปเปเบเบณเปเบเบฑเบเบเปเบญเบเปเบฎเบฑเบเบซเบเบฑเบเบเบฑเบ Swal เบญเบตเบ, เบกเบฑเบเบเบฐเบเบดเบเปเบญเบเปเบกเบทเปเบญเบเบปเบ 5 เบงเบดเบเบฒเบเบต
    } else {
      throw new Error("เบเปเปเบเบปเบเบเปเปเบกเบนเบเบเบฒเบเบเบฑเปเบเบเปเบฒเปเบ Firestore (configuration/appConfig).");
    }
  } catch (error) {
    console.error("Error loading remote configuration: ", error);

    // 3. เบเปเบฒเปเบซเบผเบเบเปเปเบกเบนเบเบเบดเบเบเบฒเบ, เปเบซเปเบเปเบฝเบเปเบเบชเบฐเปเบเบเปเปเบฒเบเปเบฒเบ Error เบเบฑเบเบเบต
    // (เบกเบฑเบเบเบฐเบเบดเบเปเปเบฒเบเปเบฒเบเบเปเบญเบเบฎเบฑเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบ)
    Swal.fire({
      icon: 'error',
      title: 'เปเบเบตเบเบเปเปเบเบดเบเบเบฒเบ',
      text: 'เบเปเปเบชเบฒเบกเบฒเบเปเบซเบผเบเบเปเปเบกเบนเบเบซเบผเบฑเบเบเบญเบเบฅเบฐเบเบปเบเปเบเป. เบเบฐเบฅเบธเบเบฒเบเบงเบเบชเบญเบเบเบฒเบเปเบเบทเปเบญเบกเบเปเปเปเบฅเปเบงเบฅเบญเบเปเปเปเบญเบตเบเบเบฑเปเบ.',
      allowOutsideClick: false
    });
  }
}


    function showCustomPopup(type, message, subMessage = 'เบเบฐเบฅเบธเบเบฒเบเบงเบเบชเบญเบเบเปเปเบกเบนเบเบเบญเบเบเปเบฒเบเบเบทเบ') {
      const popup = document.getElementById('popup');
      const popupIcon = popup.querySelector('.icon');
      const popupMessage = popup.querySelector('.message');
      const popupSubMessage = popup.querySelector('.sub-message');
      if (popupTimeout) clearTimeout(popupTimeout);
      let iconHtml = '';
      switch (type) {
        case 'success':
          iconHtml = 'โ';
          subMessage = subMessage === 'เบเบฐเบฅเบธเบเบฒเบเบงเบเบชเบญเบเบเปเปเบกเบนเบเบเบญเบเบเปเบฒเบเบเบทเบ' ? 'เบเปเปเบกเบนเบเบเบญเบเบเปเบฒเบเปเบเปเบเบทเบเบเบฐเบกเบงเบเบเบปเบเบชเบณเปเบฅเบฑเบ!' : subMessage;
          break;
        case 'warning':
          iconHtml = 'โ๏ธ';
          break;
        case 'error':
          iconHtml = 'โ';
          break;
        default:
          iconHtml = 'โน๏ธ';
      }
      popupIcon.innerHTML = iconHtml;
      popupMessage.textContent = message;
      popupSubMessage.textContent = subMessage;
      popup.classList.add('active', 'scale-100', 'opacity-100');
      popup.classList.remove('scale-50', 'opacity-0');
      popupTimeout = setTimeout(() => {
        hidePopup();
      }, 5000);
    }

    function hidePopup() {
      const popup = document.getElementById('popup');
      popup.classList.remove('active', 'scale-100', 'opacity-100');
      popup.classList.add('scale-50', 'opacity-0');
      if (popupTimeout) clearTimeout(popupTimeout);
    }

    async function saveDataToFirestore(collectionName, data) {
      if (!window.db) {
        console.error("Firestore is not initialized.");
        showCustomPopup('error', 'เบเบดเบเบเบฒเบ', 'เบเปเปเบชเบฒเบกเบฒเบเปเบเบทเปเบญเบกเบเปเปเบเบฒเบเบเปเปเบกเบนเบเปเบเป.');
        return false;
      }
      try {
        const {
          collection,
          addDoc,
          serverTimestamp
        } = window.firestoreFunctions;
        const dataToSave = { ...data,
          savedAt: serverTimestamp()
        };
        await addDoc(collection(window.db, collectionName), dataToSave);
        return true;
      } catch (error) {
        console.error("Error writing document: ", error);
        showCustomPopup('error', 'เบเบดเบเบเบฒเบเปเบเบเบฒเบเบเบฑเบเบเบถเบ', `เปเบเบตเบเบเปเปเบเบดเบเบเบฒเบ: ${error.message}`);
        return false;
      }
    }

    async function getDataFromFirestore(collectionName) {
      if (!window.db) {
        console.error("Firestore is not initialized.");
        return [];
      }
      try {
        const {
          collection,
          getDocs,
          query,
          orderBy,
          limit
        } = window.firestoreFunctions;
        const q = query(collection(window.db, collectionName), orderBy("savedAt", "desc"), limit(50));
        const querySnapshot = await getDocs(q);
        const data = [];
        querySnapshot.forEach((doc) => {
          let docData = doc.data();
          if (docData.savedAt && docData.savedAt.toDate) {
            docData.savedAt = docData.savedAt.toDate();
          }
          data.push({
            id: doc.id,
            ...docData
          });
        });
        return data;
      } catch (error) {
        console.error("Error getting documents: ", error);
        return [];
      }
    }

    function initializeForms() {
      toggleFields();
      updatePercentage();
      handleEnterpriseCategoryChange();
    }

    function displayLaoDateForCalc() {
      const el = document.getElementById('date-lao-calc');
      if (!el) return;
      const laoDays = ["เบงเบฑเบเบญเบฒเบเบดเบ", "เบงเบฑเบเบเบฑเบ", "เบงเบฑเบเบญเบฑเบเบเบฒเบ", "เบงเบฑเบเบเบธเบ", "เบงเบฑเบเบเบฐเบซเบฑเบ", "เบงเบฑเบเบชเบธเบ", "เบงเบฑเบเปเบชเบปเบฒ"];
      const laoMonths = ["เบกเบฑเบเบเบญเบ", "เบเบธเบกเบเบฒ", "เบกเบตเบเบฒ", "เปเบกเบชเบฒ", "เบเบถเบเบชเบฐเบเบฒ", "เบกเบดเบเบธเบเบฒ", "เบเปเบฅเบฐเบเบปเบ", "เบชเบดเบเบซเบฒ", "เบเบฑเบเบเบฒ", "เบเบธเบฅเบฒ", "เบเบฐเบเบดเบ", "เบเบฑเบเบงเบฒ"];
      const now = new Date();
      el.textContent = `${laoDays[now.getDay()]}, เบงเบฑเบเบเบต ${now.getDate()} เปเบเบทเบญเบ ${laoMonths[now.getMonth()]} เบเบต ${now.getFullYear()}`;
    }

    function formatAndRestrictNumber(input) {
      let value = input.value.replace(/[^0-9]/g, '');
      if (value) {
        input.value = parseInt(value, 10).toLocaleString('en-US');
      } else {
        input.value = '';
      }
    }

    function toggleFields() {
      const category = document.getElementById('category').value;
      const pensionGroup = document.getElementById('pensionGroup');
      const wifeGroup = document.getElementById('wifeGroup');
      const wifeLabel = document.getElementById('wifeLabel');
      const deductionLabel = document.getElementById('deductionLabel');
      const taxLabel = document.getElementById('taxLabel');
      const isPension = category === 'pension';
      pensionGroup.classList.toggle('hidden', !isPension);
      wifeGroup.classList.toggle('hidden', isPension);
      if (wifeLabel) wifeLabel.style.display = isPension ? 'none' : 'flex';
      if (taxLabel) taxLabel.style.display = isPension ? 'none' : 'flex';
      if (deductionLabel) deductionLabel.innerHTML = `<strong>${isPension ? 'เบซเบฑเบเบเบฐเบเบฑเบเบชเบธเบเบฐเบเบฒเบ:' : 'เบซเบฑเบ 8%:'}</strong> <span id="deduction8">0</span> เบเบตเบ`;
    }

    function updatePercentage() {
      const detail = document.getElementById('detail').value;
      const group = document.getElementById('percentageGroup');
      const show = detail === 'เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ' || detail === 'เปเบเบตเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ';
      group.classList.toggle('hidden', !show);
    }

    function handleEnterpriseCategoryChange() {
      const category = document.getElementById('entCategory').value;
      const childrenGroup = document.getElementById('entChildrenField');
      const monthsInput = document.getElementById('months');
      const monthsLabel = document.getElementById('monthsLabel');
      const contributionLabel = document.getElementById('contributionLabel');
      monthsInput.disabled = false;
      monthsInput.value = '';
      monthsInput.min = '1';
      monthsInput.max = '';
      monthsLabel.textContent = 'เปเบเบทเบญเบ:';
      monthsInput.placeholder = "เบเปเบญเบเบเบณเบเบงเบเปเบเบทเบญเบ (เบเบปเบงเบขเปเบฒเบ: 12)";
      contributionLabel.textContent = 'เบเบณเบเบงเบเปเบเบตเบเบชเบปเบกเบเบปเบ 6 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ:';
      const showChildren = category === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ' || category === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ';
      childrenGroup.classList.toggle('hidden', !showChildren);
      if (category === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ' || category === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
        monthsLabel.textContent = 'เปเบเบทเบญเบเบเบฑเบเปเบปเบเบเบตเปเปเบเบปเปเบฒ เบญเบเบ:';
      }
      if (category === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ') {
        monthsInput.value = 1;
        monthsInput.disabled = true;
      } else if (category === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ') {
        monthsInput.placeholder = "เบเปเบญเบเปเบเบทเบญเบ (1-4)";
        monthsInput.min = '1';
        monthsInput.max = '4';
      } else if (category === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
        contributionLabel.textContent = 'เบเบณเบเบงเบเปเบเบตเบเบชเบปเบกเบเบปเบ <60 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ:';
        monthsInput.placeholder = "เบเปเบญเบเปเบเบทเบญเบ (1-59)";
        monthsInput.min = '1';
        monthsInput.max = '59';
      }
    }

    const clearForm = (formId, resultId, callback) => {
      document.getElementById(formId).reset();
      const resultEl = document.getElementById(resultId);
      if (resultEl) resultEl.classList.add('hidden');
      if (callback) callback();
    };
    const resetSalaryForm = () => clearForm('salaryForm', 'salaryResult', toggleFields);
    const clearGovForm = () => clearForm('bonusForm', 'govResult', updatePercentage);
    const clearEntForm = () => clearForm('supportForm', 'entResult', handleEnterpriseCategoryChange);

    function calculateYearlyBonus(years) {
      if (!APP_CONFIG) return 0;
      const tiers = APP_CONFIG.yearAllowanceTiers;
      for (const tier of tiers) {
        if (years <= tier.maxYears) {
          return (years - tier.previousMax) * tier.rate + tier.base;
        }
      }
      const lastTier = tiers[tiers.length - 1];
      return (years - lastTier.previousMax) * lastTier.rate + lastTier.base;
    }

    function calculateTax(taxableIncome) {
      if (!APP_CONFIG) return 0;
      const brackets = APP_CONFIG.taxBrackets;
      let previousMax = 0;
      for (const bracket of brackets) {
        if (taxableIncome <= bracket.max) {
          return (taxableIncome - previousMax) * bracket.rate + bracket.base;
        }
        previousMax = bracket.max;
      }
      return 0;
    }

    async function calculateSalary() {
      if (!APP_CONFIG) {
        showCustomPopup('error', 'เบเบดเบเบเบฒเบ', 'เบเปเปเบชเบฒเบกเบฒเบเบเบณเบเบงเบเปเบเป, เบเบฒเบเบเบฑเปเบเบเปเบฒเบเบฑเบเบเปเปเบเปเบญเบกเปเบเปเบเบฒเบ.');
        return;
      }
      const category = document.getElementById('category').value;
      const index = parseFloat(document.getElementById('index').value) || 0;
      const year = parseFloat(document.getElementById('year').value) || 0;
      const position = parseFloat(document.getElementById('position').value.replace(/,/g, '')) || 0;
      if (!category || !index || !year) {
        showCustomPopup('warning', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบ', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบเบเบตเปเบเบณเปเบเบฑเบ (เบเบฐเปเบเบ, เบเบฑเบเบชเบฐเบเบต, เบเบตเบเบฒเบ) เปเบซเปเบเบปเบเบเนเธงเธ.');
        return;
      }
      Swal.fire({
        title: 'เบเบณเบฅเบฑเบเบเบณเบเบงเบ...',
        allowOutsideClick: false,
        didOpen: () => Swal.showLoading()
      });
      const children = parseFloat(document.getElementById('children').value) || 0;
      const wife = parseFloat(document.getElementById('wife').value) || 0;
      const pensionPercent = parseFloat(document.getElementById('pensionPercent').value) || 0;
      const yearAllowance = calculateYearlyBonus(year);
      const livingAllowance = APP_CONFIG.salary.livingAllowance;
      const childAllowance = children * APP_CONFIG.salary.childAllowance;
      let totalBeforeDeduction, deduction, tax, totalNet, wifeAllowance;
      let dataToSave = {};
      if (category === 'civil') {
        totalBeforeDeduction = (index * APP_CONFIG.salary.indexMultiplier) + position + yearAllowance;
        wifeAllowance = wife * APP_CONFIG.salary.wifeAllowance;
        deduction = Math.floor(totalBeforeDeduction * APP_CONFIG.deductions.civilRate);
        const taxableIncome = totalBeforeDeduction - deduction;
        tax = Math.floor(calculateTax(taxableIncome));
        totalNet = Math.floor(totalBeforeDeduction - deduction - tax + childAllowance + wifeAllowance + livingAllowance);
        dataToSave = {
          category: 'เปเบเบตเบเปเบเบทเบญเบเบเบฐเบเบฑเบเบเบฒเบเบฅเบฑเบเบเบฐเบเบญเบ',
          index,
          year,
          position,
          children,
          wife,
          totalBeforeDeduction,
          yearAllowance,
          childAllowance,
          wifeAllowance,
          deduction,
          tax,
          livingAllowance,
          totalNet
        };
      } else {
        totalBeforeDeduction = ((index * APP_CONFIG.salary.indexMultiplier) + position + yearAllowance) * (pensionPercent / 100);
        wifeAllowance = 0;
        tax = 0;
        deduction = Math.floor(totalBeforeDeduction * APP_CONFIG.deductions.pensionHealthRate);
        totalNet = Math.floor(totalBeforeDeduction - deduction + childAllowance + livingAllowance);
        dataToSave = {
          category: 'เปเบเบตเบเปเบเบทเบญเบเบเบฐเบเบฑเบเบเบฒเบเบเบณเบเบฒเบ',
          index,
          year,
          position,
          children,
          pensionPercent,
          totalBeforeDeduction,
          yearAllowance,
          childAllowance,
          deduction,
          livingAllowance,
          totalNet
        };
      }
      Swal.close();
      document.getElementById('totalBeforeDeduction').textContent = totalBeforeDeduction.toLocaleString();
      document.getElementById('yearAllowance').textContent = yearAllowance.toLocaleString();
      document.getElementById('childAllowance').textContent = childAllowance.toLocaleString();
      document.getElementById('wifeAllowance').textContent = wifeAllowance.toLocaleString();
      document.getElementById('deduction8').textContent = deduction.toLocaleString();
      document.getElementById('tax').textContent = Math.round(tax).toLocaleString();
      document.getElementById('livingAllowance').textContent = livingAllowance.toLocaleString();
      document.getElementById('totalNet').textContent = totalNet.toLocaleString();
      document.getElementById('salaryResult').classList.remove('hidden');
      if (await saveDataToFirestore('salaryHistory', dataToSave)) {
        showCustomPopup('success', 'เบเบฑเบเบเบถเบเบชเบณเปเบฅเบฑเบ!', 'เบเบฒเบเบเบณเบเบงเบเปเบเปเบเบทเบเบเบฑเบเบเบถเบเบฅเบปเบเปเบเบเบฐเบซเบงเบฑเบเปเบฅเปเบง.');
      }
    }

    async function validateAndCalculateGovernment() {
      if (!APP_CONFIG) {
        showCustomPopup('error', 'เบเบดเบเบเบฒเบ', 'เบเปเปเบชเบฒเบกเบฒเบเบเบณเบเบงเบเปเบเป, เบเบฒเบเบเบฑเปเบเบเปเบฒเบเบฑเบเบเปเปเบเปเบญเบกเปเบเปเบเบฒเบ.');
        return;
      }
      const formData = {
        detail: document.getElementById('detail').value,
        index: parseFloat(document.getElementById('govIndex').value) || 0,
        serviceYears: parseInt(document.getElementById('serviceYears').value) || 0,
        positionSalary: parseFloat(document.getElementById('positionSalary').value.replace(/,/g, '')) || 0,
        percentage: parseFloat(document.getElementById('percentage').value) || 0
      };
      if (!formData.detail || !formData.index || !formData.serviceYears) {
        showCustomPopup('warning', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบ', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบเบเบตเปเบเบณเปเบเบฑเบเปเบซเปเบเบปเบเบเปเบงเบ.');
        return;
      }
      if ((formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ" || formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ") && (!formData.percentage || formData.percentage <= 0)) {
        showCustomPopup('warning', 'เบเปเปเบกเบนเบเบเปเปเบเบทเบเบเปเบญเบ', 'เบเบฐเบฅเบธเบเบฒเปเบชเปเปเบเบตเปเบเบฑเบเบเบณเบเบฒเบเบเบตเปเบเบทเบเบเปเบญเบ');
        return;
      }
      Swal.fire({
        title: 'เบเบณเบฅเบฑเบเบเบณเบเบงเบ...',
        allowOutsideClick: false,
        didOpen: () => Swal.showLoading()
      });
      const C = APP_CONFIG.govSubsidy;
      // [เปเบเปเปเบ] เบฎเบฑเบเบเบฐเบเบฑเบเบงเปเบฒเบเปเบฒเปเบเบดเบเบเปเบฒเบเปเปเบเบฑเบเปเบฅเบเบเปเบงเบ (เบเปเปเบกเบตเบเบธเบ)
      const baseMonthlySalary = Math.floor(formData.index * APP_CONFIG.salary.indexMultiplier);
      const yearlyBonus = Math.floor(calculateYearlyBonus(formData.serviceYears));
      const totalBeforePensionCalc = baseMonthlySalary + yearlyBonus + formData.positionSalary;

      let totalDeduction = 0;
      let monthsReceived = 0;
      let totalAmountReceived = 0;

      if (formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ") {
        totalDeduction = Math.floor(totalBeforePensionCalc * (C.severanceRate || 0.85));
        monthsReceived = C.severanceMultiplier || 1.5;
        // [เปเบเปเปเบ] เบเปเบฝเบเปเบเบฑเบ Math.floor เปเบเบทเปเบญเบเบฑเบเปเบฅเบเบเบปเบเบชเบฐเบเบดเบเบปเบกเบญเบญเบเบเบฒเบกเบเบตเปเบเปเบญเบเบเบฒเบ
        totalAmountReceived = Math.floor(totalDeduction * monthsReceived * formData.serviceYears);
      } else if (formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ") {
        totalDeduction = Math.floor(totalBeforePensionCalc * formData.percentage / 100);
        monthsReceived = C.widowAllowanceMonths;
        // [เปเบเปเปเบ] เปเบเบตเปเบก Math.floor เปเบเบทเปเบญเบเบฑเบเปเบฅเบเบเบปเบเบชเบฐเบเบดเบเบปเบกเบญเบญเบ
        totalAmountReceived = Math.floor((totalDeduction * C.widowPensionMultiplier) * monthsReceived);
      } else { // เบเปเบฅเบฐเบเบต: เปเบเบดเบเบญเบธเบเปเบธเบเปเบชเบเบเบตเบงเบดเบเบฅเบฑเบเบเบฐเบเบญเบ เปเบฅเบฐ เปเบเบดเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ
        totalDeduction = (formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ") ?
          Math.floor(totalBeforePensionCalc * formData.percentage / 100) :
          totalBeforePensionCalc;

        if (formData.serviceYears < C.deathAllowanceYearsLimit) {
          monthsReceived = formData.serviceYears + C.deathAllowanceBaseMonths;
        } else {
          // [เปเบเปเปเบ] เบฅเบถเบ Math.floor เบญเบญเบเบเบฒเบเบเบฒเบเบเบณเบเบงเบเปเบเบทเบญเบ เปเบเบทเปเบญเปเบซเปเปเบเปเบเบปเบเบฅเบฑเบเปเบเบฑเบเบเบปเบเบชเบฐเบเบดเบเบปเบก (เปเบเบฑเปเบ 37.5)
          monthsReceived = ((formData.serviceYears + C.deathAllowanceFormulaMonths1) / C.deathAllowanceFormulaMonths2) + C.deathAllowanceFormulaMonths3;
        }
        // [เปเบเปเปเบ] เปเบเบตเปเบก Math.floor เปเบซเปเบเบฑเบเบเบปเบเบฅเบงเบกเบชเบธเบเบเปเบฒเบ เปเบเบทเปเบญเบเบฑเบเปเบฅเบเบเบปเบเบชเบฐเบเบดเบเบปเบกเบญเบญเบ
        totalAmountReceived = Math.floor(totalDeduction * monthsReceived);
      }
      Swal.close();

      // [เบเปเปเบเปเบฝเบเปเบเบ] เบชเปเบงเบเบชเบฐเปเบเบเบเบปเบ
      document.getElementById('govBaseMonthlySalary').innerText = `${baseMonthlySalary.toLocaleString('en-US')}`;
      document.getElementById('govYearlyBonus').innerText = `${yearlyBonus.toLocaleString('en-US')}`;
      document.getElementById('govTotalDeduction').innerText = `${totalDeduction.toLocaleString('en-US')}`;
      document.getElementById('govMonthsReceived').innerText = `${monthsReceived}`; // เบเบฐเบชเบฐเปเบเบเปเบฅเบเบเบปเบเบชเบฐเบเบดเบเบปเบกเปเบเป
      document.getElementById('govTotalAmountReceived').innerText = `${totalAmountReceived.toLocaleString('en-US')}`;
      document.getElementById('govResult').classList.remove('hidden');

      const saveData = { ...formData,
        baseMonthlySalary,
        yearlyBonus,
        totalDeduction,
        monthsReceived,
        totalAmountReceived
      };
      if (await saveDataToFirestore('govSupportHistory', saveData)) {
        showCustomPopup('success', 'เบเบฑเบเบเบถเบเบชเบณเปเบฅเบฑเบ!', 'เบเบฒเบเบเบณเบเบงเบเปเบเปเบเบทเบเบเบฑเบเบเบถเบเบฅเบปเบเปเบเบเบฐเบซเบงเบฑเบเปเบฅเปเบง.');
      }
    }


    async function calculateEnterprise() {
      if (!APP_CONFIG) {
        showCustomPopup('error', 'เบเบดเบเบเบฒเบ', 'เบเปเปเบชเบฒเบกเบฒเบเบเบณเบเบงเบเปเบเป, เบเบฒเบเบเบฑเปเบเบเปเบฒเบเบฑเบเบเปเปเบเปเบญเบกเปเบเปเบเบฒเบ.');
        return;
      }
      const data = {
        category: document.getElementById('entCategory').value,
        contribution: parseFloat(document.getElementById('contribution').value.replace(/,/g, '')) || 0,
        months: parseFloat(document.getElementById('months').value) || 0,
        children: parseFloat(document.getElementById('entChildren').value) || 0
      };
      if (!data.category || !data.contribution || !data.months || ((data.category === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ' || data.category === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ') && !data.children)) {
        showCustomPopup('warning', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบ', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบเบเบตเปเบเบณเปเบเบฑเบเปเบซเปเบเบปเบเบเปเบงเบ.');
        return;
      }
      Swal.fire({
        title: 'เบเบณเบฅเบฑเบเบเบณเบเบงเบ...',
        allowOutsideClick: false,
        didOpen: () => Swal.showLoading()
      });
      const C = APP_CONFIG.entSubsidy;
      let result = 0;
      const avgContribution = Math.floor(data.contribution / C.baseMonths);
      if (data.category === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ') {
        result = Math.round(avgContribution * C.childbirthBenefitMultiplier) * data.children;
      } else if (data.category === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ') {
        const M = C.childbirthAllowanceMultipliers;
        const childBenefit = data.children * Math.round(avgContribution * C.childbirthBenefitMultiplier);
        if (data.months == 1) result = (Math.round(avgContribution * M.month1)) + childBenefit;
        else if (data.months == 2) result = Math.round(avgContribution * M.month2);
        else if (data.months == 3) result = Math.round(avgContribution * M.month3);
        else if (data.months == 4) result = Math.round(avgContribution * M.month4) + childBenefit;
      } else if (data.category === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ') {
        const D = C.deathBenefit;
        var years = Math.floor(data.months / 12);
        if (years < D.yearLimit) {
          result = (years + D.baseMonths) * avgContribution;
        } else {
          result = (Math.floor((years + D.formulaMonths1) / 2) + D.formulaMonths3) * avgContribution;
        }
      } else if (data.category === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
        const S = C.severancePay;
        var effectiveMonths = data.months < (S.maxMonths + 1) ? data.months : S.maxMonths;
        var years = Math.floor(data.months / 12);
        result = Math.floor(data.contribution / effectiveMonths) * S.yearMultiplier * years;
      }
      Swal.close();
      const resultFormatted = result.toFixed(0);
      document.getElementById('entTotal').innerText = parseFloat(resultFormatted).toLocaleString('en-US');
      document.getElementById('entResult').classList.remove('hidden');
      const saveData = { ...data,
        totalAmountReceived: resultFormatted
      };
      if (await saveDataToFirestore('entSupportHistory', saveData)) {
        showCustomPopup('success', 'เบเบฑเบเบเบถเบเบชเบณเปเบฅเบฑเบ!', 'เบเบฒเบเบเบณเบเบงเบเปเบเปเบเบทเบเบเบฑเบเบเบถเบเบฅเบปเบเปเบเบเบฐเบซเบงเบฑเบเปเบฅเปเบง.');
      }
    }

    const indexData = [
      ['เบเบฑเปเบ/เบเบฑเปเบ', 'เบเบฑเบเบชเบฐเบเบต', 'เบเบปเบงเบเบนเบ', 'เบเบฒเบเบชเปเบงเบ'],
      ['1/1', 135, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/2', 136, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/3', 137, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/4', 138, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/5', 139, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/6', 140, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/7', 141, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/8', 144, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/9', 147, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/10', 150, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/11', 153, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/12', 156, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/13', 159, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/14', 162, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/15', 165, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/1', 147, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/2', 150, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/3', 153, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/4', 156, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/5', 159, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/6', 162, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/7', 165, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/8', 170, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/9', 175, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/10', 180, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/11', 185, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/12', 190, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/13', 195, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/14', 200, 7350, 'เบเบปเบเบเบญเบ'],
      ['2/15', 205, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/1', 175, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/2', 180, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/3', 185, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/4', 190, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/5', 195, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/6', 200, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/7', 205, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/8', 212, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/9', 219, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/10', 226, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/11', 233, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/12', 240, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/13', 247, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/14', 254, 7350, 'เบเบปเบเบเบญเบ'],
      ['3/15', 261, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/1', 219, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/2', 226, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/3', 233, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/4', 240, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/5', 247, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/6', 254, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/7', 261, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/8', 270, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/9', 279, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/10', 288, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/11', 297, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/12', 306, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/13', 315, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/14', 324, 7350, 'เบเบปเบเบเบญเบ'],
      ['4/15', 333, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/1', 279, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/2', 288, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/3', 297, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/4', 306, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/5', 315, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/6', 324, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/7', 333, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/8', 344, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/9', 355, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/10', 366, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/11', 377, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/12', 388, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/13', 399, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/14', 410, 7350, 'เบเบปเบเบเบญเบ'],
      ['5/15', 421, 7350, 'เบเบปเบเบเบญเบ'],
      ['6/1', 425, 7350, 'เบเบปเบเบเบญเบ'],
      ['6/2', 450, 7350, 'เบเบปเบเบเบญเบ'],
      ['6/3', 485, 7350, 'เบเบปเบเบเบญเบ'],
      ['6/4', 530, 7350, 'เบเบปเบเบเบญเบ'],
      ['6/5', 585, 7350, 'เบเบปเบเบเบญเบ'],
      ['6/6', 650, 7350, 'เบเบปเบเบเบญเบ'],
      ['6/7', 700, 7350, 'เบเบปเบเบเบญเบ'],
      ['1/1', 156, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/2', 159, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/3', 162, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/4', 165, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/5', 170, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/6', 175, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/7', 180, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/8', 185, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/9', 190, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/10', 195, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/11', 200, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/12', 205, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/13', 212, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/14', 219, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/15', 226, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/16', 233, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/17', 240, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/18', 247, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/19', 254, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/20', 261, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/21', 270, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/22', 279, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/23', 288, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/24', 297, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['1/25', 306, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/1', 209, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/2', 218, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/3', 227, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/4', 236, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/5', 245, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/6', 256, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/7', 267, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/8', 278, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/9', 289, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/10', 300, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/11', 313, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/12', 326, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/13', 339, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/14', 352, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['2/15', 365, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/1', 260, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/2', 273, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/3', 286, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/4', 299, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/5', 312, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/6', 327, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/7', 342, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/8', 357, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/9', 372, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/10', 387, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/11', 404, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/12', 421, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/13', 438, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/14', 455, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['3/15', 472, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/1', 308, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/2', 323, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/3', 338, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/4', 353, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/5', 368, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/6', 385, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/7', 402, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/8', 419, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/9', 436, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/10', 453, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/11', 470, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/12', 475, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/13', 480, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/14', 485, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['4/15', 490, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/1', 369, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/2', 384, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/3', 399, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/4', 414, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/5', 429, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/6', 444, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/7', 459, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/8', 474, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/9', 489, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/10', 505, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/11', 510, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/12', 515, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/13', 520, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/14', 525, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/15', 530, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/16', 535, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/17', 540, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/18', 545, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/19', 550, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/20', 555, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/21', 560, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/22', 565, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/23', 570, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/24', 575, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
      ['5/25', 580, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
    ];

    async function searchData() {
      const collectionName = document.getElementById('combobox1').value;
      const searchTerm = document.getElementById('textbox1').value.trim().toLowerCase();
      if (!collectionName) {
        showCustomPopup('warning', 'เบเบฐเบฅเบธเบเบฒเปเบฅเบทเบญเบ', 'เบเบฐเบฅเบธเบเบฒเปเบฅเบทเบญเบเบฅเบฒเบเบเบฒเบเบเบตเปเบเบฐเบเบปเปเบเบซเบฒเบเปเบญเบ!');
        return;
      }
      Swal.fire({
        title: 'เบเบณเบฅเบฑเบเบเบปเปเบเบซเบฒ...',
        allowOutsideClick: false,
        didOpen: () => Swal.showLoading()
      });
      let headers = [];
      let dataRows = [];
      if (collectionName === 'indexData') {
        headers = indexData[0];
        let data = indexData.slice(1);
        if (searchTerm) {
          data = data.filter(row => row.some(cell => cell && cell.toString().toLowerCase().includes(searchTerm)));
        }
        dataRows = data;
      } else {
        const firestoreData = await getDataFromFirestore(collectionName);
        switch (collectionName) {
          case 'salaryHistory':
            headers = ['เบงเบฑเบเบเบต', 'เปเบเบทเปเบญเปเบ', 'เบเบฑเบเบชเบฐเบเบต', 'เบเบตเบเบฒเบ', 'เบเบณเปเปเปเบ', 'เบฅเบนเบ', 'เปเบกเบ', '%เบเบณเบเบฒเบ', 'เบฅเบงเบกเบเปเบญเบเบซเบฑเบ', 'เปเบเบดเบเบเบตเบเบฒเบ', 'เปเบเบดเบเบฅเบนเบ', 'เปเบเบดเบเปเบกเบ', 'เบซเบฑเบ(8%/เบเบฐเบเบฑเบ)', 'เบญเบฒเบเบญเบ', 'เบเปเบฒเบเบญเบเบเบตเบ', 'เบฅเบงเบกเบเบฑเบเปเบปเบ'];
            dataRows = firestoreData.map(r => {
              const isCivil = r.category === 'เปเบเบตเบเปเบเบทเบญเบเบเบฐเบเบฑเบเบเบฒเบเบฅเบฑเบเบเบฐเบเบญเบ';
              return [r.savedAt ? new Date(r.savedAt).toLocaleString('lo-LA') : 'N/A', r.category, r.index, r.year, r.position, r.children, isCivil ? r.wife : '-', isCivil ? '-' : r.pensionPercent, r.totalBeforeDeduction, r.yearAllowance, r.childAllowance, isCivil ? r.wifeAllowance : '-', r.deduction, isCivil ? r.tax : '-', r.livingAllowance, r.totalNet, r.id];
            });
            break;
          case 'govSupportHistory':
            headers = ['เบงเบฑเบเบเบต', 'เปเบเบทเปเบญเปเบ', 'เบเบฑเบเบชเบฐเบเบต', 'เบเบตเบเบฒเบ', 'เบเบณเปเปเปเบ', '%เบเบณเบเบฒเบ', 'เปเบเบดเบเปเบเบทเบญเบเบเบทเปเบเบเบฒเบ', 'เปเบเบดเบเบเบตเบเบฒเบ', 'เบฅเบงเบกเบเปเบญเบเบซเบฑเบ', 'เปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบ', 'เบฅเบงเบกเบเบฑเบเปเบปเบ'];
            dataRows = firestoreData.map(r => [r.savedAt ? new Date(r.savedAt).toLocaleString('lo-LA') : 'N/A', r.detail, r.index, r.serviceYears, r.positionSalary, r.percentage || '-', r.baseMonthlySalary, r.yearlyBonus, r.totalDeduction, r.monthsReceived, r.totalAmountReceived, r.id]);
            break;
          case 'entSupportHistory':
            headers = ['เบงเบฑเบเบเบต', 'เปเบเบทเปเบญเปเบ', 'เปเบเบดเบเบชเบปเบกเบเบปเบ', 'เปเบเบทเบญเบ', 'เบเบณเบเบงเบเบฅเบนเบ', 'เบฅเบงเบกเบเบฑเบเปเบปเบ'];
            dataRows = firestoreData.map(r => [r.savedAt ? new Date(r.savedAt).toLocaleString('lo-LA') : 'N/A', r.category, r.contribution, r.months, r.children, r.totalAmountReceived, r.id]);
            break;
        }
        if (searchTerm) {
          dataRows = dataRows.filter(row => row.slice(0, -1).some(cell => cell && cell.toString().toLowerCase().includes(searchTerm)));
        }
      }
      displaySearchResults(collectionName, [headers, ...dataRows]);
      Swal.close();
    }



    function displaySearchResults(collectionName, parsedData) {
      const tableHeader = document.getElementById('table-header');
      const tableBody = document.getElementById('table-body');
      tableHeader.innerHTML = '';
      tableBody.innerHTML = '';
      document.getElementById('searchResult').classList.remove('hidden');
      if (parsedData.length <= 1) {
        const colspan = (parsedData[0] || []).length + 1;
        tableBody.innerHTML = `<tr><td colspan="${colspan}" class="text-center p-4">เบเปเปเบเบปเบเบเปเปเบกเบนเบเบเบตเปเบเบปเบเบเบฑเบเบเบฒเบเบเบปเปเบเบซเบฒ</td></tr>`;
        return;
      }
      const headers = [...parsedData[0], 'เบเบณเปเบเบตเบเบเบฒเบ'];
      headers.forEach(header => {
        const th = document.createElement('th');
        th.textContent = header;
        th.scope = 'col';
        th.className = 'px-6 py-3';
        tableHeader.appendChild(th);
      });
      const rows = parsedData.slice(1);
      rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = "border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600";
        const docId = collectionName !== 'indexData' ? row[row.length - 1] : null;
        const displayRow = collectionName !== 'indexData' ? row.slice(0, -1) : row;
        const rowType = row[1];
        displayRow.forEach((value, index) => {
          const td = document.createElement('td');
          td.className = "px-6 py-4";
          const header = headers[index];
          let customLabel = header;
          let displayValue = value;
          if (collectionName === 'govSupportHistory' && rowType === 'เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
            if (header === '%เบเบณเบเบฒเบ') {
              td.classList.add('mobile-hidden');
            }
            if (header === 'เปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบ') {
              customLabel = 'เปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบ';
              displayValue = '1.5';
            }
          }
          if (collectionName === 'entSupportHistory') {
            if ((rowType === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ' || rowType === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') && header === 'เบเบณเบเบงเบเบฅเบนเบ') {
              td.classList.add('mobile-hidden');
            }
            if (header === 'เปเบเบดเบเบชเบปเบกเบเบปเบ') {
              if (rowType === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ' || rowType === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ' || rowType === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ') {
                customLabel = 'เปเบเบตเบเบชเบปเบเบเบปเบ 6 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ';
              } else if (rowType === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
                customLabel = 'เปเบเบตเบเบชเบปเบเบเบปเบ <60 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ';
              }
            }
            if (header === 'เปเบเบทเบญเบ') {
              if (rowType === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ' || rowType === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
                customLabel = 'เปเบเบทเบญเบเบเบฑเบเปเบปเบเบเบตเปเปเบเบปเปเบฒ เบญเบเบ';
              }
            }
          }
          td.setAttribute('data-label', customLabel);
          let finalDisplayValue;
          if (collectionName === 'entSupportHistory' && header === 'เบฅเบงเบกเบเบฑเบเปเบปเบ') {
            finalDisplayValue = parseFloat(displayValue).toLocaleString('en-US', {
              maximumFractionDigits: 0
            });
          } else if (typeof displayValue === 'number' && displayValue >= 1000) {
            finalDisplayValue = displayValue.toLocaleString('en-US', {
              maximumFractionDigits: 2
            });
          } else {
            finalDisplayValue = value === '-' ?
              '' : (displayValue === null || typeof displayValue === 'undefined' ? '' : displayValue);
          }
          td.textContent = finalDisplayValue;
          if (value === '-' || value === '' || value === null || typeof value === 'undefined') {
            td.classList.add('mobile-hidden');
          }
          tr.appendChild(td);
        });
        const actionTd = document.createElement('td');
        actionTd.className = 'px-6 py-4 flex items-center justify-center gap-2';
        const downloadBtn = document.createElement('button');
        downloadBtn.className = 'text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm p-2 text-center';
        downloadBtn.innerHTML = '<i class="fas fa-download"></i>';
        downloadBtn.onclick = () => downloadRowAsImage(tr);
        actionTd.appendChild(downloadBtn);
        if (IS_ADMIN && collectionName !== 'indexData') {
          const editBtn = document.createElement('button');
          editBtn.className = 'text-white bg-orange-500 hover:bg-orange-600 font-medium rounded-lg text-sm p-2 text-center';
          editBtn.innerHTML = '<i class="fas fa-edit"></i>';
          editBtn.onclick = () => editRecord(collectionName, docId);
          actionTd.appendChild(editBtn);
          const deleteBtn = document.createElement('button');
          deleteBtn.className = 'text-white bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm p-2 text-center';
          deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
          deleteBtn.onclick = () => deleteRecord(collectionName, docId);
          actionTd.appendChild(deleteBtn);
        }
        tr.appendChild(actionTd);
        tableBody.appendChild(tr);
      });
    }

    function downloadRowAsImage(elementToCapture) {
      if (!elementToCapture) return;
      Swal.fire({
        title: 'เบเบณเบฅเบฑเบเบชเปเบฒเบเบฎเบนเบเบเบฒเบ...',
        allowOutsideClick: false,
        didOpen: () => Swal.showLoading()
      });
      const actionCell = elementToCapture.lastElementChild;
      const originalDisplay = actionCell.style.display;
      actionCell.style.display = 'none';
      html2canvas(elementToCapture, {
        scale: 2,
        backgroundColor: '#111827',
        useCORS: true
      }).then(canvas => {
        actionCell.style.display = originalDisplay;
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/jpeg', 0.95);
        link.download = `calculation_result_${Date.now()}.jpg`;
        link.click();
        Swal.close();
        showCustomPopup('success', 'เบเบฑเบเบเบถเบเบฎเบนเบเบเบฒเบเปเบฅเปเบง!');
      }).catch(error => {
        actionCell.style.display = originalDisplay;
        showCustomPopup('error', 'เบเบดเบเบเบฒเบ', `เบเปเปเบชเบฒเบกเบฒเบเบเบฑเบเบเบถเบเบฎเบนเบเบเบฒเบเปเบเป: ${error}`);
      });
    }

    async function loadAdminList() {
      try {
        if (!window.db || !window.firestoreFunctions) return;
        const {
          collection,
          getDocs
        } = window.firestoreFunctions;
        const adminSnapshot = await getDocs(collection(window.db, "admins"));
        adminSnapshot.forEach((doc) => {
          if (doc.data().email) ADMIN_EMAILS.push(doc.data().email);
        });
        console.log("Admin list loaded:", ADMIN_EMAILS);
      } catch (error) {
        console.error("Could not load admin list:", error);
      }
    }

    async function adminLogin() {
      if (IS_ADMIN) {
        showCustomPopup('success', 'เปเบเบปเปเบฒเบชเบนเปเบฅเบฐเบเบปเบเปเบฅเปเบง', 'เบเปเบฒเบเปเบเปเปเบเบปเปเบฒเบชเบนเปเบฅเบฐเบเบปเบเปเบเบเบฒเบเบฐเบเบนเปเบเบนเปเบฅเบฅเบฐเบเบปเบเปเบฅเปเบง.');
        return;
      }
      const {
        value: email
      } = await Swal.fire({
        title: 'เปเบเบปเปเบฒเบชเบนเปเบฅเบฐเบเบปเบ Admin',
        input: 'email',
        inputPlaceholder: 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบญเบตเปเบกเบง admin เบเบญเบเบเปเบฒเบ'
      });
      if (email && ADMIN_EMAILS.includes(email)) {
        IS_ADMIN = true;
        document.getElementById('adminLoginLink').textContent = `เบชเบฐเบเบฒเบเบเบต, ${email.split('@')[0]}`;
        Swal.fire('เบชเบณเปเบฅเบฑเบ!', 'เบเปเบฒเบเปเบเปเปเบเบปเปเบฒเบชเบนเปเบฅเบฐเบเบปเบเปเบเบเบฒเบเบฐเบเบนเปเบเบนเปเบฅเบฅเบฐเบเบปเบ.', 'success');
      } else if (email) {
        Swal.fire('เบเบดเบเบเบฒเบ!', 'เบญเบตเปเบกเบงเบเบตเปเบเปเปเปเบกเปเบเบเบนเปเบเบนเปเบฅเบฅเบฐเบเบปเบ.', 'error');
      }
    }

    function editRecord(collectionName, docId) {
      if (!IS_ADMIN) {
        showCustomPopup('error', 'เบเปเปเบกเบตเบชเบดเบ', 'เบเปเบฒเบเบเปเปเนเธเนเธฃเธฑเธเบญเบฐเบเบธเบเบฒเบเปเบซเปเบเบณเปเบเบตเบเบเบฒเบเบเบตเป.');
        return;
      }
      Swal.fire('เปเบเปเบเปเบเบทเบญเบ', `เบเบฑเบเบเบฑเบเปเบเปเปเบเบเบฑเบเบเปเปเบเปเบญเบกเปเบเปเบเบฒเบ.\nCollection: ${collectionName}\nID: ${docId}`, 'info');
    }

    async function deleteRecord(collectionName, docId) {
      if (!IS_ADMIN) {
        showCustomPopup('error', 'เบเปเปเบกเบตเบชเบดเบ', 'เบเปเบฒเบเบเปเปเนเธเนเธฃเธฑเธเบญเบฐเบเบธเบเบฒเบเปเบซเปเบเบณเปเบเบตเบเบเบฒเบเบเบตเป.');
        return;
      }
      const {
        doc,
        deleteDoc
      } = window.firestoreFunctions;
      Swal.fire({
        title: 'เบเปเบฒเบเปเบเปเปเบเบเปเป?',
        text: "เบเปเบฒเบเบเบฐเบเปเปเบชเบฒเบกเบฒเบเบเบนเปเบเบทเบเบเปเปเบกเบนเบเบเบตเปเปเบเป!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#10b981',
        cancelButtonColor: '#ef4444',
        confirmButtonText: 'เปเบกเปเบ, เบฅเบถเบเปเบฅเบตเบ!',
        cancelButtonText: 'เบเบปเบเปเบฅเบตเบ'
      }).then(async (result) => {
        if (result.isConfirmed) {
          try {
            await deleteDoc(doc(window.db, collectionName, docId));
            Swal.fire('เบฅเบถเบเบชเบณเปเบฅเบฑเบ!', 'เบเปเปเบกเบนเบเปเบเปเบเบทเบเบฅเบถเบเบญเบญเบเปเบฅเปเบง.', 'success');
            document.getElementById('searchButton').click();
          } catch (error) {
            console.error("Error deleting document: ", error);
            Swal.fire('เบเบดเบเบเบฒเบ!', 'เบเปเปเบชเบฒเบกเบฒเบเบฅเบถเบเบเปเปเบกเบนเบเปเบเป.', 'error');
          }
        }
      });
    }
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js')
          .then(registration => {
            console.log('Service Worker registered: ', registration);
          })
          .catch(error => {
            console.log('Service Worker registration failed: ', error);
          });
      });
    }
  </script>

</body>

</html>

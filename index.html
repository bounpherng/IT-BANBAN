<!DOCTYPE html>
<html lang="lo" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IT-banban</title>

  <meta name="description" content="เปเบงเบฑเบเปเบเบเปเปเบซเปเบเปเปเบกเบนเบ เปเบฅเบฐ เบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเบเบฐเปเบเบเบเปเบฒเบเปเบเบญเบเบเบฒเบเบฅเบฑเบ เปเบฅเบฐ เบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ." />
  <meta name="theme-color" content="#10b981" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./icon-192.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Lao:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Noto Sans Lao', 'sans-serif'],
     
     },
     
    aspectRatio: {
            '16/9': '16 / 9',
          },
        }
      }
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  
  <style>
    body { font-family: 'Noto Sans Lao', sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
    .page { display: none; }
    .page.active { display: block; animation: fadeIn 0.5s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .swal2-popup { font-family: 'Noto Sans Lao', sans-serif; }
    .calc-section { display: none; }
    .calc-section.active { display: block; animation: fadeIn 0.5s ease-in-out; }
    /* [FIX-1] Removed !important from .hidden to allow Tailwind's responsive classes (like md:flex) to work correctly.
 [เบเบฒเบเปเบเปเปเบ-1] เบฅเบถเบ !important เบญเบญเบเบเบฒเบ .hidden เปเบเบทเปเบญเปเบซเป class responsive เบเบญเบ Tailwind (เปเบเบฑเปเบ md:flex) เปเบฎเบฑเบเบงเบฝเบเปเบเปเบเบทเบเบเปเบญเบ.
 */
    .hidden { display: none; } 
    #image-slider .slider-track { 
        transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); will-change: transform;
}
    #fab-home-button { transition: opacity 0.3s, transform 0.3s; }
    #fab-home-button.hidden { opacity: 0;
transform: scale(0.5); pointer-events: none; }
    
    /* --- CSS เบเบฑเบเบเบธเบเปเปเปเบชเบณเบฅเบฑเบ Slider Dots --- */
    #slider-dots button {
      width: 0.75rem; /* 12px */
      height: 0.75rem;
      border-radius: 9999px;
      background-color: rgba(255, 255, 255, 0.5); transition: all 0.3s ease-in-out;
    }
    #slider-dots button.active {
      background-color: white;
      transform: scale(1.25); }
    /* --- เบชเบดเปเบเบชเบธเบ CSS เบเบฑเบเบเบธเบเปเปเป --- */

    @media (max-width: 768px) {
      #searchResult .table-container table, #searchResult .table-container thead, #searchResult .table-container tbody, #searchResult .table-container th, #searchResult .table-container td, #searchResult .table-container tr { display: block; }
      #searchResult .table-container thead tr { position: absolute; top: -9999px; left: -9999px; }
      #searchResult .table-container tr { border: 1px solid #4a5568; border-radius: 0.75rem; margin-bottom: 0.75rem; background: rgba(0, 0, 0, 0.2); padding: 0.75rem; }
      #searchResult .table-container td { border: none; border-bottom: 1px solid #2d3748; position: relative; padding-left: 45%; padding-top: 10px; padding-bottom: 10px; text-align: right; min-height: 38px; display: flex; align-items: center; justify-content: flex-end; }
      #searchResult .table-container td:before { content: attr(data-label); position: absolute; left: 12px; width: 40%; padding-right: 10px; white-space: nowrap; text-align: left; font-weight: bold; color: #10b981; }
      #searchResult .table-container td:last-child { border-bottom: 0; justify-content: center; padding-left: 0; }
      #searchResult .table-container td:last-child::before { display: none; }
      #searchResult .table-container td.mobile-hidden { display: none; }
    }
    /* Accordion Styles */
    details > summary { list-style: none; }
    details > summary::-webkit-details-marker { display: none; }
    details > summary::after { content: '+'; float: right; font-size: 1.5rem; line-height: 1; font-weight: 300; transition: transform 0.2s ease-in-out; }
    details[open] > summary::after { transform: rotate(45deg); }
    details[open] .accordion-content { animation: fadeIn 0.4s ease-in-out; }

  </style>
  <script>
    if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark'); } else {
      document.documentElement.classList.remove('dark');
    }
  </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 text-sm md:text-base flex flex-col min-h-screen transition-colors duration-300">

  <header class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg sticky top-0 z-50 border-b border-gray-200 dark:border-gray-700">
    <div class="container mx-auto px-4">
      <nav class="flex justify-between items-center py-3">
        <a href="#" onclick="showPage('home')" class="flex items-center space-x-3 text-xl font-bold text-gray-900 dark:text-white cursor-pointer">
          <img src="https://i.ibb.co/36359Bf/image.png" alt="Logo" class="w-10 h-10 rounded-full">
          <span>IT-banban</span>
       


  </a>
        
        <div class="hidden md:flex items-center space-x-6 text-base font-semibold ml-auto" id="desktop-nav">
          <a href="#" onclick="showPage('home')" class="hover:text-emerald-500 transition-colors nav-link" data-page="home">เปเปเบฒเบซเบผเบฑเบ</a>
          <a href="#" onclick="showPage('gov-guide')" class="hover:text-emerald-500 transition-colors nav-link" data-page="gov-guide">เบญเบธเบเปเบธเบเบเบฒเบเบฅเบฑเบ</a>
          <a href="#" onclick="showPage('ent-guide')" class="hover:text-emerald-500 transition-colors nav-link" data-page="ent-guide">เบญเบธเบเปเบธเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ</a>
          <a href="#" onclick="showPage('calculator')" class="hover:text-emerald-500 transition-colors nav-link" data-page="calculator">เปเบเบทเปเบญเบเบเบณเบเบงเบ</a>
          



<a href="#" onclick="showPage('contact')" class="hover:text-emerald-500 transition-colors nav-link" data-page="contact">เบเปเบฝเบงเบเบฑเบ</a>
        </div>

        <div class="flex items-center gap-2">
           <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg text-sm p-2.5">
             <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
             <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path 



d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm-.707 10.607a1 1 0 010-1.414l.707-.707a1 1 0 111.414 1.414l-.707-.707a1 1 0 01-1.414 0zM3 11a1 1 0 100 2h1a1 1 0 100-2H3z"></path></svg>
          



 </button>
            <button id="mobile-menu-button" class="md:hidden p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </div>
      </nav>
      
      <div id="mobile-menu" class="hidden flex-col md:hidden pb-4">
         



 <a href="#" onclick="showPage('home')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-900 dark:text-white hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-md">
             <i class="fas fa-home w-5"></i> เปเปเบฒเบซเบผเบฑเบ
          </a>
          <a href="#" onclick="showPage('gov-guide')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-900 dark:text-white hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-md">
             <i class="fas fa-landmark w-5"></i> เบญเบธเบเปเบธเบเบเบฒเบเบฅเบฑเบ
          </a>
         



 <a href="#" onclick="showPage('ent-guide')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-900 dark:text-white hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-md">
             <i class="fas fa-building w-5"></i> เบญเบธเบเปเบธเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ
          </a>
          <a href="#" onclick="showPage('calculator')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-900 dark:text-white hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-md">
             <i class="fas fa-calculator w-5"></i> เปเบเบทเปเบญเบเบเบณเบเบงเบ
          </a>
         



 <a href="#" onclick="showPage('contact')" class="flex items-center gap-2 py-2 px-3 text-base text-gray-900 dark:text-white hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-md">
             <i class="fas fa-info-circle w-5"></i> เบเปเบฝเบงเบเบฑเบ
          </a>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-6 md:py-12 flex-grow">
    
    <div id="home-page" class="page space-y-10 md:space-y-16">
      
<section class="text-center py-12 px-4">
  <h1 class="text-3xl md:text-5xl font-extrabold tracking-tight leading-tight text-emerald-600 dark:text-emerald-400">
    เบเบดเบเบเบตเบเปเบญเบเบฎเบฑเบเบชเบนเป : IT-banban
  </h1>
  <p class="mt-5 text-base sm:text-lg md:text-xl text-emerald-700 dark:text-emerald-300 max-w-3xl mx-auto leading-relaxed">
    เปเบงเบฑเบเปเบเบเปเปเบซเปเบเปเปเบกเบนเบ เปเบฅเบฐ เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเบเบฐเปเบเบเบเปเบฒเบเปเบเบญเบเบเบฒเบเบฅเบฑเบ เปเบฅเบฐ เบงเบดเบชเบฒเบซเบฐเบเบดเบ
  </p>
  <p id="date-lao-calc" class="mt-4 text-lg font-semibold text-emerald-600 dark:text-emerald-400"></p>
  <hr class="border-t-2 border-emerald-500 my-4">
</section>



<section id="image-slider" class="relative w-full max-w-5xl mx-auto shadow-2xl rounded-2xl overflow-hidden">

<div class="slider-track flex bg-gray-200 dark:bg-gray-800">
  <img src="https://i.ibb.co/nqTv1vZV/1.jpg" alt="i.1" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/Ts5MSmR/2.jpg" alt="i.2" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/wFf12DQT/3.jpg" alt="i.3" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/0yN9yVwk/4.jpg" alt="i.4" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/sJQ4ZDHh/5.jpg" alt="i.5" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/gbpmb9mv/6.jpg" alt="i.6" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/bMLV5gWX/7.jpg" alt="i.7" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/JWZvhrVY/8.jpg" alt="i.8" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/rKjghb9t/9.jpg" alt="i.9" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/tTmj9syL/10.jpg" alt="i.10" class="w-full flex-shrink-0 object-contain h-64 md:h-96">
  <img src="https://i.ibb.co/j9d2fWhL/23.jpg" alt="i.23" class="w-full flex-shrink-0 object-contain h-64 md:h-96">

</div>

	
	
    <button id="slider-prev" class="absolute top-1/2 left-4 transform -translate-y-1/2 bg-black/40 text-white p-3 rounded-full hover:bg-black/60 hover:scale-110 active:scale-95 transition-all duration-300 ease-in-out">
      <i class="fas fa-chevron-left"></i>
    </button>
    <button id="slider-next" class="absolute top-1/2 right-4 transform -translate-y-1/2 bg-black/40 text-white p-3 rounded-full hover:bg-black/60 hover:scale-110 active:scale-95 transition-all duration-300 ease-in-out">
      <i class="fas fa-chevron-right"></i>
    </button>
    <div id="slider-dots" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2"></div>
</section>


      <section class="max-w-4xl mx-auto">
        <div class="text-center mb-8">
            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white">เปเบเบทเปเบญเบเบกเบทเปเบเบตเปเบกเปเบเบตเบกเบชเปเบฒเบฅเบฑเบ Excel</h2>
            <p class="mt-2 text-gray-600 dark:text-gray-400">เบเบฑเบเบเบธเบเบเบฐเบเบงเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบ Excel เบเบญเบเบเปเบฒเบเปเบเบทเปเบญเปเบฎเบฑเบเปเบซเปเบกเบฑเบเบเปเบฒเบเบเบถเปเบ เปเบฅเบฐเปเบงเบเบถเปเบ.</p>
        </div>
        
        <div class="bg-white dark:bg-gray-800/50 p-6 md:p-8 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 space-y-6">
		






<details class="group border-b border-gray-200 dark:border-gray-700 pb-4">
  <summary class="text-lg md:text-xl lg:text-2xl font-bold text-emerald-600 dark:text-emerald-400 cursor-pointer py-2 hover:underline">
    ๐ Add-in: เปเบเบทเบญเบเบเบณเบเบงเบเปเบเบตเบเบญเบธเบเปเบธเบ :
  </summary>

  <div class="accordion-content mt-4 space-y-3 text-gray-700 dark:text-gray-300 leading-relaxed">
    <hr class="border-t-2 border-emerald-500 my-4">

    <p class="text-sm md:text-base lg:text-lg font-medium">
      ๐ <span class="font-bold text-emerald-600">Add-in: Calculation :เบฅเบงเบกเบเบธเบเบเบฑเบเบเบฑเบเปเบเบเบฒเบเบเบณเบเบงเบ:</span> เบฅเบฐเบเบปเบเบเบตเปเบเปเบงเบเปเบซเปเบเบฒเบเบเบณเบเบงเบเบชเบดเบเบเบดเบเบฐเปเบซเบเบ เปเบฅเบฐ เบเบฒเบเบฎเบฑเบเบญเบธเบเปเบธเบเบเบฒเบเบเบฒเบเปเบเบดเบ เบเบญเบเบเบฒเบเบฅเบฑเบ เปเบฅเบฐ เบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ เบกเบตเบเบงเบฒเบกเบเบทเบเบเปเบญเบ เบงเปเบญเบเปเบง เปเบฅเบฐ เปเบเปเบเบญเบ.
    </p>

    <p class="text-base font-semibold text-emerald-500">โ เบเบฑเบเบเบฑเปเบเบเบณเบเบงเบเบญเบธเบเปเบธเบ (เบเบฒเบเบฅเบฑเบ):</p>
    <ul class="list-disc list-inside space-y-1 text-sm md:text-base pl-5">
      <li><strong>Ph_Akon()</strong>: เบเบดเบเปเบฅเปเบญเบฒเบเบญเบเปเบเบตเบเปเบเบทเบญเบ</li>
      <li><strong>Ph_Datsani_kaj()</strong>: เบเบญเบเบซเบฒเบเบฑเบเบชเบฐเบเบตเบเบฒเบกเบเบฑเปเบเบเบฑเปเบเบเบนเบญเบฒเบเบฒเบ</li>
      <li><strong>Ph_Datsani_pk()</strong>: เบเบญเบเบซเบฒเบเบฑเบเบชเบฐเบเบตเบเบฒเบกเบเบฑเปเบเบเบฑเปเบเบเบปเบเบเบญเบ</li>
      <li><strong>Ph_Pikan()</strong>: เบเบญเบเบซเบฒเปเบเบตเบเบเบตเบเบฒเบเบเบญเบเบเบฐเบเบฑเบเบเบฒเบเบฅเบฑเบ</li>
      <li><strong>Ph_Ngoenduean_lk()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเปเบเบทเบญเบเบฅเบฑเบเบเบฐเบเบญเบ</li>
      <li><strong>Ph_Ngoenduean_bm()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบเบเบณเบเบฒเบ</li>
      <li><strong>Ph_bumnet()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ</li>
      <li><strong>Ph_SiaChiwit_Lk()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเปเบชเบเบเบตเบงเบดเบเบฅเบฑเบเบเบฐเบเบญเบ</li>
      <li><strong>Ph_SiaChiwit_bn()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเปเบชเบเบเบตเบงเบดเบเบเบฐเบเบฑเบเบเบฒเบเบเบณเบเบฒเบ</li>
    </ul>

    <p class="text-base font-semibold text-emerald-500 pt-2">โ เบเบฑเบเบเบฑเปเบเบเบณเบเบงเบเบญเบธเบเปเบธเบ (เบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ):</p>
    <ul class="list-disc list-inside space-y-1 text-sm md:text-base pl-5">
      <li><strong>bp_UtNunkoedluk()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเปเบเบตเบเบฅเบนเบเบชเบณเบฅเบฑเบเบเบนเปเบเบฐเบเบฑเบเบเบปเบ</li>
      <li><strong>Bp_bamnedkoedluk()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ</li>
      <li><strong>Bp_bumnat()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเบเบณเปเบเบฑเบเบญเบญเบเบงเบฝเบ</li>
      <li><strong>Bp_SiaChiwit()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเปเบชเบเบเบตเบงเบดเบ</li>
      <li><strong>Bp_SiaChiwit_lm()</strong>: เบเบดเบเปเบฅเปเปเบเบตเบเปเบชเบเบเบตเบงเบดเบเบฅเบนเบเปเบกเบ</li>
      <li><strong>IT_Laotext()</strong>: เบเปเบฝเบเบเบปเบงเปเบฅเบเปเบเบฑเบเบเบปเบงเปเบฑเบเบชเบท 5 เบเบฒเบชเบฒ</li>
    </ul>

    <p class="text-base font-semibold text-emerald-500 pt-2">๐ฏ เบเปเปเบเบต:</p>
    <ul class="list-disc list-inside space-y-1 text-sm md:text-base pl-5">
      <li>โฑ๏ธ เบเปเบงเบเบเบฐเบซเบเบฑเบเปเบงเบฅเบฒเปเบเบเบฒเบเบเบณเบเบงเบ</li>
      <li>๐ก๏ธ เบเปเบญเบเบเบฑเบเบเบงเบฒเบกเบเบดเบเบเบฒเบเบเบฒเบเบเบฒเบเบเบดเบเปเบฅเปเบเปเบงเบเบกเบท</li>
      <li>๐ เบชเปเบฒเบเบเบงเบฒเบกเบเบทเบเบเปเบญเบ เปเบฅเบฐ เบเปเบฒเปเบเบทเปเบญเบเบทเปเบเปเบญเบเบฐเบชเบฒเบ</li>
      <li>๐ เบฎเบญเบเบฎเบฑเบเบเบฑเบเปเบเบเบฐเปเบเบ เปเบฅเบฐ เบชเบฒเบเบปเบ</li>
    </ul>
  </div>
</details>

<details class="group mt-6">
  <summary class="text-lg md:text-xl lg:text-2xl font-bold text-emerald-600 dark:text-emerald-400 cursor-pointer py-2 hover:underline">
    ๐ Add-in: เปเบเบเบเบปเบงเปเบฅเบเปเบเบฑเบเบเบปเบงเปเบฑเบเบชเบท :
  </summary>

  <div class="accordion-content mt-4 space-y-4 text-gray-700 dark:text-gray-300 leading-relaxed">
    <p class="text-sm md:text-base lg:text-lg">๐Add-in: it_SpellNumber: เปเบเบเบเบปเบงเปเบฅเบเปเบเบฑเบเบเบปเบงเบญเบฑเบเบชเบญเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบเปเบ Excel, เบฎเบญเบเบฎเบฑเบเบซเบผเบฒเบเบเบฒเบชเบฒ เปเบฅเบฐ เบชเบฐเบเบธเบเปเบเบดเบ.</p>

    <div>
      <h3 class="text-base md:text-lg font-semibold text-emerald-500 mb-2">๐ เปเบเบตเบเบเปเป?... </h3>
      <ul class="list-disc list-inside space-y-2 text-sm md:text-base pl-5">
        <li>โจ๏ธ เบเปเบญเบเบเบฑเปเบเบเบดเบกเบเบปเบงเปเบฅเบเปเบเบฑเบเบเบปเบงเบญเบฑเบเบชเบญเบเบเปเบงเบเบกเบท.</li>
        <li>โฑ๏ธ เปเบชเบเปเบงเบฅเบฒ เปเบฅเบฐ เบเบดเบเบเบฒเบเบเปเบฒเบ.</li>
        <li>โ๏ธ เบเปเบฒเปเบเบฑเบเปเบญเบเบฐเบชเบฒเบเบเบฒเบเปเบเบดเบ เบเบดเบเบเบฒเบเบเปเบญเบเปเบญเบฒเบเปเบชเบเบซเบฒเบเปเบซเบเป.</li>
      </ul>
    </div>

    <div>
      <h3 class="text-base md:text-lg font-semibold text-emerald-500 mb-2">๐ เบเบณเบเบญเบเบเบตเปเบเบฑเบเบชเบฐเปเป</h3>
      <ul class="list-disc list-inside space-y-2 text-sm md:text-base pl-5">
        <li>๐ เปเบเบเบเบปเบงเปเบฅเบเปเบเบฑเบเบเบปเบงเบญเบฑเบเบชเบญเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบ</li>
        <li>๐ เบฎเบญเบเบฎเบฑเบเบซเบผเบฒเบเบเบฒเบชเบฒ (เบฅเบฒเบง, เปเบ, เบญเบฑเบเบเบดเบ, เบงเบฝเบเบเบฒเบก, เบเบตเบ)</li>
        <li>๐ฐ เบฎเบญเบเบฎเบฑเบเบซเบผเบฒเบเบชเบฐเบเบธเบเปเบเบดเบ: เบเบตเบ, เบเบฒเบ, เปเบเบฅเบฒ, เบเบปเบ, เบขเบงเบ</li>
      </ul>
    </div>

    <div>
      <h3 class="text-base md:text-lg font-semibold text-emerald-500 mb-2">๐ฏ เบงเบดเบเบตเปเบเปเบเบฒเบ</h3>
      <p class="mb-2 text-sm md:text-base">เบเบฝเบเปเบเปเบเบดเบกเบชเบนเบเปเบ Excel:</p>
      <div class="bg-gray-100 dark:bg-gray-900 p-3 rounded-lg font-mono text-sm space-y-1">
        <p><code class="text-emerald-500">=it_SpellNumber(</code><span class="text-blue-500">เบเบปเบงเปเบฅเบ</span><code class="text-emerald-500">,"la")</code> โ เบเบฒเบชเบฒเบฅเบฒเบง</p>
        <p><code class="text-emerald-500">=it_SpellNumber(</code><span class="text-blue-500">เบเบปเบงเปเบฅเบ</span><code class="text-emerald-500">,"th")</code> โ เบเบฒเบชเบฒเปเบ</p>
        <p><code class="text-emerald-500">=it_SpellNumber(</code><span class="text-blue-500">เบเบปเบงเปเบฅเบ</span><code class="text-emerald-500">,"us")</code> โ เบเบฒเบชเบฒเบญเบฑเบเบเบดเบ</p>
        <p><code class="text-emerald-500">=it_SpellNumber(</code><span class="text-blue-500">เบเบปเบงเปเบฅเบ</span><code class="text-emerald-500">,"vn")</code> โ เบเบฒเบชเบฒเบงเบฝเบเบเบฒเบก</p>
        <p><code class="text-emerald-500">=it_SpellNumber(</code><span class="text-blue-500">เบเบปเบงเปเบฅเบ</span><code class="text-emerald-500">,"cn")</code> โ เบเบฒเบชเบฒเบเบตเบ</p>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <h3 class="text-base md:text-lg font-semibold text-emerald-500 mb-2">๐ เปเบซเบเบเบปเบเบเบตเปเบเบงเบเปเบฅเบทเบญเบ</h3>
        <ul class="list-disc list-inside space-y-2 text-sm md:text-base pl-5">
          <li>โณ <strong>เบเบฐเบซเบเบฑเบเปเบงเบฅเบฒ:</strong> เบเปเปเบเปเบญเบเบเบฑเปเบเบเบฝเบเปเบญเบ</li>
          <li>๐ก๏ธ <strong>เบซเบผเบธเบเบเบดเบเบเบฒเบ:</strong> เบเปเบญเบเบเบฑเบเบเบงเบฒเบกเบเบดเบเบเบตเปเบชเบปเปเบเบเบปเบเปเบซเปเปเบชเบเบซเบฒเบ</li>
          <li>๐ <strong>เบชเบฒเบเบปเบ:</strong> เบฎเบญเบเบฎเบฑเบเบซเบผเบฒเบเบเบฒเบชเบฒ เปเบฅเบฐ เบชเบฐเบเบธเบเปเบเบดเบ</li>
        </ul>
      </div>
      <div>
        <h3 class="text-base md:text-lg font-semibold text-emerald-500 mb-2">๐ เบเบปเบเบเบตเบเปเปเบเบธเบฅเบฐเบเบดเบ</h3>
        <ul class="list-disc list-inside space-y-2 text-sm md:text-base pl-5">
       

                                <li>๐ เปเบเบเบดเบ เปเบฅเบฐ เบชเบฑเบเบเบฒเบเบตเปเปเปเบฒเปเบเบทเปเบญเบเบท.</li>
                                <li>๐ค เบชเปเบฒเบเบเบงเบฒเบก<strong>เปเบฑเปเบเปเบ</strong>เปเบเบเบฒเบเบฎเปเบงเบกเบเบฒเบ.</li>
                                <li>๐ เปเบเบตเปเบกเบเบงเบฒเบกเปเบเบฑเบ<strong>เบกเบทเบญเบฒเบเบตเบ</strong>.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </details>
            
<div class="pt-6 text-center border-t-2 border-emerald-400 dark:border-emerald-600 mt-8">
  <p class="font-bold text-lg text-gray-800 dark:text-gray-200 mb-3">
    ๐ เบชเบปเบเปเบ Add-in เบชเบฒเบกเบฒเบเบชเบญเบเบเบฒเบกเปเบเปเบเบตเป:
  </p>
  
  <a href="https://wa.me/8562091270509" target="_blank"
     class="inline-flex items-center gap-2 px-5 py-2.5 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold rounded-full shadow-lg transition duration-300 transform hover:scale-105">
    <i class="fab fa-whatsapp text-xl"></i>
    <span>Whatsapp: 020 9127 0509</span>
  </a>
</div>

        </div>
      </section>

      <section class="max-w-4xl mx-auto">
        <div class="text-center mb-8">
            <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white">เบงเบดเบเบตเปเบญเปเบเบฐเบเบณเบเบฒเบเปเบเปเบเบฒเบ</h2>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="aspect-video rounded-2xl overflow-hidden shadow-lg border border-gray-200 dark:border-gray-700 bg-black">
                <iframe class="w-full h-full" src="https://www.youtube.com/embed/7Iu8eKjmBJg" title="YouTube video 1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            </div>
            <div class="aspect-video rounded-2xl overflow-hidden shadow-lg border border-gray-200 dark:border-gray-700 bg-black">
                <iframe class="w-full h-full" src="https://www.youtube.com/embed/ZVvSVKXQrTk" title="YouTube video 2" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            </div>
            <div class="aspect-video rounded-2xl overflow-hidden shadow-lg border border-gray-200 dark:border-gray-700 bg-black">
                <iframe class="w-full h-full" src="https://www.youtube.com/embed/NHT8SRcj09g" title="YouTube video 3" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            </div>
        </div>
      </section>
        
    </div>
    <div id="gov-guide-page" class="page">
        <section class="max-w-4xl mx-auto">
            <div class="text-center mb-10">
                         
            


 </div>
            
            <div class="bg-white dark:bg-gray-800/50 p-6 md:p-8 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 space-y-8">
			 <div>
                  
  <h2 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white mb-3">๐เปเบเบตเบเบเบณเปเปเปเบเบเบฐเบเบณเบเบต2025 เปเบฅเบฐ เบเปเบฒเบเบฑเบเบชเบฐเบเบต 7,350 เบเบตเบ/1เบเบฑเบเบชเบฐเบเบต</h2>
   
                 <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เบญเบดเบเบเบฒเบกเบเบฒเบเบเบณเบเบปเบเบฅเบฐเบเบฝเบเปเบเบตเบเบเบณเปเปเบเปเบซเบกเปเบเบฐเบกเบตเบเบฐเปเบเบเบเบฑเปเบเบฅเบนเปเบกเบเบตเป:</p>
<div class="bg-gray-100 dark:bg-gray-900 p-4 rounded- font-sans text-sm md:text-sm mb-4 break-words">
 

   เบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบเบเบฐเปเบเบ 1 = 1.200.000 เบเบตเบ<br>
    เบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบเบเบฐเปเบเบ 2 = 1.000.000 เบเบตเบ<br>
    เบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบเบเบฐเปเบเบ 3 = 850.000 เบเบตเบ<br>
    เบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบเบเบฐเปเบเบ 4 = 550.000 เบเบตเบ<br>
    เบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบเบเบฐเปเบเบ 5 = 450.000 เบเบตเบ<br>
    เบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบเบเบฐเปเบเบ 6 = 400.000 เบเบตเบ<br>
    เบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบเบเบฐเปเบเบ 7 = 350.000 เบเบตเบ<br>
    เบเบณเปเปเปเบเบเปเบฅเบดเบซเบฒเบเบเบฐเปเบเบ 8 = 300.000 เบเบตเบ<br>
    เบงเบดเบเบฒเบเบฒเบ = 200.000 เบเบตเบ
</div>
			
			
  <div>
                  
  <h2 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white mb-3">1. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเปเบเบทเบญเบเบฅเบฑเบเบเบฐเบเบญเบ</h2>
   
   <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เปเบเบดเบเปเบเบทเบญเบเบฅเบฑเบเบเบฐเบเบญเบเบเบฐเบเบญเบเบเปเบงเบเบซเบผเบฒเบเบเบฒเบเบชเปเบงเบเบฅเบงเบกเบเบฑเบ. เบชเบนเบเบเบดเบเปเบฅเปเบงเบดเบเบตเบเบฒเบเบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบเบกเบตเบเบปเบงเบขเปเบฒเบเบเบฑเปเบเบเบตเป:</p>
 <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เบโโ.เบชเบปเบกโเบเบต เปเบเบฑเบ เบ/เบ เบชเบฒเบเบเบปเบเบเบญเบ เปเบกเบทเบญเบเบชเบฒเบกเบฑเบเบเบต  เบกเบตโเปเบเบดเบเบเบฒโเบกเบเบฑเปเบโเบเบฑเบ 4/4 เบเบฑเบโเบชเบฐโเบเบต 240 โเบเบตโเบเบฒเบ 09 เบเบต โเปเบเบตโเบเบญเบฒเบเบตเบเบซเบผเบทโเปเบเบตโเบเบเบณโเปเปเบ 200,000  เบฅเบนเบ 1 เบเบปเบ เปเบกเบ 1 เบเบปเบ  เปเบเบตโเบเปเบเบทเบญเบเบเบตเปเบเบฐโเบเบตเปโเบเบฐเปเบเปโเบฎเบฑเบเปเบกเปเบ ?..</p>
<div class="bg-gray-100 dark:bg-gray-900 p-4 rounded- font-sans text-sm md:text-sm mb-4 break-words">
	1 เปเบเบตเบเบเบฒเบกเบเบฑเปเบเบเบฑเบ 4/4 : เบเบฑเบเบชเบฐเบเบต: 240 x 7,350 เบเบตเบ :เปเบเบตเบเบเบทเปเบเบเบฒเบ : 1,764,000 เบเบตเบ  <br>
    2 เบเบตเบเบฒเบ 9 เบเบต : เปเบเบตเบเบเบตเบเบฒเบ : 65,000 เบเบตเบ<br>
    3 เปเบเบตเบเบเบณเปเปเปเบเบงเบดเบเบฒเบเบฒเบ = 200.000 เบเบตเบ<br>
    4 เบฅเบนเบ 1เบเบปเบ : 100.000 เบเบตเบ<br>
    5 เปเบกเบ 1 เบเบปเบ :100.000 เบเบตเบ<br>
    6 เบเปเบฒเบเบญเบเบเบตเบเบเบต2025 = 450.000 เบเบตเบ<br>
  
 
 <hr class="border-t-2 border-emerald-500 my-4">
   <p><strong> โ เปเบเบดเบเปเบเบทเบญเบเบฅเบงเบก </strong> = (เบเบทเปเบเบเบฒเบ + เบเบณเปเปเปเบ + เบเบตเบเบฒเบ) - เบซเบฑเบ 8% - เบญเบฒเบเบญเบ + เบญเบธเบเปเบนเบเบฅเบนเบ/เปเบกเบ + เบเปเบฒเบเบญเบเบเบตเบ <br>
   <p><strong> โ 2,488,346 </strong> = (1,764,000 + 200,000 + 65,000) - 162,320 - 28,334 + 200,000 + 450,000 <br>
 
 </div>
          
          <img src="https://i.ibb.co/VW4s2Tg8/image.jpg" alt="Salary Calculation" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
                </div>
     
           
                <div>
           
         <h2 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white mb-3">2. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบเบณเบเบฒเบ</h2>
   <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เปเบเบดเบเปเบเบทเบญเบเบเบณเบเบฒเบเบเบฐเบเบญเบเบเปเบงเบเบซเบผเบฒเบเบเบฒเบเบชเปเบงเบเบฅเบงเบกเบเบฑเบ.
เบชเบนเบเบเบดเบเปเบฅเปเบงเบดเบเบตเบเบฒเบเบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบเบกเบตเบเบปเบงเบขเปเบฒเบเบเบฑเปเบเบเบตเป:</p>
 <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เบโโ.เบชเบปเบกโเบเบต เปเบเบฑเบ เบ/เบ เบชเบฒเบเบเบปเบเบเบญเบ เปเบกเบทเบญเบเบชเบฒเบกเบฑเบเบเบต เบกเบตเบเปเบเบปเบเบฅเบปเบเปเบซเบฑเบเบเบตเปเบเบปเปเบฒเบฎเบฑเบเบเบณเบเบฒเบ เบกเบตโเปเบเบดเบเบเบฒโเบกเบเบฑเปเบโเบเบฑเบ 4/15 เบเบฑเบโเบชเบฐโเบเบต 333 โเบเบตโเบเบฒเบ 25 เบเบต
 โเปเบเบตโเบเบญเบฒเบเบตเบเบซเบผเบทโเปเบเบตโเบเบเบณโเปเปเบ 300,000  เบฅเบนเบ 1 เบเบปเบ เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ 85%  เปเบเบตโเบเปเบเบทเบญเบเบเบณเบเบฒเบเบเบตเปโเบเบฐเปเบเปโเบฎเบฑเบเปเบกเปเบ ?..</p>
    <div class="bg-gray-100 dark:bg-gray-900 p-4 rounded- font-sans text-sm md:text-sm mb-4 break-words">
	1 เปเบเบตเบเบเบฒเบกเบเบฑเปเบเบเบฑเบ 4/15 : เบเบฑเบเบชเบฐเบเบต: 333 x 7,350 เบเบตเบ :เปเบเบตเบเบเบทเปเบเบเบฒเบ : 2,447,550 เบเบตเบ  <br>
    2 เบเบตเบเบฒเบ 25 เบเบต : เปเบเบตเบเบเบตเบเบฒเบ : 275,000 เบเบตเบ<br>
    3 เปเบเบตเบเบเบณเปเปเปเบเบงเบดเบเบฒเบเบฒเบ = 300.000 เบเบตเบ<br>
    4 เบฅเบนเบ 1เบเบปเบ : 100.000 เบเบตเบ<br>
    5 เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ 85% <br>
 
   6 เบเปเบฒเบเบญเบเบเบตเบเบเบต2025 = 450.000 เบเบตเบ<br>
   <hr class="border-t-2 border-emerald-500 my-4">
 
    <p><strong> โ เปเบเบดเบเปเบเบทเบญเบเบเบณเบเบฒเบเบฅเบงเบก </strong> = (เบเบทเปเบเบเบฒเบ + เบเบณเปเปเปเบ + เบเบตเบเบฒเบ)* เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ - เบซเบฑเบเบเบฐเบเบฑเบเบชเบธเบเบเบฐเบเบฒเบ  + เบญเบธเบเปเบนเบเบฅเบนเบ + เบเปเบฒเบเบญเบเบเบตเบ <br>
   <p><strong> โ 3,103,110 </strong> = (2,447,550 + 300,000 + 275,000) *85% - 16,057 + 100,000 + 450,000 <br>
 </div>
          
          	   
     
          </div>
     
      <img src="https://i.ibb.co/fVrXqrhw/image.jpg" alt="Pension Calculation" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
          </div>

                <div>
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white mb-3">3.เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ</h2>
					
   <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เปเบเบดเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบเบเบฐเบเบญเบเบเปเบงเบเบซเบผเบฒเบเบเบฒเบเบชเปเบงเบเบฅเบงเบกเบเบฑเบ. เบชเบนเบเบเบดเบเปเบฅเปเบงเบดเบเบตเบเบฒเบเบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบเบกเบตเบเบปเบงเบขเปเบฒเบเบเบฑเปเบเบเบตเป:</p>
 <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เบโโ.เบชเบปเบกโเบเบต เปเบเบฑเบ เบ/เบ เบชเบฒเบเบเบปเบเบเบญเบ เปเบกเบทเบญเบเบชเบฒเบกเบฑเบเบเบต เบกเบตเบเปเบเบปเบเบฅเบปเบเปเบซเบฑเบเบเบตเปเบเบปเปเบฒเบฎเบฑเบเปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ เบกเบตโเปเบเบดเบเบเบฒโเบกเบเบฑเปเบโเบเบฑเบ 4/15 เบเบฑเบโเบชเบฐโเบเบต 333 โเบเบตโเบเบฒเบ 15 เบเบต
 โเปเบเบตโเบเบญเบฒเบเบตเบเบซเบผเบทโเปเบเบตโเบเบเบณโเปเปเบ 300,000  เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบเบเบตเปเบเบฐเปเบเปโเบฎเบฑเบเปเบกเปเบ ?..</p>
    <div class="bg-gray-100 dark:bg-gray-900 p-4 rounded- font-sans text-sm md:text-sm mb-4 break-words">
	1 เปเบเบตเบเบเบฒเบกเบเบฑเปเบเบเบฑเบ 4/15 : เบเบฑเบเบชเบฐเบเบต: 333 x 7,350 เบเบตเบ :เปเบเบตเบเบเบทเปเบเบเบฒเบ : 2,447,550 เบเบตเบ  <br>
    2 เบเบตเบเบฒเบ 15 เบเบต : เปเบเบตเบเบเบตเบเบฒเบ : 275,000 เบเบตเบ<br>
    3 เปเบเบตเบเบเบณเปเปเปเบเบงเบดเบเบฒเบเบฒเบ = 300.000 เบเบตเบ<br>
    4 เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ 85% <br>
<hr class="border-t-2 border-emerald-500 my-4">
  <p><strong> โ เปเบเบดเบเปเบเบทเบญเบเบเบณเบเบฑเบเบฅเบงเบก </strong> = (เบเบทเปเบเบเบฒเบ + เบเบณเปเปเปเบ + เบเบตเบเบฒเบ)* เปเบเบตเปเบเบฑเบเบเบณเปเบเบฑเบ*เปเบเบทเบญเบเปเบเบตเปเบ*เบเบตเบเบฒเบ <br>
   <p><strong> โ 54,937,508 </strong> = 

(2,447,550 + 300,000 + 155,000) *85% *1,5*15 <br>
 
 </div>
		
		
         </div>
                    <img src="https://i.ibb.co/twzt8WjW/image.jpg" alt="Severance Pay Calculation" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
                </div>
            </div>
        </section>

		
		
    </div>

    <div id="ent-guide-page" class="page">
     
   <section class="max-w-4xl mx-auto">
    

         <div class="text-center mb-10">
        
            </div>
            
            <div class="bg-white dark:bg-gray-800/50 p-6 md:p-8 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 space-y-8">
 

                <div>
         
           <h2 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white mb-3">1. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเปเบเบตเบเบฅเบนเบ</h2>
                    <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เบเบนเปเบเบฐเบเบฑเบเบเบปเบเบเบดเบเบเบตเปเปเบเบตเบเบฅเบนเบเบเบฐเปเบเปเบฎเบฑเบเปเบเบดเบเบญเบธเบเปเบนเบเบเปเบงเบเบเปเบฒเปเบเปเบเปเบฒเบ เปเบฅเบฐ เปเบเบดเบเบเบฑเบเบเบฒเบ.</p>
                    <ul class="list-disc list-inside space-y-2 mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">
                        <li><strong>เปเบเบดเบเบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ (เบเปเบฒเบเปเบเบทเปเบญเบเบฝเบง):</strong> เปเบเบดเบเปเบเบทเบญเบเบชเบฐเปเบฅเปเบ 6 เปเบเบทเบญเบ * 60%</li>
               
  


                   <li><strong>เปเบเบดเบเบญเบธเบเปเบนเบ (เปเบฅเบเบฐเบเบฑเบ):</strong> เบเบดเบเปเบฅเปเบเบฒเบกเบญเบฑเบเบเบฒเบชเปเบงเบเบเบญเบเปเบเบดเบเปเบเบทเบญเบเบชเบฐเปเบฅเปเบ 6 เปเบเบทเบญเบ.</li>

                    </ul>
                    <img src="https://i.ibb.co/rRDFqGgM/image.jpg" alt="Maternity Benefit" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
                </div>
           
      
      

            <div>
                    <h2 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white mb-3">2. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ (เบฎเบญเบ 60 เปเบเบทเบญเบ เบฅเบปเบเบกเบฒ)</h2>
                    <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เบเบนเปเบเบฐเบเบฑเบเบเบปเบเบเบตเปเบญเบญเบเบเบฒเบเบงเบฝเบ เปเบฅเบฐ เบกเบตเบเบฒเบเบชเบปเปเบเปเบเบดเบเบชเบปเบกเบเบปเบเปเบเป 1-60 เปเบเบทเบญเบ เบเบฐเปเบเปเบฎเบฑเบเปเบเบดเบเบเบณเปเบเบฑเบเปเบเบทเปเบญเบเบฝเบง.</p>
                    <div class="bg-gray-100 dark:bg-gray-900 p-4 rounded-lg text-center font-sans text-base md:text-lg mb-4 break-words">
                        เปเบเบดเบเบเบณเปเบเบฑเบ = (เปเบเบดเบเบชเบปเบกเบเบปเบเบชเบฐเปเบฅเปเบ) * 1,5 * เบเบณเบเบงเบเบเบต
       


 
             </div>
                     <img src="https://i.ibb.co/twzt8WjW/image.jpg" alt="Enterprise Severance Pay" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
                </div>

                <div>
                    <h2 class="text-xl 

sm:text-2xl font-bold text-gray-900 dark:text-white mb-3">3. เบเบฒเบเบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเปเบชเบเบเบตเบงเบดเบ</h2>
                    <p class="mb-4 text-gray-600 dark:text-gray-400 leading-relaxed">เบเปเบฅเบฐเบเบตเบเบนเปเบเบฐเบเบฑเบเบเบปเบเปเบชเบเบเบตเบงเบดเบ, เบเบญเบเบเบปเบงเบเบฐเปเบเปเบฎเบฑเบเปเบเบดเบเบญเบธเบเปเบนเบเปเบเบเบเบดเบเปเบฅเปเบเบฒเบกเบเบณเบเบงเบเบเบตเบเบตเปเบชเบปเปเบเปเบเบดเบเบชเบปเบกเบเบปเบ.</p>
					    <div class="bg-gray-100 dark:bg-gray-900 p-4 rounded-lg text-center font-sans text-base md:text-lg mb-4 break-words">
                        เปเบเบดเบเบญเบธเบเปเบธเบเปเบชเบเบเบตเบงเบดเบ = (เปเบเบดเบเบชเบปเบกเบเบปเบเบชเบฐเปเบฅเปเบ) * เบเบณเบเบงเบเบเบต
                       </div>
						
     
                <img src="https://i.ibb.co/sdmHtnwm/image.jpg" alt="Death Benefit" class="rounded-lg shadow-md mx-auto w-full max-w-lg object-cover mt-6">
                </div>
            </div>
        </section>

    </div>
    <div id="calculator-page" class="page">
        <div id="calculator-home" class="calc-section active bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6">
         
   <div class="text-center mb-6">
                <h1 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white">เบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ-เปเบเบตเบเบญเบธเบเปเบนเบเบเปเบฒเบเป (เบญเบเบ)</h1>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
           
      <button class="w-full text-left p-4 bg-gray-100 dark:bg-gray-700 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-all" onclick="showCalcSection('Salary')">
                  
   <i class="fas fa-money-bill-wave text-emerald-500 mr-3 w-6 text-center"></i> <span class="font-semibold text-gray-800 dark:text-gray-200">เบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ</span>
                </button>
                <button class="w-full text-left p-4 bg-gray-100 dark:bg-gray-700 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-all" onclick="showCalcSection('Government')">
           
        <i class="fas fa-landmark text-emerald-500 mr-3 w-6 text-center"></i> <span class="font-semibold text-gray-800 dark:text-gray-200">เบญเบธเบเปเบนเบเบเบฒเบเบฅเบฑเบ</span>
                
 </button>
                 <button class="w-full text-left p-4 bg-gray-100 dark:bg-gray-700 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-all" onclick="showCalcSection('Enterprise')">
                    <i class="fas fa-building text-emerald-500 mr-3 w-6 text-center"></i> <span class="font-semibold text-gray-800 dark:text-gray-200">เบญเบธเบเปเบนเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ</span>
        
         </button>
                 <button class="w-full text-left p-4 bg-gray-100 dark:bg-gray-700 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 

rounded-lg transition-all" onclick="showCalcSection('Search')">
                    <i class="fas fa-search text-emerald-500 mr-3 w-6 text-center"></i> <span class="font-semibold text-gray-800 dark:text-gray-200">เบเบปเปเบเบซเบฒเบเปเปเบกเบนเบ</span>
                </button>
         </div>
      

        <div class="mt-8 text-center bg-yellow-100 dark:bg-yellow-900/50 border-l-4 border-yellow-500 p-4 rounded-r-lg text-yellow-800 dark:text-yellow-200">
                  <i 

class="fas fa-exclamation-triangle mr-2"></i> 
                <strong>เบเบณเปเบเบทเบญเบ:</strong> เปเบญเบฑเบเบเบตเปเบชเปเบฒเบเบเบถเปเบเปเบเบทเปเบญเบเปเบงเบเบเบณเบเบงเบเปเบเปเบเบทเปเบญเบเบเบปเปเบเปเบเบปเปเบฒเบเบฑเปเบ, เบชเบญเบเบเบฒเบกเบเปเปเบกเบนเบเปเบเบตเปเบกเปเบเบตเบกเบเบตเป เบญเบเบ เปเบ: 1508.
            </div>
        </div>
        
        <div id="Salary" class="calc-section bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6 mt-6">
            <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ</h2>
           
 <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบฅเบฑเบเบเบฐเบเบญเบ (เบเบปเบเบเบญเบ-เบเบนเบญเบฒเบเบฒเบ)</p>
            <form id="salaryForm" class="space-y-4 max-w-lg mx-auto">
                <div>
                     <label for="category" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบทเปเบญเปเบเบฅเบฒเบเบฅเบฐเบญเบฝเบ:</label>
                    <select id="category" onchange="toggleFields()" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block 

w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                        <option value="">-- เปเบฅเบทเบญเบเบเบฐเปเบเบ --</option>
						<option value="civil">เปเบเบดเบเปเบเบทเบญเบเบเบฐเบเบฑเบเบเบฒเบเบฅเบฑเบเบเบฐเบเบญเบ</option>
						<option value="pension">เปเบเบตเบเบเบณเบเบฒเบ</option>
					</select>
                </div>
               
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                     <div>
        
                <label for="index" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบฑเบเบชเบฐเบเบต:</label>
                        <input type="number" id="index" min="0" placeholder="เบเบปเบงเบขเปเบฒเบ: 226" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                      </div>
           
          <div>
                        <label for="year" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบตเบเบฒเบ:</label>
                         
<input type="number" id="year" min="0" placeholder="เบเบปเบงเบขเปเบฒเบ: 10" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
              
       </div>
                </div>
                 <div>
                     <label for="position" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบดเบเบเบณเปเปเปเบ:</label>
                     <input type="text" inputmode="numeric" id="position" oninput="formatAndRestrictNumber(this)" placeholder="เบเบปเบงเบขเปเบฒเบ: 200,000" class="bg-gray-50 border border-gray-300 text-gray-900 

text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                 </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                     
<div>
                         <label for="children" class="block mb-2 text-sm font-medium text-gray-900 

dark:text-white">เบเบณเบเบงเบเบฅเบนเบ:</label>
                        <input type="number" id="children" min="0" placeholder="เบเบปเบงเบขเปเบฒเบ: 2" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                     </div>
    
                 <div id="wifeGroup">
             
            <label for="wife" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบณเบเบงเบเปเบกเบ:</label>
                        <input type="number" id="wife" min="0" placeholder="เบเบปเบงเบขเปเบฒเบ: 1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
      
               </div>
                

 </div>
                 <div class="hidden" id="pensionGroup">
                     <label for="pensionPercent" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ (%):</label>
                     
 <input type="number" id="pensionPercent" min="0" max="100" placeholder="เบเบปเบงเบขเปเบฒเบ: 80" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
        
         </div>

                <div class="flex flex-wrap justify-center gap-3 pt-4">
                     <button type="button" class="text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="calculateSalary()"><i class="fas fa-calculator mr-2"></i>เบเบณเบเบงเบ</button>
      
                <button type="button" class="text-white bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="resetSalaryForm()"><i class="fas fa-trash mr-2"></i>เบฅเปเบฒเบเบเปเปเบกเบนเบ</button>
 
                     <button type="button" class="text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="goCalcHome()"><i class="fas fa-arrow-left mr-2"></i>เบเบฑเบเบเบทเบ</button>
                </div>
             </form>
     
       <div id="salaryResult" class="hidden mt-6 p-5 max-w-lg mx-auto bg-gray-50 dark:bg-gray-900/70 rounded-lg border-l-4 border-emerald-500">
           
     <h3 class="text-lg font-bold text-emerald-500 mb-4">เบเบปเบเบเบฒเบเบเบณเบเบงเบ</h3>
                <div class="space-y-2 text-sm">
                    <p class="flex justify-between"><strong>เบฅเบงเบกเปเบเบดเบเบเปเบญเบเบซเบฑเบ:</strong> <span id="totalBeforeDeduction">0</span> เบเบตเบ</p>
         
 <p class="flex justify-between"><strong>เปเบเบดเบเบเบตเบเบฒเบ:</strong> <span id="yearAllowance">0</span> เบเบตเบ</p>
                     <p class="flex justify-between"><strong>เปเบเบดเบเบฅเบนเบ:</strong> <span id="childAllowance">0</span> เบเบตเบ</p>
       
              <p id="wifeLabel" class="flex justify-between"><strong>เปเบเบดเบเปเบกเบ:</strong> <span id="wifeAllowance">0</span> เบเบตเบ</p>
                    <p id="deductionLabel" class="flex justify-between"><strong>เบซเบฑเบ 8%:</strong> <span id="deduction8">0</span> เบเบตเบ</p>
               
      <p id="taxLabel" class="flex justify-between"><strong>เบซเบฑเบเบญเบฒเบเบญเบ:</strong> <span id="tax">0</span> เบเบตเบ</p>
                    <p class="flex justify-between"><strong>เปเบเบดเบเบเปเบฒเบเบญเบเบเบตเบเปเบเบตเปเบก:</strong> <span id="livingAllowance">0</span> เบเบตเบ</p>
 
                   <p class="flex justify-between font-bold text-base bg-emerald-100 dark:bg-emerald-900/50 p-3 rounded-md mt-4"><strong>เบฅเบงเบกเปเบเบดเบเบเบฑเบเปเบปเบ:</strong> <span id="totalNet" class="text-emerald-500">0</span> เบเบตเบ</p>
                </div>
             </div>
  
      </div>

         <div id="Government" class="calc-section bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6 mt-6">
           
 <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเบณเบเบงเบเปเบเบดเบเบญเบธเบเปเบธเบเบเบฒเบเบฅเบฑเบ</h2>
            <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบเบญเบเบเบถเบเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบกเปเบซเปเบเบเบฒเบ (เบญเบเบ)</p>
            <form id="bonusForm" class="space-y-4 max-w-lg mx-auto">
                 <div>
     
                <label for="detail" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบทเปเบญเปเบเบฅเบฒเบเบฅเบฐเบญเบฝเบ:</label>
             
       <select id="detail" name="detail" onchange="updatePercentage()" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                        <option value="">-- เปเบฅเบทเบญเบเบเบฐเปเบเบ --</option>
						<option value="เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ">เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ</option>
						<option value="เปเบเบตเบเบญเบธเบเปเบธเบเปเบชเบเบเบตเบงเบดเบเบฅเบฑเบเบเบฐเบเบญเบ">เปเบเบดเบเบญเบธเบเปเบธเบเปเบชเบเบเบตเบงเบดเบเบฅเบฑเบเบเบฐเบเบญเบ</option>
          
              <option value="เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ">เปเบเบดเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ</option>
                     
  <option value="เปเบเบตเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ">เปเบเบดเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ</option>
                    </select>
                </div>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    
                 <div>
                  
       <label for="govIndex" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบฑเบเบชเบฐเบเบต:</label>
                        <input type="number" id="govIndex" name="index" placeholder="เบเบปเบงเบขเปเบฒเบ: 226" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
       
             </div>
                     <div>
 
                        <label for="serviceYears" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบตเบเบฒเบ:</label>
                       <input type="number" id="serviceYears" name="serviceYears" placeholder="เบเบปเบงเบขเปเบฒเบ: 10" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                     </div>
     
            </div>
                <div>
                    <label for="positionSalary" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบดเบเบเบณเปเปเปเบ:</label>
          
          <input type="text" inputmode="numeric" id="positionSalary" name="positionSalary" oninput="formatAndRestrictNumber(this)" placeholder="เบเบปเบงเบขเปเบฒเบ: 200,000" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
   
             </div>
                <div class="hidden" id="percentageGroup">
                    <label id="percentageLabel" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ (%):</label>
      
              <input type="number" id="percentage" name="percentage" step="0.01" placeholder="เบเบปเบงเบขเปเบฒเบ: 85" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 

dark:text-white">
                </div>

                <div class="flex flex-wrap justify-center gap-3 pt-4">
                      <button type="button" class="text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="validateAndCalculateGovernment()"><i class="fas fa-calculator mr-2"></i>เบเบณเบเบงเบ</button>
                      <button type="button" class="text-white bg-red-500 hover:bg-red-600 font-medium 

rounded-lg text-sm px-5 py-2.5" onclick="clearGovForm()"><i class="fas fa-trash mr-2"></i>เบฅเปเบฒเบเบเปเปเบกเบนเบ</button>
                      <button type="button" class="text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="goCalcHome()"><i class="fas fa-arrow-left mr-2"></i>เบเบฑเบเบเบทเบ</button>
                  </div>
    
         </form>
              <div id="govResult" class="hidden mt-6 p-5 max-w-lg mx-auto bg-gray-50 dark:bg-gray-900/70 rounded-lg 

border-l-4 border-emerald-500">
                <h3 class="text-lg font-bold text-emerald-500 mb-4">เบเบปเบเบเบฒเบเบเบณเบเบงเบ</h3>
                 <div class="space-y-2 text-sm">
                 
   <p class="flex justify-between"><strong>เปเบเบดเบเปเบเบทเบญเบเบเบทเปเบเบเบฒเบ:</strong> <span id="govBaseMonthlySalary">0</span> เบเบตเบ</p>
  
                  <p class="flex justify-between"><strong>เปเบเบดเบเบเบตเบเบฒเบ:</strong> <span id="govYearlyBonus">0</span> เบเบตเบ</p>
          
           <p class="flex justify-between"><strong>เบฅเบงเบกเปเบเบดเบเบเปเบญเบเบซเบฑเบ:</strong> <span id="govTotalDeduction">0</span> เบเบตเบ</p>
                    <p class="flex justify-between"><strong>เปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบ:</strong> <span id="govMonthsReceived">0</span> เปเบเบทเบญเบ</p>
                     <p class="flex justify-between font-bold text-base bg-emerald-100 dark:bg-emerald-900/50 p-3 rounded-md mt-4"><strong>เบฅเบงเบกเปเบเบดเบเบเบฑเบเปเบปเบเบเบตเปเปเบเปเบฎเบฑเบ:</strong> <span id="govTotalAmountReceived" class="text-emerald-500">0</span> เบเบตเบ</p>
                  </div>
       
     </div>
         </div>

         <div id="Enterprise" class="calc-section bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6 mt-6">
            <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเบณเบเบงเบเปเบเบดเบเบญเบธเบเปเบธเบเบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ</h2>
      
           <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบเบญเบเบเบถเบเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบกเปเบซเปเบเบเบฒเบ (เบญเบเบ)</p>
            <form id="supportForm" class="space-y-4 max-w-lg mx-auto">
        
         <div>
                      <label for="entCategory" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบทเปเบญเปเบเบฅเบฒเบเบฅเบฐเบญเบฝเบ:</label>
                     <select id="entCategory" name="category" onchange="handleEnterpriseCategoryChange()" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                       
  <option value="">-- เปเบฅเบทเบญเบเบเบฐเปเบเบ --</option>
                         <option value="เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ">เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ</option>
                         <option value="เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ">เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ</option>
						 <option value="เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ">เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ</option>
               
           <option value="เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ">เปเบเบดเบเปเบชเบเบเบตเบงเบดเบ</option>
              
       </select>
                 </div>
                 <div>
                     <label for="contribution" id="contributionLabel" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบณเบเบงเบเปเบเบตเบเบชเบปเบกเบเบปเบ 6 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ:</label>
  
                   <input type="text" inputmode="numeric" id="contribution" name="contribution" oninput="formatAndRestrictNumber(this)" placeholder="เบเบปเบงเบขเปเบฒเบ: 

27,000,000" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                 </div>
                <div>
                     <label for="months" id="monthsLabel" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบเบทเบญเบ:</label>
                     <input type="number" 

id="months" name="months" step="1" placeholder="เบเบปเบงเบขเปเบฒเบ: 12" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                 </div>
                 <div class="hidden" id="entChildrenField">
                     
 <label for="entChildren" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เบเบณเบเบงเบเบฅเบนเบ:</label>
                
     <input type="number" id="entChildren" name="children" step="1" placeholder="เบเบปเบงเบขเปเบฒเบ: 1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                 </div>
                <div class="flex flex-wrap justify-center gap-3 pt-4">
  
                     <button type="button" class="text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="calculateEnterprise()"><i class="fas fa-calculator 

mr-2"></i>เบเบณเบเบงเบ</button>
                      <button type="button" class="text-white bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="clearEntForm()"><i class="fas fa-trash mr-2"></i>เบฅเปเบฒเบเบเปเปเบกเบนเบ</button>
                      <button type="button" class="text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="goCalcHome()"><i class="fas fa-arrow-left mr-2"></i>เบเบฑเบเบเบทเบ</button>
     
            </div>
          
  </form>
             <div id="entResult" class="hidden mt-6 p-5 max-w-lg mx-auto bg-gray-50 dark:bg-gray-900/70 rounded-lg border-l-4 border-emerald-500">
                 <h3 class="text-lg font-bold text-emerald-500 mb-4">เบเบปเบเบเบฒเบเบเบณเบเบงเบ</h3>
                <p class="flex justify-between font-bold text-base bg-emerald-100 dark:bg-emerald-900/50 p-3 rounded-md mt-4"><strong>เบฅเบงเบกเปเบเบดเบเบเบฑเบเปเบปเบเบเบตเปเปเบเปเบฎเบฑเบ:</strong> <span id="entTotal" class="text-emerald-500">0</span> เบเบตเบ</p>
  
          </div>
        </div>

    
     <div id="Search" class="calc-section bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 p-6 mt-6">
             <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเบปเปเบเบซเบฒเบเปเปเบกเบนเบ</h2>
              <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบเบปเปเบเบซเบฒเบเบฒเบเบเบณเบเบงเบเบเบตเปเบเปเบฒเบเบกเบฒ เปเบฅเบฐ เบเบญเบเบซเบฒเบเบฑเบเบชเบฐเบเบต</p>
             <form id="searchForm" class="space-y-4 max-w-lg mx-auto">
     
           <div>
          
            <label for="combobox1" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบฅเบทเบญเบเบฅเบฒเบเบเบฒเบ:</label>
                     <select id="combobox1" name="combobox1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                       
  <option value="">-- เบเบฐเบฅเบธเบเบฒเปเบฅเบทเธญเธ --</option>
               
          <option value="salaryHistory">เบเบฐเบซเบงเบฑเบเบเบณเบเบงเบเปเบเบดเบเปเบเบทเบญเบ</option>
                         <option value="govSupportHistory">เบเบฐเบซเบงเบฑเบเบเบณเบเบงเบเบเบฒเบเบฅเบฑเบ</option>
                        <option value="entSupportHistory">เบเบฐเบซเบงเบฑเบเบเบณเบเบงเบเบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ</option>
                         
      <option value="indexData">เบเบปเปเบเบซเบฒเบเบฑเบเบชเบฐเบเบต</option>
      
               </select>
                </div>
                 <div>
                      <label for="textbox1" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">เปเบชเปเบเปเปเบกเบนเบเปเบเบทเปเบญเบเบปเปเบเบซเบฒ (เบเปเปเบเบฑเบเบเบฑเบ):</label>
         
            <input 

type="text" id="textbox1" name="textbox1" placeholder="เบเบปเบงเบขเปเบฒเบ: 4/2, เบเบนเบญเบฒเบเบฒเบ" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white">
                </div>
                 <div class="flex flex-wrap justify-center gap-3 pt-4">
                       <button type="button" id="searchButton" class="text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="searchData()"><i class="fas fa-search mr-2"></i>เบเบปเปเบเบซเบฒ</button>
     
                <button type="button" class="text-gray-900 dark:text-white bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 font-medium rounded-lg text-sm px-5 py-2.5" onclick="goCalcHome()"><i class="fas fa-arrow-left mr-2"></i>เบเบฑเบเบเบทเบ</button>
                 </div>
             </form>
            <div id="searchResult" class="hidden w-full mt-6">
 
                 <div class="table-container overflow-x-auto" id="table-container">
 
                    <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                         <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"><tr id="table-header"></tr></thead>
                          <tbody id="table-body" class="bg-white dark:bg-gray-800"></tbody>
      
        
      </table>
                 </div>
            </div>
        </div>
    </div>

     <div id="contact-page" class="page">
        <section>
           <h2 class="text-xl sm:text-2xl font-bold text-emerald-500 mb-2 text-center">เบเปเบฝเบงเบเบฑเบเบเบงเบเปเบฎเบปเบฒ</h2>
           <p class="text-base text-gray-500 dark:text-gray-400 mb-6 md:mb-10 text-center">เบชเบญเบเบเบฒเบกเบเปเปเบกเบนเบเปเบเบตเปเบกเปเบเบตเบก เปเบฅเบฐ เบเปเบเบณเปเบเบฐเบเบณ.</p>
  
        <div class="bg-white dark:bg-gray-800/50 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 max-w-2xl mx-auto p-8">
             <div class="space-y-4 text-center text-lg">
                <p><strong>เบชเบฒเบเบเปเบงเบ เบญเบเบ:</strong> <a href="tel:1508" class="text-emerald-500 hover:underline">1508</a></p>
                <p><strong>เปเบเบชเบเบธเบ:</strong> <a href="https://www.facebook.com/Phetsaiyaphoom" target="_blank" class="text-emerald-500 hover:underline">Bounpheng Phetsaiyaphoum</a></p>
                   
<p><strong>เบงเบฑเบญเบเปเบญเบฑเบ:</strong> <a href="https://api.whatsapp.com/send/?phone=8562091270509" target="_blank" 

class="text-emerald-500 hover:underline">020 9127 0509</a></p>
            </div>
          </div>
         </section>
    </div>
  </main>
  
  <a href="#" onclick="showPage('home')" id="fab-home-button" class="hidden fixed bottom-6 right-6 bg-emerald-500 hover:bg-emerald-600 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg z-40">
    <i class="fas fa-home text-xl"></i>
  </a>

  <footer class="bg-gray-200 dark:bg-gray-800 border-t border-gray-300 dark:border-gray-700 mt-auto">
    <div class="container mx-auto px-4 py-5 text-center text-gray-600 dark:text-gray-400 text-xs">
     
 <p>ยฉ <span id="year"></span> 

เบชเบฐเบซเบเบงเบเบฅเบดเบเบฐเบชเบดเบ. เบเบฑเบเบเบฐเบเบฒเปเบเบ เบ.เบเบธเบเปเบเบตเปเบ เปเบเบฑเบเปเบเบเบฐเบเบนเบก.</p>
      </div>
  </footer>

<div id="popup" class="prize-popup fixed top-1/2 left-1/2 w-[min(85vw,450px)] transform -translate-x-1/2 -translate-y-1/2 scale-50 bg-gray-900 rounded-2xl border-2 border-transparent shadow-2xl z-[1000] text-center text-white p-6 opacity-0 pointer-events-none transition-all duration-300">
  <button class="close-popup absolute top-2 right-2 bg-none border-none text-4xl text-white cursor-pointer opacity-70 hover:opacity-100 hover:rotate-90 transition-transform">&times;</button>
  <div class="icon text-6xl"></div>
  <div class="message text-2xl font-bold mt-4 mb-2"></div>
  <div class="sub-message text-base text-gray-400"></div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"; import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit, serverTimestamp, onSnapshot, doc, getDoc, updateDoc, arrayUnion, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"; const firebaseConfig = {
    apiKey: "AIzaSyD8fd_23dLQPbLqfqbakpJtlzjIOD_B-Jw",
    authDomain: "myapp-506ca.firebaseapp.com",
    projectId: "myapp-506ca",
    storageBucket: "myapp-506ca.appspot.com",
    messagingSenderId: "341275741284",
    appId: "1:341275741284:web:f955e6c5a273e4be616371"
  }; const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  
  window.db = db; window.firestoreFunctions = {
      collection, addDoc, getDocs, query, orderBy, limit, serverTimestamp,
      onSnapshot, doc, getDoc, updateDoc, arrayUnion, deleteDoc
  }; </script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('year').textContent = new Date().getFullYear();
    const closePopupBtn = document.querySelector('.close-popup');
    if (closePopupBtn) { closePopupBtn.addEventListener('click', hidePopup); }
    
    setupMobileMenu();
    setupThemeToggle(); 
    initializeSlider();
    
    showPage('home'); 
    loadAndInitializeApp(); 
    displayLaoDateForCalc();
    
}); function setupMobileMenu() {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu'); mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
    }); }

function setupThemeToggle() {
    const themeToggleBtn = document.getElementById('theme-toggle');
    const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
    const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon'); const updateIcons = () => {
        if (document.documentElement.classList.contains('dark')) {
            themeToggleDarkIcon.classList.add('hidden'); themeToggleLightIcon.classList.remove('hidden');
        } else {
            themeToggleDarkIcon.classList.remove('hidden');
            themeToggleLightIcon.classList.add('hidden'); }
    };

    updateIcons();

    themeToggleBtn.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        if (document.documentElement.classList.contains('dark')) {
            localStorage.setItem('theme', 'dark');
        } else {
            localStorage.setItem('theme', 'light');
        }
        updateIcons();
    }); }

function initializeSlider() {
    const sliderTrack = document.querySelector('#image-slider .slider-track');
    if (!sliderTrack) return;
    const slides = Array.from(sliderTrack.children); const nextButton = document.getElementById('slider-next');
    const prevButton = document.getElementById('slider-prev');
    const dotsNav = document.getElementById('slider-dots');

    let currentIndex = 0; const createDots = () => {
        dotsNav.innerHTML = ''; slides.forEach((_, index) => {
            const dot = document.createElement('button');
            // Class เบเปเบฒเบเปเบเบฐเบเบทเบเบเบณเบเบปเบเบเปเบฒเบ CSS block เบเปเบฒเบเปเบเบดเบ
            dot.addEventListener('click', () => {
                goToSlide(index);
                resetInterval();
            });
      
      dotsNav.appendChild(dot);
        });
    };
    createDots(); const dots = Array.from(dotsNav.children);
    
    const updateDots = () => {
        dots.forEach((dot, index) => {
            // เบเปเบฝเบเบกเบฒเปเบเปเบเบฒเบ toggle class 'active' เปเบเบ
            dot.classList.toggle('active', index === currentIndex);
        }); };

    const goToSlide = (index) => {
        const slideWidth = slides[0].getBoundingClientRect().width; if (slideWidth === 0) return;
        currentIndex = index;
        sliderTrack.style.transform = `translateX(-${slideWidth * currentIndex}px)`;
        updateDots();
    }; nextButton.addEventListener('click', () => {
        const nextIndex = (currentIndex + 1) % slides.length;
        goToSlide(nextIndex);
        resetInterval();
    }); prevButton.addEventListener('click', () => {
        const prevIndex = (currentIndex - 1 + slides.length) % slides.length;
        goToSlide(prevIndex);
        resetInterval();
    }); let autoSlideInterval = setInterval(() => {
        const nextIndex = (currentIndex + 1) % slides.length;
        goToSlide(nextIndex);
    }, 4000); const resetInterval = () => {
        clearInterval(autoSlideInterval); autoSlideInterval = setInterval(() => { 
            const nextIndex = (currentIndex + 1) % slides.length;
            goToSlide(nextIndex);
        }, 4000); };
    
    window.addEventListener('resize', () => goToSlide(currentIndex));
    
    goToSlide(0);
}

function showPage(pageId) {
  document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
const targetPage = document.getElementById(pageId + '-page'); const fabHomeButton = document.getElementById('fab-home-button');

  if(targetPage) {
      targetPage.classList.add('active'); }
  
  if (pageId === 'home') {
      fabHomeButton.classList.add('hidden'); } else {
      fabHomeButton.classList.remove('hidden');
  }
  
  document.querySelectorAll('.nav-link').forEach(link => {
    link.classList.remove('text-emerald-500', 'font-bold');
    if(link.getAttribute('data-page') === pageId) {
      link.classList.add('text-emerald-500', 'font-bold');
    }
  }); const mobileMenu = document.getElementById('mobile-menu');
  if (!mobileMenu.classList.contains('hidden')) {
    mobileMenu.classList.add('hidden');
  }

  window.scrollTo(0, 0); }

function showCalcSection(sectionId) {
    document.querySelectorAll('.calc-section').forEach(s => s.classList.remove('active'));
    document.getElementById(sectionId).classList.add('active');
}

function goCalcHome() {
    resetSalaryForm(); 
    clearGovForm();
    clearEntForm(); 
    document.getElementById('searchForm').reset(); const searchResult = document.getElementById('searchResult');
    if(searchResult) searchResult.classList.add('hidden');
    showCalcSection('calculator-home');
}

let APP_CONFIG = null;
let popupTimeout;
let IS_ADMIN = false; let ADMIN_EMAILS = [];

async function loadAndInitializeApp() {
    Swal.fire({ title: 'เบเบณเบฅเบฑเบเปเบซเบผเบเบเบฒเบเบเบฑเปเบเบเปเบฒ...', text: 'เบเบฐเบฅเบธเบเบฒเบฅเปเบเปเบฒ...', allowOutsideClick: false, didOpen: () => Swal.showLoading() }); try {
        if (!window.db) { throw new Error("Firestore is not initialized."); }
        const { doc, getDoc } = window.firestoreFunctions; const configRef = doc(window.db, "configuration", "appConfig");
        const docSnap = await getDoc(configRef); if (docSnap.exists()) {
            APP_CONFIG = docSnap.data(); if (APP_CONFIG.yearAllowanceTiers) { APP_CONFIG.yearAllowanceTiers.forEach(tier => { if (tier.maxYears === 'Infinity') { tier.maxYears = Infinity; } }); }
            if (APP_CONFIG.taxBrackets) { APP_CONFIG.taxBrackets.forEach(bracket => { if (bracket.max === 'Infinity') { bracket.max = Infinity; } }); }
            initializeForms();
            await loadAdminList();
            Swal.close(); } else { throw new Error("เบเปเปเบเบปเบเบเปเปเบกเบนเบเบเบฒเบเบเบฑเปเบเบเปเบฒเปเบ Firestore (configuration/appConfig)."); }
    } catch (error) {
        console.error("Error loading remote configuration: ", error); Swal.fire({ icon: 'error', title: 'เปเบเบตเบเบเปเปเบเบดเบเบเบฒเบ', text: `เบเปเปเบชเบฒเบกเบฒเบเปเบซเบผเบเบเปเปเบกเบนเบเบเบฒเบเบเบฑเปเบเบเปเบฒเบซเบผเบฑเบเบเบญเบเบฅเบฐเบเบปเบเปเบเป. เบเบฐเบฅเบธเบเบฒเบฅเบญเบเปเปเปเบญเบตเบเบเบฑเปเบ.`, allowOutsideClick: false, }); }
}

function showCustomPopup(type, message, subMessage = 'เบเบฐเบฅเบธเบเบฒเบเบงเบเบชเบญเบเบเปเปเบกเบนเบเบเบญเบเบเปเบฒเบเบเบทเบ') {
    const popup = document.getElementById('popup');
    const popupIcon = popup.querySelector('.icon'); const popupMessage = popup.querySelector('.message');
    const popupSubMessage = popup.querySelector('.sub-message');
    if (popupTimeout) clearTimeout(popupTimeout);
    let iconHtml = ''; switch (type) {
      case 'success': iconHtml = 'โ'; subMessage = subMessage === 'เบเบฐเบฅเบธเบเบฒเบเบงเบเบชเบญเบเบเปเปเบกเบนเบเบเบญเบเบเปเบฒเบเบเบทเบ' ? 'เบเปเปเบกเบนเบเบเบญเบเบเปเบฒเบเปเบเปเบเบทเบเบเบฐเบกเบงเบเบเบปเบเบชเบณเปเบฅเบฑเบ!' : subMessage; break;
      case 'warning': iconHtml = 'โ๏ธ'; break;
      case 'error': iconHtml = 'โ'; break;
      default: iconHtml = 'โน๏ธ'; }
    popupIcon.innerHTML = iconHtml;
    popupMessage.textContent = message;
    popupSubMessage.textContent = subMessage;
    popup.classList.add('active', 'scale-100', 'opacity-100');
    popup.classList.remove('scale-50', 'opacity-0'); popupTimeout = setTimeout(() => { hidePopup(); }, 5000);
}

function hidePopup() {
    const popup = document.getElementById('popup'); popup.classList.remove('active', 'scale-100', 'opacity-100');
    popup.classList.add('scale-50', 'opacity-0');
    if (popupTimeout) clearTimeout(popupTimeout);
}

async function saveDataToFirestore(collectionName, data) {
    if (!window.db) { console.error("Firestore is not initialized."); showCustomPopup('error', 'เบเบดเบเบเบฒเบ', 'เบเปเปเบชเบฒเบกเบฒเบเปเบเบทเปเบญเบกเบเปเปเบเบฒเบเบเปเปเบกเบนเบเปเบเป.'); return false; }
    try {
        const { collection, addDoc, serverTimestamp } = window.firestoreFunctions; const dataToSave = { ...data, savedAt: serverTimestamp() };
        await addDoc(collection(window.db, collectionName), dataToSave);
        return true; } catch (error) { console.error("Error writing document: ", error); showCustomPopup('error', 'เบเบดเบเบเบฒเบเปเบเบเบฒเบเบเบฑเบเบเบถเบ', `เปเบเบตเบเบเปเปเบเบดเบเบเบฒเบ: ${error.message}`); return false; }
}

async function getDataFromFirestore(collectionName) {
    if (!window.db) { console.error("Firestore is not initialized."); return []; }
    try {
        const { collection, getDocs, query, orderBy, limit } = window.firestoreFunctions; const q = query(collection(window.db, collectionName), orderBy("savedAt", "desc"), limit(50));
        const querySnapshot = await getDocs(q);
        const data = []; querySnapshot.forEach((doc) => {
            let docData = doc.data();
            if (docData.savedAt && docData.savedAt.toDate) { docData.savedAt = docData.savedAt.toDate(); }
            data.push({ id: doc.id, ...docData });
        }); return data;
    } catch (error) { console.error("Error getting documents: ", error); return []; }
}

function initializeForms() { 
    toggleFields(); 
    updatePercentage(); 
    handleEnterpriseCategoryChange();
}

function displayLaoDateForCalc() {
    const el = document.getElementById('date-lao-calc'); if(!el) return;
    const laoDays = ["เบงเบฑเบเบญเบฒเบเบดเบ", "เบงเบฑเบเบเบฑเบ", "เบงเบฑเบเบญเบฑเบเบเบฒเบ", "เบงเบฑเบเบเบธเบ", "เบงเบฑเบเบเบฐเบซเบฑเบ", "เบงเบฑเบเบชเบธเบ", "เบงเบฑเบเปเบชเบปเบฒ"]; const laoMonths = ["เบกเบฑเบเบเบญเบ", "เบเบธเบกเบเบฒ", "เบกเบตเบเบฒ", "เปเบกเบชเบฒ", "เบเบถเบเบชเบฐเบเบฒ", "เบกเบดเบเบธเบเบฒ", "เบเปเบฅเบฐเบเบปเบ", "เบชเบดเบเบซเบฒ", "เบเบฑเบเบเบฒ", "เบเบธเบฅเบฒ", "เบเบฐเบเบดเบ", "เบเบฑเบเบงเบฒ"];
    const now = new Date(); el.textContent = `${laoDays[now.getDay()]}, เบงเบฑเบเบเบต ${now.getDate()} เปเบเบทเบญเบ ${laoMonths[now.getMonth()]} เบเบต ${now.getFullYear()}`;
}

function formatAndRestrictNumber(input) { 
    let value = input.value.replace(/[^0-9]/g, ''); if (value) { input.value = parseInt(value, 10).toLocaleString('en-US'); } else { input.value = ''; } 
}

function toggleFields() {
    const category = document.getElementById('category').value;
    const pensionGroup = document.getElementById('pensionGroup');
    const wifeGroup = document.getElementById('wifeGroup'); const wifeLabel = document.getElementById('wifeLabel');
    const deductionLabel = document.getElementById('deductionLabel'); 
    const taxLabel = document.getElementById('taxLabel');
    const isPension = category === 'pension';
    pensionGroup.classList.toggle('hidden', !isPension); wifeGroup.classList.toggle('hidden', isPension);
    if(wifeLabel) wifeLabel.style.display = isPension ? 'none' : 'flex';
    if(taxLabel) taxLabel.style.display = isPension ? 'none' : 'flex'; if(deductionLabel) deductionLabel.innerHTML = `<strong>${isPension ? 'เบซเบฑเบเบเบฐเบเบฑเบเบชเบธเบเบฐเบเบฒเบ:' : 'เบซเบฑเบ 8%:'}</strong> <span id="deduction8">0</span> เบเบตเบ`; }

function updatePercentage() {
    const detail = document.getElementById('detail').value; 
    const group = document.getElementById('percentageGroup'); const show = detail === 'เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ' || detail === 'เปเบเบตเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ';
    group.classList.toggle('hidden', !show); }

function handleEnterpriseCategoryChange() {
    const category = document.getElementById('entCategory').value;
    const childrenGroup = document.getElementById('entChildrenField');
    const monthsInput = document.getElementById('months'); const monthsLabel = document.getElementById('monthsLabel');
    const contributionLabel = document.getElementById('contributionLabel');
    monthsInput.disabled = false;
    monthsInput.value = '';
    monthsInput.min = '1';
    monthsInput.max = ''; monthsLabel.textContent = 'เปเบเบทเบญเบ:';
    monthsInput.placeholder = "เบเปเบญเบเบเบณเบเบงเบเปเบเบทเบญเบ (เบเบปเบงเบขเปเบฒเบ: 12)";
    contributionLabel.textContent = 'เบเบณเบเบงเบเปเบเบตเบเบชเบปเบกเบเบปเบ 6 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ:';
    const showChildren = category === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ' || category === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ';
    childrenGroup.classList.toggle('hidden', !showChildren);
    if (category === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ' || category === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
        monthsLabel.textContent = 'เปเบเบทเบญเบเบเบฑเบเปเบปเบเบเบตเปเปเบเบปเปเบฒ เบญเบเบ:'; }
    if (category === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ') {
        monthsInput.value = 1; monthsInput.disabled = true;
    } else if (category === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ') {
        monthsInput.placeholder = "เบเปเบญเบเปเบเบทเบญเบ (1-4)"; monthsInput.min = '1';
        monthsInput.max = '4';
    } else if (category === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
        contributionLabel.textContent = 'เบเบณเบเบงเบเปเบเบตเบเบชเบปเบกเบเบปเบ <60 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ:'; monthsInput.placeholder = "เบเปเบญเบเปเบเบทเบญเบ (1-59)";
        monthsInput.min = '1';
        monthsInput.max = '59'; }
}

const clearForm = (formId, resultId, callback) => { 
    document.getElementById(formId).reset();
    const resultEl = document.getElementById(resultId); 
    if (resultEl) resultEl.classList.add('hidden'); if (callback) callback();
};
const resetSalaryForm = () => clearForm('salaryForm', 'salaryResult', toggleFields);
const clearGovForm = () => clearForm('bonusForm', 'govResult', updatePercentage); const clearEntForm = () => clearForm('supportForm', 'entResult', handleEnterpriseCategoryChange);

function calculateYearlyBonus(years) {
    if (!APP_CONFIG) return 0; const tiers = APP_CONFIG.yearAllowanceTiers;
    for (const tier of tiers) { if (years <= tier.maxYears) { return (years - tier.previousMax) * tier.rate + tier.base; } }
    const lastTier = tiers[tiers.length - 1]; return (years - lastTier.previousMax) * lastTier.rate + lastTier.base; }

function calculateTax(taxableIncome) {
    if (!APP_CONFIG) return 0; const brackets = APP_CONFIG.taxBrackets; let previousMax = 0; for (const bracket of brackets) { if (taxableIncome <= bracket.max) { return (taxableIncome - previousMax) * bracket.rate + bracket.base; } previousMax = bracket.max; } return 0;
}

// =========================================================================================
// START: SALARY CALCULATION - เบชเบนเบเบเบดเบเปเบฅเปเปเบเบดเบเปเบเบทเบญเบ
// =========================================================================================
// COMMENT: เบเปเบฒเบกเบตเบเบฒเบเบเปเบฝเบเปเบเบเบงเบดเบเบตเบเบดเบเปเบฅเปเปเบเบดเบเปเบเบทเบญเบเบฅเบฑเบเบเบฐเบเบญเบ เบซเบผเบท เบเบณเบเบฒเบ, เปเบซเปเบกเบฒเปเบเปเปเบ Logic เปเบ Function เบเบตเป
// เบเปเบฒเบเบปเบเบเบตเปเบเปเบฒเบเปเปเบเบฑเปเบ: เบเบปเบงเบเบนเบเบเบฑเบเบชเบฐเบเบต, เปเบเบดเบเบญเบธเบเปเบนเบเบฅเบนเบ/เปเบกเบ, เบเปเบฒเบเบญเบเบเบตเบ, เบญเบฑเบเบเบฒเบซเบฑเบเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบก/เบชเบธเบเบฐเบเบฒเบ
// เบเบทเบเบเบถเบเบกเบฒเบเบฒเบ Firebase config (APP_CONFIG) เปเบเบทเปเบญเบเบงเบฒเบกเบชเบฐเบเบงเบเปเบเบเบฒเบเบญเบฑเบเปเบเบเปเบเบเบเปเปเบเปเบญเบเปเบเปเปเบเบฅเบฐเบซเบฑเบเปเบเบเบเบปเบ.
// =========================================================================================
async function calculateSalary() {
    if (!APP_CONFIG) { showCustomPopup('error', 'เบเบดเบเบเบฒเบ', 'เบเปเปเบชเบฒเบกเบฒเบเบเบณเบเบงเบเปเบเป, เบเบฒเบเบเบฑเปเบเบเปเบฒเบเบฑเบเบเปเปเบเปเบญเบกเปเบเปเบเบฒเบ.');
return; }
    const category = document.getElementById('category').value; const index = parseFloat(document.getElementById('index').value) || 0;
    const year = parseFloat(document.getElementById('year').value) ||
0; const position = parseFloat(document.getElementById('position').value.replace(/,/g, '')) || 0;
    if (!category || !index || !year) { showCustomPopup('warning', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบ', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบเบเบตเปเบเบณเปเบเบฑเบ (เบเบฐเปเบเบ, เบเบฑเบเบชเบฐเบเบต, เบเบตเบเบฒเบ) เปเบซเปเบเบปเบเบเนเธงเธ.'); return; }
    Swal.fire({ title: 'เบเบณเบฅเบฑเบเบเบณเบเบงเบ...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });
    const children = parseFloat(document.getElementById('children').value) || 0; 
    const wife = parseFloat(document.getElementById('wife').value) || 0; 
    const pensionPercent = parseFloat(document.getElementById('pensionPercent').value) || 0; // เบเบณเบเบงเบเปเบเบดเบเบเบตเบเบฒเบ เปเบเบเบญเบตเบเบเบฒเบกเบเบฑเปเบเบเบตเปเบเบณเบเบปเบเปเบงเปเปเบ Firebase config
    const yearAllowance = calculateYearlyBonus(year);
const livingAllowance = APP_CONFIG.salary.livingAllowance; // เปเบเบดเบเบเปเบฒเบเบญเบเบเบตเบ
    const childAllowance = children * APP_CONFIG.salary.childAllowance; // เปเบเบดเบเบญเบธเบเปเบนเบเบฅเบนเบ
    
    let totalBeforeDeduction, deduction, tax, totalNet, wifeAllowance; let dataToSave = {}; // เบเบงเบเบชเบญเบเบเบฐเปเบเบเบเบฒเบเบเบณเบเบงเบ: 'civil' = เบฅเบฑเบเบเบฐเบเบญเบ, 'pension' = เบเบณเบเบฒเบ
    if (category === 'civil') {
        // --- เบชเบนเบเบเบดเบเปเบฅเปเปเบเบดเบเปเบเบทเบญเบเบฅเบฑเบเบเบฐเบเบญเบ (เบเบปเบเบเบฐเบเบด) ---
        // เปเบเบดเบเปเบเบทเบญเบเบเปเบญเบเบซเบฑเบ = (เบเบฑเบเบชเบฐเบเบต * เบเบปเบงเบเบนเบ) + เปเบเบดเบเบเบณเปเปเปเบ + เปเบเบดเบเบเบตเบเบฒเบ
        totalBeforeDeduction = (index * APP_CONFIG.salary.indexMultiplier) + position + yearAllowance; wifeAllowance = wife * APP_CONFIG.salary.wifeAllowance; // เปเบเบดเบเบญเบธเบเปเบนเบเปเบกเบ
        // เบซเบฑเบเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบก = เปเบเบดเบเปเบเบทเบญเบเบเปเบญเบเบซเบฑเบ * เบญเบฑเบเบเบฒเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบก (เปเบเบฑเปเบ: 8%)
        deduction = Math.floor(totalBeforeDeduction * APP_CONFIG.deductions.civilRate); const taxableIncome = totalBeforeDeduction - deduction;
        // เบซเบฑเบเบญเบฒเบเบญเบ (เบเบณเบเบงเบเบเบฒเบเปเบเบดเบเปเบเบทเบญเบเบซเบผเบฑเบเบซเบฑเบเบเบฐเบเบฑเบเบชเบฑเบเบเบปเบก)
        tax = Math.floor(calculateTax(taxableIncome)); // เปเบเบดเบเปเบเบทเบญเบเบเบปเบงเบเบดเบ = เปเบเบดเบเปเบเบทเบญเบเบเปเบญเบเบซเบฑเบ - เบเบฐเบเบฑเบเบชเบฑเบเบเบปเบก - เบญเบฒเบเบญเบ + เบญเบธเบเปเบนเบเบฅเบนเบ + เบญเบธเบเปเบนเบเปเบกเบ + เบเปเบฒเบเบญเบเบเบตเบ
        totalNet = Math.floor(totalBeforeDeduction - deduction - tax + childAllowance + wifeAllowance + livingAllowance); dataToSave = { category: 'เปเบเบตเบเปเบเบทเบญเบเบเบฐเบเบฑเบเบเบฒเบเบฅเบฑเบเบเบฐเบเบญเบ', index, year, position, children, wife, totalBeforeDeduction, yearAllowance, childAllowance, wifeAllowance, deduction, tax, livingAllowance, totalNet }; } else {
        // --- เบชเบนเบเบเบดเบเปเบฅเปเปเบเบดเบเปเบเบทเบญเบเบเบณเบเบฒเบ ---
        // เปเบเบดเบเปเบเบทเบญเบเบเปเบญเบเบซเบฑเบ = ((เบเบฑเบเบชเบฐเบเบต * เบเบปเบงเบเบนเบ) + เบเบณเปเปเปเบ + เบเบตเบเบฒเบ) * เปเบเบตเปเบเบฑเบเบเบณเบเบฒเบ
        totalBeforeDeduction = ((index * APP_CONFIG.salary.indexMultiplier) + position + yearAllowance) * (pensionPercent / 100); wifeAllowance = 0; // เบเบณเบเบฒเบเบเปเปเบกเบตเบญเบธเบเปเบนเบเปเบกเบ
        tax = 0; // เบเบณเบเบฒเบเบเปเปเปเบชเบเบญเบฒเบเบญเบ
        // เบซเบฑเบเบเบฐเบเบฑเบเบชเบธเบเบฐเบเบฒเบ = เปเบเบดเบเปเบเบทเบญเบเบเปเบญเบเบซเบฑเบ * เบญเบฑเบเบเบฒเบเบฐเบเบฑเบเบชเบธเบเบฐเบเบฒเบ
        deduction = Math.floor(totalBeforeDeduction * APP_CONFIG.deductions.pensionHealthRate); // เปเบเบดเบเบเบณเบเบฒเบเบเบปเบงเบเบดเบ = เปเบเบดเบเปเบเบทเบญเบเบเปเบญเบเบซเบฑเบ - เบเบฐเบเบฑเบเบชเบธเบเบฐเบเบฒเบ + เบญเบธเบเปเบนเบเบฅเบนเบ + เบเปเบฒเบเบญเบเบเบตเบ
        totalNet = Math.floor(totalBeforeDeduction - deduction + childAllowance + livingAllowance); dataToSave = { category: 'เปเบเบตเบเปเบเบทเบญเบเบเบฐเบเบฑเบเบเบฒเบเบเบณเบเบฒเบ', index, year, position, children, pensionPercent, totalBeforeDeduction, yearAllowance, childAllowance, deduction, livingAllowance, totalNet }; }
    Swal.close();
    document.getElementById('totalBeforeDeduction').textContent = totalBeforeDeduction.toLocaleString(); document.getElementById('yearAllowance').textContent = yearAllowance.toLocaleString(); document.getElementById('childAllowance').textContent = childAllowance.toLocaleString(); document.getElementById('wifeAllowance').textContent = wifeAllowance.toLocaleString(); document.getElementById('deduction8').textContent = deduction.toLocaleString(); document.getElementById('tax').textContent = Math.round(tax).toLocaleString(); document.getElementById('livingAllowance').textContent = livingAllowance.toLocaleString(); document.getElementById('totalNet').textContent = totalNet.toLocaleString(); 
    document.getElementById('salaryResult').classList.remove('hidden');
    if (await saveDataToFirestore('salaryHistory', dataToSave)) { showCustomPopup('success', 'เบเบฑเบเบเบถเบเบชเบณเปเบฅเบฑเบ!', 'เบเบฒเบเบเบณเบเบงเบเปเบเปเบเบทเบเบเบฑเบเบเบถเบเบฅเบปเบเปเบเบเบฐเบซเบงเบฑเบเปเบฅเปเบง.'); }
}

// =========================================================================================
// START: GOVERNMENT SUBSIDY CALCULATION - เบชเบนเบเบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเบเบฒเบเบฅเบฑเบ (เบเบฑเบเบเบธเบ)
// =========================================================================================
async function validateAndCalculateGovernment() {
    if (!APP_CONFIG) {
        showCustomPopup('error', 'เบเบดเบเบเบฒเบ', 'เบเปเปเบชเบฒเบกเบฒเบเบเบณเบเบงเบเปเบเป, เบเบฒเบเบเบฑเปเบเบเปเบฒเบเบฑเบเบเปเปเบเปเบญเบกเปเบเปเบเบฒเบ.'); return;
    }

    const formData = {
        detail: document.getElementById('detail').value,
        index: parseFloat(document.getElementById('govIndex').value) || 0,
        serviceYears: parseInt(document.getElementById('serviceYears').value) || 0,
        positionSalary: parseFloat(document.getElementById('positionSalary').value.replace(/,/g, '')) || 0,
        percentage: parseFloat(document.getElementById('percentage').value) || 0
    }; if (!formData.detail || !formData.index || !formData.serviceYears) {
        showCustomPopup('warning', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบ', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบเบเบตเปเบเบณเปเบเบฑเบเปเบซเปเบเบปเบเบเปเบงเบ.');
        return; }

    if ((formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ" || formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ") && (!formData.percentage || formData.percentage <= 0)) {
        showCustomPopup('warning', 'เบเปเปเบกเบนเบเบเปเปเบเบทเบเบเปเบญเบ', 'เบเบฐเบฅเบธเบเบฒเปเบชเปเปเบเบตเปเบเบฑเบเบเบณเบเบฒเบเบเบตเปเบเบทเบเบเปเบญเบ'); return;
    }

    Swal.fire({
        title: 'เบเบณเบฅเบฑเบเบเบณเบเบงเบ...',
        allowOutsideClick: false,
        didOpen: () => Swal.showLoading()
    }); const C = APP_CONFIG.govSubsidy;
    const baseMonthlySalary = formData.index * APP_CONFIG.salary.indexMultiplier;
    const yearlyBonus = calculateYearlyBonus(formData.serviceYears); const totalBeforePensionCalc = baseMonthlySalary + yearlyBonus + formData.positionSalary;

    let totalDeduction = 0;
    let monthsReceived = 0;
    let totalAmountReceived = 0; if (formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ") {
        totalDeduction = Math.floor(totalBeforePensionCalc * (C.severanceRate || 0.85)); monthsReceived = C.severanceMultiplier || 1.5;
        totalAmountReceived = Math.round(totalDeduction * monthsReceived * formData.serviceYears); } else if (formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเปเบฒเบเปเบชเบเบเบตเบงเบดเบ") {
        totalDeduction = Math.floor(totalBeforePensionCalc * formData.percentage / 100); monthsReceived = C.widowAllowanceMonths;
        totalAmountReceived = (totalDeduction * C.widowPensionMultiplier) * monthsReceived; } else { 
        totalDeduction = (formData.detail === "เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเบเบฒเบเปเบชเบเบเบตเบงเบดเบ")
            ? Math.floor(totalBeforePensionCalc * formData.percentage / 100)
            : totalBeforePensionCalc; if (formData.serviceYears < C.deathAllowanceYearsLimit) {
            monthsReceived = formData.serviceYears + C.deathAllowanceBaseMonths; } else {
            monthsReceived = (Math.floor((formData.serviceYears + C.deathAllowanceFormulaMonths1) / C.deathAllowanceFormulaMonths2)) + C.deathAllowanceFormulaMonths3; }
        totalAmountReceived = totalDeduction * monthsReceived;
    }

    Swal.close(); document.getElementById('govBaseMonthlySalary').innerText = `${baseMonthlySalary.toLocaleString('en-US')}`;
    document.getElementById('govYearlyBonus').innerText = `${yearlyBonus.toLocaleString('en-US')}`;
    document.getElementById('govTotalDeduction').innerText = `${totalDeduction.toLocaleString('en-US')}`;
    document.getElementById('govMonthsReceived').innerText = `${monthsReceived}`;
    document.getElementById('govTotalAmountReceived').innerText = `${totalAmountReceived.toLocaleString('en-US')}`;
    document.getElementById('govResult').classList.remove('hidden'); const saveData = {
        ...formData,
        baseMonthlySalary,
        yearlyBonus,
        totalDeduction,
        monthsReceived,
        totalAmountReceived
    }; if (await saveDataToFirestore('govSupportHistory', saveData)) {
        showCustomPopup('success', 'เบเบฑเบเบเบถเบเบชเบณเปเบฅเบฑเบ!', 'เบเบฒเบเบเบณเบเบงเบเปเบเปเบเบทเบเบเบฑเบเบเบถเบเบฅเบปเบเปเบเบเบฐเบซเบงเบฑเบเปเบฅเปเบง.'); }
}
// =========================================================================================
// END: GOVERNMENT SUBSIDY CALCULATION
// =========================================================================================


// =========================================================================================
// START: ENTERPRISE SUBSIDY CALCULATION - เบชเบนเบเบเบดเบเปเบฅเปเปเบเบดเบเบญเบธเบเปเบนเบเบเบฒเบเบงเบดเบชเบฒเบซเบฐเบเบดเบ (เบเบฑเบเบเบธเบ)
// =========================================================================================
async function calculateEnterprise() {
    if (!APP_CONFIG) { showCustomPopup('error', 'เบเบดเบเบเบฒเบ', 'เบเปเปเบชเบฒเบกเบฒเบเบเบณเบเบงเบเปเบเป, เบเบฒเบเบเบฑเปเบเบเปเบฒเบเบฑเบเบเปเปเบเปเบญเบกเปเบเปเบเบฒเบ.'); return; }
    const data = { category: document.getElementById('entCategory').value, contribution: parseFloat(document.getElementById('contribution').value.replace(/,/g, '')) || 0, months: parseFloat(document.getElementById('months').value) || 0, children: parseFloat(document.getElementById('entChildren').value) || 0 };
    if (!data.category || !data.contribution || !data.months || ( (data.category === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ' || data.category === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ') && !data.children) ) { showCustomPopup('warning', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบ', 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบเปเปเบกเบนเบเบเบตเปเบเบณเปเบเบฑเบเปเบซเปเบเบปเบเบเปเบงเบ.'); return; }
    
    Swal.fire({ title: 'เบเบณเบฅเบฑเบเบเบณเบเบงเบ...', allowOutsideClick: false, didOpen: () => Swal.showLoading() }); const C = APP_CONFIG.entSubsidy;
    let result = 0;
    const avgContribution = Math.floor(data.contribution / C.baseMonths); if (data.category === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ') {
        result = Math.round(avgContribution * C.childbirthBenefitMultiplier) * data.children; } else if (data.category === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ') {
        const M = C.childbirthAllowanceMultipliers; const childBenefit = data.children * Math.round(avgContribution * C.childbirthBenefitMultiplier);
        if (data.months == 1) result = (Math.round(avgContribution * M.month1)) + childBenefit; else if (data.months == 2) result = Math.round(avgContribution * M.month2);
        else if (data.months == 3) result = Math.round(avgContribution * M.month3); else if (data.months == 4) result = Math.round(avgContribution * M.month4) + childBenefit; } else if (data.category === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ') {
        const D = C.deathBenefit; var years = Math.floor(data.months / 12);
        if (years < D.yearLimit) {
            result = (years + D.baseMonths) * avgContribution; } else {
            result = (Math.floor((years + D.formulaMonths1) / 2) + D.formulaMonths3) * avgContribution; }
    } else if (data.category === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
        const S = C.severancePay; var effectiveMonths = data.months < (S.maxMonths + 1) ? data.months : S.maxMonths;
        var years = Math.floor(data.months / 12); result = Math.floor(data.contribution / effectiveMonths) * S.yearMultiplier * years;
    }
    
    Swal.close(); const resultFormatted = result.toFixed(0);
    document.getElementById('entTotal').innerText = parseFloat(resultFormatted).toLocaleString('en-US');
    document.getElementById('entResult').classList.remove('hidden');
    
    const saveData = { ...data, totalAmountReceived: resultFormatted }; if (await saveDataToFirestore('entSupportHistory', saveData)) { showCustomPopup('success', 'เบเบฑเบเบเบถเบเบชเบณเปเบฅเบฑเบ!', 'เบเบฒเบเบเบณเบเบงเบเปเบเปเบเบทเบเบเบฑเบเบเบถเบเบฅเบปเบเปเบเบเบฐเบซเบงเบฑเบเปเบฅเปเบง.'); }
}
// =========================================================================================
// END: ENTERPRISE SUBSIDY CALCULATION
// =========================================================================================


// =========================================================================================
// START: INDEX DATA - เบเปเปเบกเบนเบเบเบฑเบเบชเบฐเบเบตเปเบเบดเบเปเบเบทเบญเบ
// =========================================================================================
const indexData = [ ['เบเบฑเปเบ/เบเบฑเปเบ', 'เบเบฑเบเบชเบฐเบเบต', 'เบเบปเบงเบเบนเบ', 'เบเบฒเบเบชเปเบงเบ'], ['1/1', 135, 7350, 'เบเบปเบเบเบญเบ'],['1/2', 136, 7350, 'เบเบปเบเบเบญเบ'],['1/3', 137, 7350, 'เบเบปเบเบเบญเบ'],['1/4', 138, 7350, 'เบเบปเบเบเบญเบ'],['1/5', 139, 7350, 'เบเบปเบเบเบญเบ'],['1/6', 140, 7350, 'เบเบปเบเบเบญเบ'],['1/7', 141, 7350, 'เบเบปเบเบเบญเบ'],['1/8', 144, 7350, 'เบเบปเบเบเบญเบ'],['1/9', 147, 7350, 'เบเบปเบเบเบญเบ'],['1/10', 150, 7350, 'เบเบปเบเบเบญเบ'],['1/11', 153, 7350, 'เบเบปเบเบเบญเบ'],['1/12', 156, 7350, 'เบเบปเบเบเบญเบ'],['1/13', 159, 7350, 'เบเบปเบเบเบญเบ'],['1/14', 162, 7350, 'เบเบปเบเบเบญเบ'],['1/15', 165, 7350, 'เบเบปเบเบเบญเบ'],['2/1', 147, 7350, 'เบเบปเบเบเบญเบ'],['2/2', 150, 7350, 'เบเบปเบเบเบญเบ'],['2/3', 153, 7350, 'เบเบปเบเบเบญเบ'],['2/4', 156, 7350, 'เบเบปเบเบเบญเบ'],['2/5', 159, 7350, 'เบเบปเบเบเบญเบ'],['2/6', 162, 7350, 'เบเบปเบเบเบญเบ'],['2/7', 165, 7350, 'เบเบปเบเบเบญเบ'],['2/8', 170, 7350, 'เบเบปเบเบเบญเบ'],['2/9', 175, 

7350, 'เบเบปเบเบเบญเบ'],['2/10', 180, 7350, 'เบเบปเบเบเบญเบ'],['2/11', 185, 7350, 'เบเบปเบเบเบญเบ'],['2/12', 190, 7350, 'เบเบปเบเบเบญเบ'],['2/13', 195, 
7350, 'เบเบปเบเบเบญเบ'],['2/14', 200, 7350, 'เบเบปเบเบเบญเบ'],['2/15', 205, 7350, 'เบเบปเบเบเบญเบ'],['3/1', 175, 7350, 'เบเบปเบเบเบญเบ'],['3/2', 180, 7350, 'เบเบปเบเบเบญเบ'],['3/3', 185, 7350, 'เบเบปเบเบเบญเบ'],['3/4', 190, 7350, 'เบเบปเบเบเบญเบ'],['3/5', 195, 7350, 'เบเบปเบเบเบญเบ'],['3/6', 200, 7350, 'เบเบปเบเบเบญเบ'],['3/7', 205, 7350, 'เบเบปเบเบเบญเบ'],['3/8', 212, 7350, 'เบเบปเบเบเบญเบ'],['3/9', 219, 7350, 'เบเบปเบเบเบญเบ'],['3/10', 226, 7350, 'เบเบปเบเบเบญเบ'],['3/11', 233, 7350, 'เบเบปเบเบเบญเบ'],['3/12', 240, 7350, 'เบเบปเบเบเบญเบ'],['3/13', 247, 7350, 'เบเบปเบเบเบญเบ'],['3/14', 254, 7350, 'เบเบปเบเบเบญเบ'],['3/15', 261, 7350, 'เบเบปเบเบเบญเบ'],['4/1', 219, 7350, 'เบเบปเบเบเบญเบ'],['4/2', 226, 7350, 'เบเบปเบเบเบญเบ'],['4/3', 233, 7350, 'เบเบปเบเบเบญเบ'],['4/4', 240, 7350, 'เบเบปเบเบเบญเบ'],['4/5', 247, 7350, 'เบเบปเบเบเบญเบ'],['4/6', 254, 7350, 'เบเบปเบเบเบญเบ'],['4/7', 261, 7350, 'เบเบปเบเบเบญเบ'],['4/8', 270, 7350, 'เบเบปเบเบเบญเบ'],['4/9', 279, 7350, 'เบเบปเบเบเบญเบ'],['4/10', 288, 7350, 'เบเบปเบเบเบญเบ'],['4/11', 297, 7350, 'เบเบปเบเบเบญเบ'],['4/12', 306, 7350, 

'เบเบปเบเบเบญเบ'],['4/13', 315, 7350, 'เบเบปเบเบเบญเบ'],['4/14', 324, 7350, 'เบเบปเบเบเบญเบ'],['4/15', 333, 7350, 'เบเบปเบเบเบญเบ'],['5/1', 279, 7350, 
'เบเบปเบเบเบญเบ'],['5/2', 288, 7350, 'เบเบปเบเบเบญเบ'],['5/3', 297, 7350, 'เบเบปเบเบเบญเบ'],['5/4', 306, 7350, 'เบเบปเบเบเบญเบ'],['5/5', 315, 7350, 'เบเบปเบเบเบญเบ'],['5/6', 324, 7350, 'เบเบปเบเบเบญเบ'],['5/7', 333, 7350, 'เบเบปเบเบเบญเบ'],['5/8', 344, 7350, 'เบเบปเบเบเบญเบ'],['5/9', 355, 7350, 'เบเบปเบเบเบญเบ'],['5/10', 366, 7350, 'เบเบปเบเบเบญเบ'],['5/11', 377, 7350, 'เบเบปเบเบเบญเบ'],['5/12', 388, 7350, 'เบเบปเบเบเบญเบ'],['5/13', 399, 7350, 'เบเบปเบเบเบญเบ'],['5/14', 410, 7350, 'เบเบปเบเบเบญเบ'],['5/15', 421, 7350, 'เบเบปเบเบเบญเบ'],['6/1', 425, 7350, 'เบเบปเบเบเบญเบ'],['6/2', 450, 7350, 'เบเบปเบเบเบญเบ'],['6/3', 485, 7350, 'เบเบปเบเบเบญเบ'],['6/4', 530, 7350, 'เบเบปเบเบเบญเบ'],['6/5', 585, 7350, 'เบเบปเบเบเบญเบ'],['6/6', 650, 7350, 'เบเบปเบเบเบญเบ'],['6/7', 700, 7350, 'เบเบปเบเบเบญเบ'], ['1/1', 156, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/2', 159, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/3', 162, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/4', 165, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/5', 170, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/6', 175, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/7', 180, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/8', 185, 7350, 

'เบเบนเบญเบฒเบเบฒเบ'],['1/9', 190, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/10', 195, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/11', 200, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/12', 205, 7350, 
'เบเบนเบญเบฒเบเบฒเบ'],['1/13', 212, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/14', 219, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/15', 226, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/16', 233, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/17', 240, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/18', 247, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/19', 254, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/20', 261, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/21', 270, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/22', 279, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/23', 288, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/24', 297, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['1/25', 306, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/1', 209, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/2', 218, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/3', 227, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/4', 236, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/5', 245, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/6', 256, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/7', 267, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/8', 278, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/9', 289, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/10', 300, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/11', 313, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/12', 326, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/13', 339, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/14', 352, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['2/15', 365, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/1', 260, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/2', 

273, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/3', 286, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/4', 299, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/5', 312, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/6', 
327, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/7', 342, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/8', 357, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/9', 372, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/10', 387, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/11', 404, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/12', 421, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/13', 438, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/14', 455, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['3/15', 472, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/1', 308, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/2', 323, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/3', 338, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/4', 353, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/5', 368, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/6', 385, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/7', 402, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/8', 419, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/9', 436, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/10', 453, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/11', 470, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/12', 475, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/13', 480, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/14', 485, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['4/15', 490, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/1', 369, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/2', 384, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/3', 399, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/4', 414, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/5', 429, 

7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/6', 444, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/7', 459, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/8', 474, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/9', 489, 
7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/10', 505, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/11', 510, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/12', 515, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/13', 520, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/14', 525, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/15', 530, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/16', 535, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/17', 540, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/18', 545, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/19', 550, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/20', 555, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/21', 560, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/22', 565, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/23', 570, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/24', 575, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],['5/25', 580, 7350, 'เบเบนเบญเบฒเบเบฒเบ'],
]; // =========================================================================================
// END: INDEX DATA
// =========================================================================================

async function searchData() {
    const collectionName = document.getElementById('combobox1').value; const searchTerm = document.getElementById('textbox1').value.trim().toLowerCase(); if (!collectionName) { showCustomPopup('warning', 'เบเบฐเบฅเบธเบเบฒเปเบฅเบทเธญเธ', 'เบเบฐเบฅเบธเบเบฒเปเบฅเบทเธญเธเบฅเบฒเบเบเบฒเบเบเบตเปเบเบฐเบเบปเปเบเบซเบฒเบเปเบญเบ!'); return; }
    Swal.fire({ title: 'เบเบณเบฅเบฑเบเบเบปเปเบเบซเบฒ...', allowOutsideClick: false, didOpen: () => Swal.showLoading() }); let headers = []; let dataRows = [];
    if (collectionName === 'indexData') {
        headers = indexData[0]; let data = indexData.slice(1);
        if (searchTerm) { data = data.filter(row => row.some(cell => cell && cell.toString().toLowerCase().includes(searchTerm))); } dataRows = data; } else {
        const firestoreData = await getDataFromFirestore(collectionName); switch (collectionName) {
            case 'salaryHistory':
                headers = ['เบงเบฑเบเบเบต', 'เปเบเบทเปเบญเปเบ', 'เบเบฑเบเบชเบฐเบเบต', 'เบเบตเบเบฒเบ', 'เบเบณเปเปเปเบ', 'เบฅเบนเบ', 'เปเบกเบ', '%เบเบณเบเบฒเบ', 'เบฅเบงเบกเบเปเบญเบเบซเบฑเบ', 'เปเบเบดเบเบเบตเบเบฒเบ', 'เปเบเบดเบเบฅเบนเบ', 'เปเบเบดเบเปเบกเบ', 'เบซเบฑเบ(8%/เบเบฐเบเบฑเบ)', 'เบญเบฒเบเบญเบ', 'เบเปเบฒเบเบญเบเบเบตเบ', 'เบฅเบงเบกเบเบฑเบเปเบปเบ']; dataRows = firestoreData.map(r => {
                    const isCivil = r.category === 'เปเบเบตเบเปเบเบทเบญเบเบเบฐเบเบฑเบเบเบฒเบเบฅเบฑเบเบเบฐเบเบญเบ';
                    return [ r.savedAt ? new Date(r.savedAt).toLocaleString('lo-LA') : 'N/A', r.category, r.index, r.year, r.position, r.children, isCivil ? r.wife : '-', isCivil ? '-' : r.pensionPercent, r.totalBeforeDeduction, r.yearAllowance, r.childAllowance, isCivil ? r.wifeAllowance : '-', r.deduction, isCivil ? r.tax : '-', r.livingAllowance, r.totalNet, r.id ];
           
  }); break;
            case 'govSupportHistory':
                headers = ['เบงเบฑเบเบเบต', 'เปเบเบทเปเบญเปเบ', 'เบเบฑเบเบชเบฐเบเบต', 'เบเบตเบเบฒเบ', 'เบเบณเปเปเปเบ', '%เบเบณเบเบฒเบ', 'เปเบเบดเบเปเบเบทเบญเบเบเบทเปเบเบเบฒเบ', 'เปเบเบดเบเบเบตเบเบฒเบ', 'เบฅเบงเบกเบเปเบญเบเบซเบฑเบ', 'เปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบ', 'เบฅเบงเบกเบเบฑเบเปเบปเบ']; dataRows = firestoreData.map(r => [ r.savedAt ? new Date(r.savedAt).toLocaleString('lo-LA') : 'N/A', r.detail, r.index, r.serviceYears, r.positionSalary, r.percentage || '-', r.baseMonthlySalary, r.yearlyBonus, r.totalDeduction, r.monthsReceived, r.totalAmountReceived, r.id ]); break;
            case 'entSupportHistory':
                headers = ['เบงเบฑเบเบเบต', 'เปเบเบทเปเบญเปเบ', 'เปเบเบดเบเบชเบปเบกเบเบปเบ', 'เปเบเบทเบญเบ', 'เบเบณเบเบงเบเบฅเบนเบ', 'เบฅเบงเบกเบเบฑเบเปเบปเบ']; dataRows = firestoreData.map(r => [ r.savedAt ? new Date(r.savedAt).toLocaleString('lo-LA') : 'N/A', r.category, r.contribution, r.months, r.children, r.totalAmountReceived, r.id ]); break; }
        if (searchTerm) { dataRows = dataRows.filter(row => row.slice(0, -1).some(cell => cell && cell.toString().toLowerCase().includes(searchTerm))); }
    }
    displaySearchResults(collectionName, [headers, ...dataRows]); Swal.close(); }

// =========================================================================================
// START: DISPLAY SEARCH RESULTS - เบเบฑเบเบเบฑเบเบชเบฐเปเบเบเบเบปเบเบเบฒเบเบเบปเปเบเบซเบฒ (เบเบฑเบเบเบธเบ)
// =========================================================================================
function displaySearchResults(collectionName, parsedData) {
    const tableHeader = document.getElementById('table-header'); const tableBody = document.getElementById('table-body');
    tableHeader.innerHTML = '';
    tableBody.innerHTML = '';
    document.getElementById('searchResult').classList.remove('hidden'); if (parsedData.length <= 1) {
        const colspan = (parsedData[0] || []).length + 1; tableBody.innerHTML = `<tr><td colspan="${colspan}" class="text-center p-4">เบเปเปเบเบปเบเบเปเปเบกเบนเบเบเบตเปเบเบปเบเบเบฑเบเบเบฒเบเบเบปเปเบเบซเบฒ</td></tr>`;
        return;
    }

    const headers = [...parsedData[0], 'เบเบณเปเบเบตเบเบเบฒเบ']; headers.forEach(header => {
        const th = document.createElement('th');
        th.textContent = header;
        th.scope = 'col';
        th.className = 'px-6 py-3';
        tableHeader.appendChild(th);
    }); const rows = parsedData.slice(1);
    rows.forEach(row => {
        const tr = document.createElement('tr');
        tr.className = "border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600";
        const docId = collectionName !== 'indexData' ? row[row.length - 1] : null;
        const displayRow = collectionName !== 'indexData' ? row.slice(0, -1) : row;
        const rowType = row[1];

        displayRow.forEach((value, index) => {
           
 const td = document.createElement('td');
            td.className = "px-6 py-4";
            const header = headers[index];
            let customLabel = header;
            let displayValue = value;

            if (collectionName === 'govSupportHistory' && rowType === 'เปเบเบตเบเบญเบธเบเปเบธเบเบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') {
                
if (header === '%เบเบณเบเบฒเบ') { td.classList.add('mobile-hidden'); }
                if (header === 'เปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบ') {
                    customLabel = 'เปเบเบทเบญเบเบเบตเปเปเบเปเบฎเบฑเบ';
                    displayValue = '1.5';
                }
            }

  
          if (collectionName === 'entSupportHistory') {
                if ((rowType === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ' || rowType === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') && header === 'เบเบณเบเบงเบเบฅเบนเบ') {
                    td.classList.add('mobile-hidden'); }
                if (header === 'เปเบเบดเบเบชเบปเบกเบเบปเบ') {
                    if (rowType === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ' || rowType === 'เบญเบธเบเปเบธเบเปเบเบตเบเบฅเบนเบ' || rowType === 'เบเบณเปเบเบฑเบเปเบเบตเบเบฅเบนเบ') { customLabel = 'เปเบเบตเบเบชเบปเบเบเบปเบ 6 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ'; } 
                    else if (rowType === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') { customLabel = 'เปเบเบตเบเบชเบปเบเบเบปเบ <60 เปเบเบทเบญเบเบชเบธเบเบเปเบฒเบ'; }
                }
                if (header === 'เปเบเบทเบญเบ') {
                    if (rowType === 'เปเบเบตเบเปเบชเบเบเบตเบงเบดเบ' || rowType === 'เบเบณเปเบเบฑเบเบญเบญเบเบเบฒเบ') { customLabel = 'เปเบเบทเบญเบเบเบฑเบเปเบปเบเบเบตเปเปเบเบปเปเบฒ เบญเบเบ'; }
                }
            }
            td.setAttribute('data-label', customLabel); let finalDisplayValue;
            if (collectionName === 'entSupportHistory' && header === 'เบฅเบงเบกเบเบฑเบเปเบปเบ') {
                finalDisplayValue = parseFloat(displayValue).toLocaleString('en-US', { maximumFractionDigits: 0 }); } else if (typeof displayValue === 'number' && displayValue >= 1000) {
                finalDisplayValue = displayValue.toLocaleString('en-US', { maximumFractionDigits: 2 }); } else {
                finalDisplayValue = displayValue === '-' ? '' : (displayValue === null || typeof displayValue === 'undefined' ? '' : displayValue); }
            td.textContent = finalDisplayValue; if (value === '-' || value === '' || value === null || typeof value === 'undefined') {
                td.classList.add('mobile-hidden'); }
            tr.appendChild(td);
        });

        const actionTd = document.createElement('td'); actionTd.className = 'px-6 py-4 flex items-center justify-center gap-2';
        const downloadBtn = document.createElement('button'); downloadBtn.className = 'text-white bg-emerald-500 hover:bg-emerald-600 font-medium rounded-lg text-sm p-2 text-center';
        downloadBtn.innerHTML = '<i class="fas fa-download"></i>';
        downloadBtn.onclick = () => downloadRowAsImage(tr); actionTd.appendChild(downloadBtn);

        if (IS_ADMIN && collectionName !== 'indexData') {
            const editBtn = document.createElement('button'); editBtn.className = 'text-white bg-orange-500 hover:bg-orange-600 font-medium rounded-lg text-sm p-2 text-center';
            editBtn.innerHTML = '<i class="fas fa-edit"></i>'; editBtn.onclick = () => editRecord(collectionName, docId);
            actionTd.appendChild(editBtn);

            const deleteBtn = document.createElement('button'); deleteBtn.className = 'text-white bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm p-2 text-center';
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>'; deleteBtn.onclick = () => deleteRecord(collectionName, docId);
            actionTd.appendChild(deleteBtn);
        }
        tr.appendChild(actionTd);
        tableBody.appendChild(tr);
    }); }
// =========================================================================================
// END: DISPLAY SEARCH RESULTS
// =========================================================================================

function downloadRowAsImage(elementToCapture) {
    if (!elementToCapture) return; Swal.fire({ title: 'เบเบณเบฅเบฑเบเบชเปเบฒเบเบฎเบนเบเบเบฒเบ...', allowOutsideClick: false, didOpen: () => Swal.showLoading() }); const actionCell = elementToCapture.lastElementChild; const originalDisplay = actionCell.style.display; actionCell.style.display = 'none'; html2canvas(elementToCapture, { scale: 2, backgroundColor: '#111827', useCORS: true }).then(canvas => {
        actionCell.style.display = originalDisplay; const link = document.createElement('a'); link.href = canvas.toDataURL('image/jpeg', 0.95); link.download = `calculation_result_${Date.now()}.jpg`; link.click(); Swal.close(); showCustomPopup('success', 'เบเบฑเบเบเบถเบเบฎเบนเบเบเบฒเบเปเบฅเปเบง!');
    }).catch(error => { actionCell.style.display = originalDisplay; showCustomPopup('error', 'เบเบดเบเบเบฒเบ', `เบเปเปเบชเบฒเบกเบฒเบเบเบฑเบเบเบถเบเบฎเบนเบเบเบฒเบเปเบเป: ${error}`); }); }

async function loadAdminList() {
    try {
        if (!window.db || !window.firestoreFunctions) return; const { collection, getDocs } = window.firestoreFunctions;
        const adminSnapshot = await getDocs(collection(window.db, "admins"));
        adminSnapshot.forEach((doc) => { if(doc.data().email) ADMIN_EMAILS.push(doc.data().email); }); console.log("Admin list loaded:", ADMIN_EMAILS);
    } catch (error) { console.error("Could not load admin list:", error); }
}

async function adminLogin() {
    if (IS_ADMIN) { showCustomPopup('success', 'เปเบเบปเปเบฒเบชเบนเปเบฅเบฐเบเบปเบเปเบฅเปเบง', 'เบเปเบฒเบเปเบเปเปเบเบปเปเบฒเบชเบนเปเบฅเบฐเบเบปเบเปเบเบเบฒเบเบฐเบเบนเปเบเบนเปเบฅเบฅเบฐเบเบปเบเปเบฅเปเบง.'); return; }
    const { value: email } = await Swal.fire({ title: 'เปเบเบปเปเบฒเบชเบนเปเบฅเบฐเบเบปเบ Admin', input: 'email', inputPlaceholder: 'เบเบฐเบฅเบธเบเบฒเบเปเบญเบเบญเบตเปเบกเบง admin เบเบญเบเบเปเบฒเบ' }); if (email && ADMIN_EMAILS.includes(email)) { IS_ADMIN = true; document.getElementById('adminLoginLink').textContent = `เบชเบฐเบเบฒเบเบเบต, ${email.split('@')[0]}`; Swal.fire('เบชเบณเปเบฅเบฑเบ!', 'เบเปเบฒเบเปเบเปเปเบเบปเปเบฒเบชเบนเปเบฅเบฐเบเบปเบเปเบเบเบฒเบเบฐเบเบนเปเบเบนเปเบฅเบฅเบฐเบเบปเบ.', 'success'); }
    else if (email) { Swal.fire('เบเบดเบเบเบฒเบ!', 'เบญเบตเปเบกเบงเบเบตเปเบเปเปเปเบกเปเบเบเบนเปเบเบนเปเบฅเบฅเบฐเบเบปเบ.', 'error'); }
}

function editRecord(collectionName, docId) {
    if (!IS_ADMIN) { showCustomPopup('error', 'เบเปเปเบกเบตเบชเบดเบ', 'เบเปเบฒเบเบเปเปเนเธเนเธฃเธฑเธเบญเบฐเบเบธเบเบฒเบเปเบซเปเบเบณเปเบเบตเบเบเบฒเบเบเบตเป.'); return; }
    Swal.fire('เปเบเปเบเปเบเบทเบญเบ', `เบเบฑเบเบเบฑเบเปเบเปเปเบเบเบฑเบเบเปเปเบเปเบญเบกเปเบเปเบเบฒเบ.\nCollection: ${collectionName}\nID: ${docId}`, 'info');
}

async function deleteRecord(collectionName, docId) {
    if (!IS_ADMIN) { showCustomPopup('error', 'เบเปเปเบกเบตเบชเบดเบ', 'เบเปเบฒเบเบเปเปเนเธเนเธฃเธฑเธเบญเบฐเบเบธเบเบฒเบเปเบซเปเบเบณเปเบเบตเบเบเบฒเบเบเบตเป.'); return; }
    const { doc, deleteDoc } = window.firestoreFunctions; Swal.fire({
        title: 'เบเปเบฒเบเปเบเปเปเบเบเปเป?', text: "เบเปเบฒเบเบเบฐเบเปเปเบชเบฒเบกเบฒเบเบเบนเปเบเบทเบเบเปเปเบกเบนเบเบเบตเปเปเบเป!", icon: 'warning',
        showCancelButton: true, confirmButtonColor: '#10b981', cancelButtonColor: '#ef4444',
        confirmButtonText: 'เปเบกเปเบ, เบฅเบถเบเปเบฅเบตเบ!', cancelButtonText: 'เบเบปเบเปเบฅเบตเบ'
    }).then(async (result) => {
        if (result.isConfirmed) {
            try {
                await deleteDoc(doc(window.db, collectionName, docId));
             
    Swal.fire('เบฅเบถเบเบชเบณเปเบฅเบฑเบ!', 'เบเปเปเบกเบนเบเปเบเปเบเบทเบเบฅเบถเบเบญเบญเบเปเบฅเปเบง.', 'success');
                document.getElementById('searchButton').click();
            } catch (error) { console.error("Error deleting document: ", error); Swal.fire('เบเบดเบเบเบฒเบ!', 'เบเปเปเบชเบฒเบกเบฒเบเบฅเบถเบเบเปเปเบกเบนเบเปเบเป.', 'error'); }
        }
    }); }
</script>
<script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js')
          .then(registration => {
            console.log('Service Worker registered: ', registration);
          })
          .catch(error => {
            console.log('Service Worker registration failed: ', error);
        
  });
      });
    }
</script>
</body>
</html>
